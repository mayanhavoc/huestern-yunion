"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/index";
exports.ids = ["pages/index"];
exports.modules = {

/***/ "./components/wallet/connectWallet.tsx":
/*!*********************************************!*\
  !*** ./components/wallet/connectWallet.tsx ***!
  \*********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ ConnectWallet)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _martifylabs_mesh__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @martifylabs/mesh */ \"./node_modules/@martifylabs/mesh/dist/mesh.esm.js\");\n/* harmony import */ var _contexts_wallet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../contexts/wallet */ \"./contexts/wallet.tsx\");\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @chakra-ui/react */ \"@chakra-ui/react\");\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_4__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_martifylabs_mesh__WEBPACK_IMPORTED_MODULE_2__, _contexts_wallet__WEBPACK_IMPORTED_MODULE_3__]);\n([_martifylabs_mesh__WEBPACK_IMPORTED_MODULE_2__, _contexts_wallet__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\nfunction ConnectWallet() {\n    const { connecting , walletNameConnected , connectWallet , walletConnected  } = (0,_contexts_wallet__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n    const { 0: availableWallets , 1: setAvailableWallets  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(undefined);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        async function init() {\n            setAvailableWallets(_martifylabs_mesh__WEBPACK_IMPORTED_MODULE_2__.WalletService.getInstalledWallets());\n        }\n        init();\n    }, []);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n        children: availableWallets ? availableWallets.length == 0 ? \"No wallets found\" : availableWallets.map((wallet, i)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_4__.Button, {\n                px: \"5\",\n                mx: \"5\",\n                onClick: ()=>connectWallet(wallet.name),\n                colorScheme: \"purple\",\n                children: [\n                    \"Connect with \",\n                    wallet.name\n                ]\n            }, i, true, {\n                fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/components/wallet/connectWallet.tsx\",\n                lineNumber: 25,\n                columnNumber: 25\n            }, this)) : \"\"\n    }, void 0, false);\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21wb25lbnRzL3dhbGxldC9jb25uZWN0V2FsbGV0LnRzeC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUE0QztBQUVNO0FBQ0o7QUFFSjtBQUUzQixTQUFTSyxhQUFhLEdBQUc7SUFDcEMsTUFBTSxFQUFFQyxVQUFVLEdBQUVDLG1CQUFtQixHQUFFQyxhQUFhLEdBQUVDLGVBQWUsR0FBRSxHQUFHTiw0REFBUyxFQUFFO0lBQ3ZGLE1BQU0sS0FBQ08sZ0JBQWdCLE1BQUVDLG1CQUFtQixNQUFJViwrQ0FBUSxDQUF1QlcsU0FBUyxDQUFDO0lBRXpGWixnREFBUyxDQUFDLElBQU07UUFDWixlQUFlYSxJQUFJLEdBQUc7WUFDbEJGLG1CQUFtQixDQUFDVCxnRkFBaUMsRUFBRSxDQUFDLENBQUM7U0FDNUQ7UUFDRFcsSUFBSSxFQUFFLENBQUM7S0FDVixFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBRVAscUJBQ0k7a0JBQ0tILGdCQUFnQixHQUNYQSxnQkFBZ0IsQ0FBQ0ssTUFBTSxJQUFJLENBQUMsR0FDeEIsa0JBQWtCLEdBQ2xCTCxnQkFBZ0IsQ0FBQ00sR0FBRyxDQUFDLENBQUNDLE1BQU0sRUFBRUMsQ0FBQyxpQkFDN0IsOERBQUNkLG9EQUFNO2dCQUFTZSxFQUFFLEVBQUMsR0FBRztnQkFBQ0MsRUFBRSxFQUFDLEdBQUc7Z0JBQUNDLE9BQU8sRUFBRSxJQUFNYixhQUFhLENBQUNTLE1BQU0sQ0FBQ0ssSUFBSSxDQUFDO2dCQUFFQyxXQUFXLEVBQUMsUUFBUTs7b0JBQUMsZUFDN0U7b0JBQUNOLE1BQU0sQ0FBQ0ssSUFBSTs7ZUFEaEJKLENBQUM7Ozs7b0JBRUwsQ0FDWCxHQUNKLEVBQUU7cUJBQ1QsQ0FDTDtDQUNMIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHBibC1mcm9udC1lbmQtdGVtcGxhdGUtbmV4dGpzLW1lc2gvLi9jb21wb25lbnRzL3dhbGxldC9jb25uZWN0V2FsbGV0LnRzeD8xMDE4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgdHlwZSB7IFdhbGxldCB9IGZyb20gJ0BtYXJ0aWZ5bGFicy9tZXNoJztcbmltcG9ydCB7IFdhbGxldFNlcnZpY2UgfSBmcm9tICdAbWFydGlmeWxhYnMvbWVzaCc7XG5pbXBvcnQgdXNlV2FsbGV0IGZyb20gJy4uLy4uL2NvbnRleHRzL3dhbGxldCc7XG5cbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gJ0BjaGFrcmEtdWkvcmVhY3QnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb25uZWN0V2FsbGV0KCkge1xuICAgIGNvbnN0IHsgY29ubmVjdGluZywgd2FsbGV0TmFtZUNvbm5lY3RlZCwgY29ubmVjdFdhbGxldCwgd2FsbGV0Q29ubmVjdGVkIH0gPSB1c2VXYWxsZXQoKTtcbiAgICBjb25zdCBbYXZhaWxhYmxlV2FsbGV0cywgc2V0QXZhaWxhYmxlV2FsbGV0c10gPSB1c2VTdGF0ZTxXYWxsZXRbXSB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcblxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGFzeW5jIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICBzZXRBdmFpbGFibGVXYWxsZXRzKFdhbGxldFNlcnZpY2UuZ2V0SW5zdGFsbGVkV2FsbGV0cygpKTtcbiAgICAgICAgfVxuICAgICAgICBpbml0KCk7XG4gICAgfSwgW10pO1xuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPD5cbiAgICAgICAgICAgIHthdmFpbGFibGVXYWxsZXRzXG4gICAgICAgICAgICAgICAgPyBhdmFpbGFibGVXYWxsZXRzLmxlbmd0aCA9PSAwXG4gICAgICAgICAgICAgICAgICAgID8gJ05vIHdhbGxldHMgZm91bmQnXG4gICAgICAgICAgICAgICAgICAgIDogYXZhaWxhYmxlV2FsbGV0cy5tYXAoKHdhbGxldCwgaSkgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBrZXk9e2l9IHB4PSc1JyBteD0nNScgb25DbGljaz17KCkgPT4gY29ubmVjdFdhbGxldCh3YWxsZXQubmFtZSl9IGNvbG9yU2NoZW1lPSdwdXJwbGUnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbm5lY3Qgd2l0aCB7d2FsbGV0Lm5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICAgICA6ICcnfVxuICAgICAgICA8Lz5cbiAgICApO1xufSJdLCJuYW1lcyI6WyJ1c2VFZmZlY3QiLCJ1c2VTdGF0ZSIsIldhbGxldFNlcnZpY2UiLCJ1c2VXYWxsZXQiLCJCdXR0b24iLCJDb25uZWN0V2FsbGV0IiwiY29ubmVjdGluZyIsIndhbGxldE5hbWVDb25uZWN0ZWQiLCJjb25uZWN0V2FsbGV0Iiwid2FsbGV0Q29ubmVjdGVkIiwiYXZhaWxhYmxlV2FsbGV0cyIsInNldEF2YWlsYWJsZVdhbGxldHMiLCJ1bmRlZmluZWQiLCJpbml0IiwiZ2V0SW5zdGFsbGVkV2FsbGV0cyIsImxlbmd0aCIsIm1hcCIsIndhbGxldCIsImkiLCJweCIsIm14Iiwib25DbGljayIsIm5hbWUiLCJjb2xvclNjaGVtZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./components/wallet/connectWallet.tsx\n");

/***/ }),

/***/ "./contexts/wallet.tsx":
/*!*****************************!*\
  !*** ./contexts/wallet.tsx ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"WalletProvider\": () => (/* binding */ WalletProvider),\n/* harmony export */   \"default\": () => (/* binding */ useWallet)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _martifylabs_mesh__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @martifylabs/mesh */ \"./node_modules/@martifylabs/mesh/dist/mesh.esm.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_martifylabs_mesh__WEBPACK_IMPORTED_MODULE_2__]);\n_martifylabs_mesh__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\nconst WalletContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)({\n    wallet: {},\n    connecting: false,\n    walletNameConnected: \"\",\n    walletConnected: false,\n    connectWallet: async (walletName)=>{}\n});\nconst WalletProvider = ({ children  })=>{\n    const { 0: wallet , 1: setWallet  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({});\n    const { 0: walletConnected , 1: setWalletConnected  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const { 0: connecting , 1: setConnecting  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const { 0: walletNameConnected , 1: setWalletNameConnected  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const connectWallet = async (walletName)=>{\n        setConnecting(true);\n        const _wallet = await _martifylabs_mesh__WEBPACK_IMPORTED_MODULE_2__.WalletService.enable(walletName);\n        if (_wallet) {\n            setWallet(_wallet);\n            setWalletNameConnected(walletName);\n            setWalletConnected(true);\n        }\n        setConnecting(false);\n    };\n    const memoedValue = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>({\n            wallet,\n            connecting,\n            walletNameConnected,\n            walletConnected,\n            connectWallet\n        }), [\n        wallet,\n        walletConnected,\n        connecting,\n        walletNameConnected\n    ]);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(WalletContext.Provider, {\n        value: memoedValue,\n        children: children\n    }, void 0, false, {\n        fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/contexts/wallet.tsx\",\n        lineNumber: 49,\n        columnNumber: 5\n    }, undefined);\n};\nfunction useWallet() {\n    return (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(WalletContext);\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb250ZXh0cy93YWxsZXQudHN4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQU1lO0FBRW1DO0FBR2xELE1BQU1NLGFBQWEsaUJBQUdMLG9EQUFhLENBQUM7SUFDbENNLE1BQU0sRUFBRSxFQUFFO0lBQ1ZDLFVBQVUsRUFBRSxLQUFLO0lBQ2pCQyxtQkFBbUIsRUFBRSxFQUFFO0lBQ3ZCQyxlQUFlLEVBQUUsS0FBSztJQUN0QkMsYUFBYSxFQUFFLE9BQU9DLFVBQWtCLEdBQUssRUFBRTtDQUNoRCxDQUFDO0FBRUssTUFBTUMsY0FBYyxHQUFHLENBQUMsRUFBRUMsUUFBUSxHQUEwQixHQUFLO0lBQ3RFLE1BQU0sS0FBQ1AsTUFBTSxNQUFFUSxTQUFTLE1BQUliLCtDQUFRLENBQWdCLEVBQUUsQ0FBa0I7SUFDeEUsTUFBTSxLQUFDUSxlQUFlLE1BQUVNLGtCQUFrQixNQUFJZCwrQ0FBUSxDQUFVLEtBQUssQ0FBQztJQUN0RSxNQUFNLEtBQUNNLFVBQVUsTUFBRVMsYUFBYSxNQUFJZiwrQ0FBUSxDQUFVLEtBQUssQ0FBQztJQUM1RCxNQUFNLEtBQUNPLG1CQUFtQixNQUFFUyxzQkFBc0IsTUFBSWhCLCtDQUFRLENBQVMsRUFBRSxDQUFDO0lBRTFFLE1BQU1TLGFBQWEsR0FBRyxPQUFPQyxVQUFrQixHQUFLO1FBQ2xESyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEIsTUFBTUUsT0FBTyxHQUFHLE1BQU1kLG1FQUFvQixDQUFDTyxVQUFVLENBQUM7UUFDdEQsSUFBSU8sT0FBTyxFQUFFO1lBQ1hKLFNBQVMsQ0FBQ0ksT0FBTyxDQUFDLENBQUM7WUFDbkJELHNCQUFzQixDQUFDTixVQUFVLENBQUMsQ0FBQztZQUNuQ0ksa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDMUI7UUFDREMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ3RCO0lBRUQsTUFBTUksV0FBVyxHQUFHakIsOENBQU8sQ0FDekIsSUFBTSxDQUFDO1lBQ0xHLE1BQU07WUFDTkMsVUFBVTtZQUNWQyxtQkFBbUI7WUFDbkJDLGVBQWU7WUFDZkMsYUFBYTtTQUNkLENBQUMsRUFDRjtRQUFDSixNQUFNO1FBQUVHLGVBQWU7UUFBRUYsVUFBVTtRQUFFQyxtQkFBbUI7S0FBQyxDQUMzRDtJQUVELHFCQUNFLDhEQUFDSCxhQUFhLENBQUNnQixRQUFRO1FBQUNDLEtBQUssRUFBRUYsV0FBVztrQkFDdkNQLFFBQVE7Ozs7O2lCQUNjLENBQ3pCO0NBQ0gsQ0FBQztBQUVhLFNBQVNVLFNBQVMsR0FBRztJQUNsQyxPQUFPckIsaURBQVUsQ0FBQ0csYUFBYSxDQUFDLENBQUM7Q0FDbEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcGJsLWZyb250LWVuZC10ZW1wbGF0ZS1uZXh0anMtbWVzaC8uL2NvbnRleHRzL3dhbGxldC50c3g/MWU3NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHtcbiAgY3JlYXRlQ29udGV4dCxcbiAgdXNlU3RhdGUsXG4gIHVzZUNvbnRleHQsXG4gIHVzZU1lbW8sXG4gIFJlYWN0Tm9kZSxcbn0gZnJvbSBcInJlYWN0XCI7XG5cbmltcG9ydCB7IFdhbGxldFNlcnZpY2UgfSBmcm9tIFwiQG1hcnRpZnlsYWJzL21lc2hcIjtcblxuXG5jb25zdCBXYWxsZXRDb250ZXh0ID0gY3JlYXRlQ29udGV4dCh7XG4gIHdhbGxldDoge30gYXMgV2FsbGV0U2VydmljZSxcbiAgY29ubmVjdGluZzogZmFsc2UsXG4gIHdhbGxldE5hbWVDb25uZWN0ZWQ6ICcnLFxuICB3YWxsZXRDb25uZWN0ZWQ6IGZhbHNlLFxuICBjb25uZWN0V2FsbGV0OiBhc3luYyAod2FsbGV0TmFtZTogc3RyaW5nKSA9PiB7fSxcbn0pO1xuXG5leHBvcnQgY29uc3QgV2FsbGV0UHJvdmlkZXIgPSAoeyBjaGlsZHJlbiB9OiB7Y2hpbGRyZW46IFJlYWN0Tm9kZSB9KSA9PiB7XG4gIGNvbnN0IFt3YWxsZXQsIHNldFdhbGxldF0gPSB1c2VTdGF0ZTxXYWxsZXRTZXJ2aWNlPih7fSBhcyBXYWxsZXRTZXJ2aWNlKTtcbiAgY29uc3QgW3dhbGxldENvbm5lY3RlZCwgc2V0V2FsbGV0Q29ubmVjdGVkXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgY29uc3QgW2Nvbm5lY3RpbmcsIHNldENvbm5lY3RpbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuICBjb25zdCBbd2FsbGV0TmFtZUNvbm5lY3RlZCwgc2V0V2FsbGV0TmFtZUNvbm5lY3RlZF0gPSB1c2VTdGF0ZTxzdHJpbmc+KCcnKTtcblxuICBjb25zdCBjb25uZWN0V2FsbGV0ID0gYXN5bmMgKHdhbGxldE5hbWU6IHN0cmluZykgPT4ge1xuICAgIHNldENvbm5lY3RpbmcodHJ1ZSk7XG4gICAgY29uc3QgX3dhbGxldCA9IGF3YWl0IFdhbGxldFNlcnZpY2UuZW5hYmxlKHdhbGxldE5hbWUpO1xuICAgIGlmIChfd2FsbGV0KSB7XG4gICAgICBzZXRXYWxsZXQoX3dhbGxldCk7XG4gICAgICBzZXRXYWxsZXROYW1lQ29ubmVjdGVkKHdhbGxldE5hbWUpO1xuICAgICAgc2V0V2FsbGV0Q29ubmVjdGVkKHRydWUpO1xuICAgIH1cbiAgICBzZXRDb25uZWN0aW5nKGZhbHNlKTtcbiAgfTtcblxuICBjb25zdCBtZW1vZWRWYWx1ZSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHtcbiAgICAgIHdhbGxldCxcbiAgICAgIGNvbm5lY3RpbmcsXG4gICAgICB3YWxsZXROYW1lQ29ubmVjdGVkLFxuICAgICAgd2FsbGV0Q29ubmVjdGVkLFxuICAgICAgY29ubmVjdFdhbGxldCxcbiAgICB9KSxcbiAgICBbd2FsbGV0LCB3YWxsZXRDb25uZWN0ZWQsIGNvbm5lY3RpbmcsIHdhbGxldE5hbWVDb25uZWN0ZWRdXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8V2FsbGV0Q29udGV4dC5Qcm92aWRlciB2YWx1ZT17bWVtb2VkVmFsdWV9PlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvV2FsbGV0Q29udGV4dC5Qcm92aWRlcj5cbiAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVzZVdhbGxldCgpIHtcbiAgcmV0dXJuIHVzZUNvbnRleHQoV2FsbGV0Q29udGV4dCk7XG59Il0sIm5hbWVzIjpbIlJlYWN0IiwiY3JlYXRlQ29udGV4dCIsInVzZVN0YXRlIiwidXNlQ29udGV4dCIsInVzZU1lbW8iLCJXYWxsZXRTZXJ2aWNlIiwiV2FsbGV0Q29udGV4dCIsIndhbGxldCIsImNvbm5lY3RpbmciLCJ3YWxsZXROYW1lQ29ubmVjdGVkIiwid2FsbGV0Q29ubmVjdGVkIiwiY29ubmVjdFdhbGxldCIsIndhbGxldE5hbWUiLCJXYWxsZXRQcm92aWRlciIsImNoaWxkcmVuIiwic2V0V2FsbGV0Iiwic2V0V2FsbGV0Q29ubmVjdGVkIiwic2V0Q29ubmVjdGluZyIsInNldFdhbGxldE5hbWVDb25uZWN0ZWQiLCJfd2FsbGV0IiwiZW5hYmxlIiwibWVtb2VkVmFsdWUiLCJQcm92aWRlciIsInZhbHVlIiwidXNlV2FsbGV0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./contexts/wallet.tsx\n");

/***/ }),

/***/ "./pages/index.tsx":
/*!*************************!*\
  !*** ./pages/index.tsx ***!
  \*************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @chakra-ui/react */ \"@chakra-ui/react\");\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _contexts_wallet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../contexts/wallet */ \"./contexts/wallet.tsx\");\n/* harmony import */ var _components_wallet_connectWallet__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/wallet/connectWallet */ \"./components/wallet/connectWallet.tsx\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_contexts_wallet__WEBPACK_IMPORTED_MODULE_3__, _components_wallet_connectWallet__WEBPACK_IMPORTED_MODULE_4__]);\n([_contexts_wallet__WEBPACK_IMPORTED_MODULE_3__, _components_wallet_connectWallet__WEBPACK_IMPORTED_MODULE_4__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\nconst Home = ()=>{\n    const { connecting , walletConnected , wallet  } = (0,_contexts_wallet__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n    const { 0: currentNetwork , 1: setCurrentNetwork  } = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(\"Not Connected\");\n    const { 0: loading , 1: setLoading  } = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(false);\n    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{\n        const fetchNetwork = async ()=>{\n            const _network = await wallet.getNetworkId();\n            if (_network === 0) {\n                setCurrentNetwork(\"Testnet\");\n            } else if (_network === 1) {\n                setCurrentNetwork(\"Mainnet\");\n            }\n            setLoading(false);\n        };\n        if (walletConnected) {\n            setLoading(true);\n            fetchNetwork();\n        }\n    }, [\n        walletConnected,\n        wallet\n    ]);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Box, {\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Heading, {\n                as: \"h1\",\n                size: \"3xl\",\n                noOfLines: 1,\n                mb: 1,\n                children: \"Huestern Yunion\"\n            }, void 0, false, {\n                fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                lineNumber: 36,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Text, {\n                fontSize: \"xl\",\n                noOfLines: 1,\n                mb: 4,\n                children: \"Huestern Yunion helps businesses in Latin America get paid by anyone, anywhere in the world.\"\n            }, void 0, false, {\n                fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                lineNumber: 39,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Heading, {\n                children: \"Step 1: Check your connection\"\n            }, void 0, false, {\n                fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                lineNumber: 43,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Box, {\n                m: 4,\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_wallet_connectWallet__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {}, void 0, false, {\n                    fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                    lineNumber: 47,\n                    columnNumber: 9\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                lineNumber: 46,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Box, {\n                m: \"5\",\n                p: \"5\",\n                bg: \"teal.700\",\n                color: \"white\",\n                children: loading ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Center, {\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Spinner, {}, void 0, false, {\n                        fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                        lineNumber: 52,\n                        columnNumber: 13\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                    lineNumber: 51,\n                    columnNumber: 11\n                }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n                    children: walletConnected ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Box, {\n                        w: \"80%\",\n                        mx: \"auto\",\n                        my: \"5\",\n                        p: \"5\",\n                        bg: \"green.100\",\n                        color: \"black\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Text, {\n                            fontSize: \"xl\",\n                            children: [\n                                \"Congratulations! You are connected to \",\n                                walletConnected,\n                                \" wallet on \",\n                                currentNetwork,\n                                \" \"\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                            lineNumber: 59,\n                            columnNumber: 19\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                        lineNumber: 58,\n                        columnNumber: 17\n                    }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Box, {\n                        w: \"80%\",\n                        mx: \"auto\",\n                        my: \"5\",\n                        p: \"5\",\n                        bg: \"red.100\",\n                        color: \"black\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_1__.Text, {\n                            fontSize: \"xl\",\n                            children: \"No wallet is connected yet. \"\n                        }, void 0, false, {\n                            fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                            lineNumber: 63,\n                            columnNumber: 19\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                        lineNumber: 62,\n                        columnNumber: 17\n                    }, undefined)\n                }, void 0, false)\n            }, void 0, false, {\n                fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n                lineNumber: 49,\n                columnNumber: 7\n            }, undefined)\n        ]\n    }, void 0, true, {\n        fileName: \"/Users/macadmin/Documents/plutus-emurgo-finalProject/huestern-yunion/pages/index.tsx\",\n        lineNumber: 35,\n        columnNumber: 5\n    }, undefined);\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Home);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O2lDQUdUOzs7Ozt5QkFFRDs7Ozs7O2lCQUNGLENBQ1A7Q0FDRjtBQUVELGlFQUFlZixJQUFJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHBibC1mcm9udC1lbmQtdGVtcGxhdGUtbmV4dGpzLW1lc2gvLi9wYWdlcy9pbmRleC50c3g/MDdmZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBCb3gsIEhlYWRpbmcsIFRleHQsIFNwaW5uZXIsIENlbnRlclxufSBmcm9tICdAY2hha3JhLXVpL3JlYWN0J1xuaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHR5cGUgeyBOZXh0UGFnZSB9IGZyb20gXCJuZXh0XCI7XG5pbXBvcnQgdXNlV2FsbGV0IGZyb20gJy4uL2NvbnRleHRzL3dhbGxldCc7XG5pbXBvcnQgQ29ubmVjdFdhbGxldCBmcm9tICcuLi9jb21wb25lbnRzL3dhbGxldC9jb25uZWN0V2FsbGV0JztcblxuY29uc3QgSG9tZTogTmV4dFBhZ2UgPSAoKSA9PiB7XG4gIGNvbnN0IHsgY29ubmVjdGluZywgd2FsbGV0Q29ubmVjdGVkLCB3YWxsZXQgfSA9IHVzZVdhbGxldCgpO1xuICBjb25zdCBbY3VycmVudE5ldHdvcmssIHNldEN1cnJlbnROZXR3b3JrXSA9IHVzZVN0YXRlPFwiVGVzdG5ldFwiIHwgXCJNYWlubmV0XCIgfCBcIk5vdCBDb25uZWN0ZWRcIj4oXCJOb3QgQ29ubmVjdGVkXCIpO1xuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcblxuICAgIGNvbnN0IGZldGNoTmV0d29yayA9IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IF9uZXR3b3JrID0gYXdhaXQgd2FsbGV0LmdldE5ldHdvcmtJZCgpO1xuICAgICAgaWYgKF9uZXR3b3JrID09PSAwKSB7XG4gICAgICAgIHNldEN1cnJlbnROZXR3b3JrKFwiVGVzdG5ldFwiKVxuICAgICAgfVxuICAgICAgZWxzZSBpZiAoX25ldHdvcmsgPT09IDEpIHtcbiAgICAgICAgc2V0Q3VycmVudE5ldHdvcmsoXCJNYWlubmV0XCIpXG4gICAgICB9XG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICB9XG5cbiAgICBpZiAod2FsbGV0Q29ubmVjdGVkKSB7XG4gICAgICBzZXRMb2FkaW5nKHRydWUpO1xuICAgICAgZmV0Y2hOZXR3b3JrKCk7XG4gICAgfVxuXG4gIH0sIFt3YWxsZXRDb25uZWN0ZWQsIHdhbGxldF0pXG5cbiAgcmV0dXJuIChcbiAgICA8Qm94PlxuICAgICAgPEhlYWRpbmcgYXM9J2gxJyBzaXplPSczeGwnIG5vT2ZMaW5lcz17MX0gbWI9ezF9PlxuICAgICAgICBIdWVzdGVybiBZdW5pb25cbiAgICAgIDwvSGVhZGluZz5cbiAgICAgIDxUZXh0IGZvbnRTaXplPSd4bCcgbm9PZkxpbmVzPXsxfSBtYj17NH0+XG4gICAgICAgIEh1ZXN0ZXJuIFl1bmlvbiBoZWxwcyBidXNpbmVzc2VzIGluIExhdGluIEFtZXJpY2EgZ2V0IHBhaWQgYnkgYW55b25lLCBhbnl3aGVyZSBpbiB0aGVcbiAgICAgICAgd29ybGQuXG4gICAgICA8L1RleHQ+XG4gICAgICA8SGVhZGluZz5cbiAgICAgICAgU3RlcCAxOiBDaGVjayB5b3VyIGNvbm5lY3Rpb25cbiAgICAgIDwvSGVhZGluZz5cbiAgICAgIDxCb3ggbT17NH0+XG4gICAgICAgIDxDb25uZWN0V2FsbGV0Lz5cbiAgICAgIDwvQm94PlxuICAgICAgPEJveCBtPSc1JyBwPSc1JyBiZz0ndGVhbC43MDAnIGNvbG9yPSd3aGl0ZSc+XG4gICAgICAgIHtsb2FkaW5nID8gKFxuICAgICAgICAgIDxDZW50ZXI+XG4gICAgICAgICAgICA8U3Bpbm5lciAvPlxuICAgICAgICAgIDwvQ2VudGVyPlxuICAgICAgICApIDogKFxuICAgICAgICAgIDw+XG4gICAgICAgICAgICB7d2FsbGV0Q29ubmVjdGVkID9cbiAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgIDxCb3ggdz0nODAlJyBteD0nYXV0bycgbXk9JzUnIHA9JzUnIGJnPSdncmVlbi4xMDAnIGNvbG9yPSdibGFjayc+XG4gICAgICAgICAgICAgICAgICA8VGV4dCBmb250U2l6ZT0neGwnPkNvbmdyYXR1bGF0aW9ucyEgWW91IGFyZSBjb25uZWN0ZWQgdG8ge3dhbGxldENvbm5lY3RlZH0gd2FsbGV0IG9uIHtjdXJyZW50TmV0d29ya30gPC9UZXh0PlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgIDxCb3ggdz0nODAlJyBteD0nYXV0bycgbXk9JzUnIHA9JzUnIGJnPSdyZWQuMTAwJyBjb2xvcj0nYmxhY2snPlxuICAgICAgICAgICAgICAgICAgPFRleHQgZm9udFNpemU9J3hsJz5ObyB3YWxsZXQgaXMgY29ubmVjdGVkIHlldC4gPC9UZXh0PlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9XG4gICAgICAgICAgPC8+XG4gICAgICAgICl9XG4gICAgICA8L0JveD5cbiAgICA8L0JveD5cbiAgKVxufVxuXG5leHBvcnQgZGVmYXVsdCBIb21lXG4iXSwibmFtZXMiOlsiQm94IiwiSGVhZGluZyIsIlRleHQiLCJTcGlubmVyIiwiQ2VudGVyIiwidXNlRWZmZWN0IiwidXNlU3RhdGUiLCJ1c2VXYWxsZXQiLCJDb25uZWN0V2FsbGV0IiwiSG9tZSIsImNvbm5lY3RpbmciLCJ3YWxsZXRDb25uZWN0ZWQiLCJ3YWxsZXQiLCJjdXJyZW50TmV0d29yayIsInNldEN1cnJlbnROZXR3b3JrIiwibG9hZGluZyIsInNldExvYWRpbmciLCJmZXRjaE5ldHdvcmsiLCJfbmV0d29yayIsImdldE5ldHdvcmtJZCIsImFzIiwic2l6ZSIsIm5vT2ZMaW5lcyIsIm1iIiwiZm9udFNpemUiLCJtIiwicCIsImJnIiwiY29sb3IiLCJ3IiwibXgiLCJteSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./pages/index.tsx\n");

/***/ }),

/***/ "@chakra-ui/react":
/*!***********************************!*\
  !*** external "@chakra-ui/react" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("@chakra-ui/react");

/***/ }),

/***/ "@emurgo/cardano-serialization-lib-nodejs":
/*!***********************************************************!*\
  !*** external "@emurgo/cardano-serialization-lib-nodejs" ***!
  \***********************************************************/
/***/ ((module) => {

module.exports = require("@emurgo/cardano-serialization-lib-nodejs");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = require("axios");

/***/ }),

/***/ "axios/index":
/*!******************************!*\
  !*** external "axios/index" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("axios/index");

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "react" ***!
  \************************/
/***/ ((module) => {

module.exports = require("react");

/***/ }),

/***/ "react/jsx-dev-runtime":
/*!****************************************!*\
  !*** external "react/jsx-dev-runtime" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("react/jsx-dev-runtime");

/***/ }),

/***/ "tslib":
/*!************************!*\
  !*** external "tslib" ***!
  \************************/
/***/ ((module) => {

module.exports = import("tslib");;

/***/ }),

/***/ "./node_modules/@martifylabs/mesh/dist/mesh.esm.js":
/*!*********************************************************!*\
  !*** ./node_modules/@martifylabs/mesh/dist/mesh.esm.js ***!
  \*********************************************************/
/***/ ((__webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(__webpack_module__, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"TransactionService\": () => (/* binding */ TransactionService),\n/* harmony export */   \"WalletService\": () => (/* binding */ WalletService),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var axios_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios/index */ \"axios/index\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! tslib */ \"tslib\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([tslib__WEBPACK_IMPORTED_MODULE_2__]);\ntslib__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\nfunction _regeneratorRuntime() {\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n\n  _regeneratorRuntime = function () {\n    return exports;\n  };\n\n  var exports = {},\n      Op = Object.prototype,\n      hasOwn = Op.hasOwnProperty,\n      $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n      iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n      asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n      toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function (obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n        generator = Object.create(protoGenerator.prototype),\n        context = new Context(tryLocsList || []);\n    return generator._invoke = function (innerFn, self, context) {\n      var state = \"suspendedStart\";\n      return function (method, arg) {\n        if (\"executing\" === state) throw new Error(\"Generator is already running\");\n\n        if (\"completed\" === state) {\n          if (\"throw\" === method) throw arg;\n          return doneResult();\n        }\n\n        for (context.method = method, context.arg = arg;;) {\n          var delegate = context.delegate;\n\n          if (delegate) {\n            var delegateResult = maybeInvokeDelegate(delegate, context);\n\n            if (delegateResult) {\n              if (delegateResult === ContinueSentinel) continue;\n              return delegateResult;\n            }\n          }\n\n          if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n            if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n            context.dispatchException(context.arg);\n          } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n          state = \"executing\";\n          var record = tryCatch(innerFn, self, context);\n\n          if (\"normal\" === record.type) {\n            if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n            return {\n              value: record.arg,\n              done: context.done\n            };\n          }\n\n          \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n        }\n      };\n    }(innerFn, self, context), generator;\n  }\n\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n\n  function Generator() {}\n\n  function GeneratorFunction() {}\n\n  function GeneratorFunctionPrototype() {}\n\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n      NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n            value = result.value;\n        return value && \"object\" == typeof value && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n\n      reject(record.arg);\n    }\n\n    var previousPromise;\n\n    this._invoke = function (method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function (resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n    };\n  }\n\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n\n    if (undefined === method) {\n      if (context.delegate = null, \"throw\" === context.method) {\n        if (delegate.iterator.return && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel;\n        context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n            next = function next() {\n          for (; ++i < iterable.length;) if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n\n          return next.value = undefined, next.done = !0, next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    return {\n      next: doneResult\n    };\n  }\n\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, \"constructor\", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (object) {\n    var keys = [];\n\n    for (var key in object) keys.push(key);\n\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function (skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n    },\n    stop: function () {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function (exception) {\n      if (this.done) throw exception;\n      var context = this;\n\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n            record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n              hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function (type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function (record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function (finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    catch: function (tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n\n          return thrown;\n        }\n      }\n\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function (iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n\n  _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\n\nfunction _objectDestructuringEmpty(obj) {\n  if (obj == null) throw new TypeError(\"Cannot destructure undefined\");\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar Blockfrost = /*#__PURE__*/function () {\n  function Blockfrost() {}\n\n  var _proto = Blockfrost.prototype;\n\n  _proto.init = /*#__PURE__*/function () {\n    var _init = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref) {\n      var blockfrostApiKey, network, networkEndpoint;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              blockfrostApiKey = _ref.blockfrostApiKey, network = _ref.network;\n              networkEndpoint = network == 0 ? 'https://cardano-testnet.blockfrost.io/api/v0' : 'https://cardano-mainnet.blockfrost.io/api/v0';\n              this._instance = axios_index__WEBPACK_IMPORTED_MODULE_0__.create({\n                baseURL: networkEndpoint,\n                headers: {\n                  project_id: blockfrostApiKey\n                }\n              });\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function init(_x) {\n      return _init.apply(this, arguments);\n    }\n\n    return init;\n  }();\n\n  _proto.isLoaded = function isLoaded() {\n    return this._instance !== undefined;\n  };\n\n  _proto._request = /*#__PURE__*/function () {\n    var _request2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref2) {\n      var _ref2$endpoint, endpoint, _ref2$body, body, _ref2$method, method;\n\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _ref2$endpoint = _ref2.endpoint, endpoint = _ref2$endpoint === void 0 ? '' : _ref2$endpoint, _ref2$body = _ref2.body, body = _ref2$body === void 0 ? null : _ref2$body, _ref2$method = _ref2.method, method = _ref2$method === void 0 ? 'GET' : _ref2$method;\n\n              if (!(method == 'GET')) {\n                _context2.next = 5;\n                break;\n              }\n\n              _context2.next = 4;\n              return this._instance.get(\"\" + endpoint).then(function (_ref3) {\n                var data = _ref3.data;\n                return data;\n              })[\"catch\"](function (error) {\n                throw error;\n              });\n\n            case 4:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 5:\n              if (!(method == 'POST')) {\n                _context2.next = 9;\n                break;\n              }\n\n              _context2.next = 8;\n              return this._instance.post(\"\" + endpoint, body).then(function (_ref4) {\n                var data = _ref4.data;\n                return data;\n              })[\"catch\"](function (error) {\n                throw error;\n              });\n\n            case 8:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    function _request(_x2) {\n      return _request2.apply(this, arguments);\n    }\n\n    return _request;\n  }();\n\n  _proto.addressesAddressUtxos = /*#__PURE__*/function () {\n    var _addressesAddressUtxos = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref5) {\n      var address, _ref5$page, page, _ref5$limit, limit;\n\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              address = _ref5.address, _ref5$page = _ref5.page, page = _ref5$page === void 0 ? 1 : _ref5$page, _ref5$limit = _ref5.limit, limit = _ref5$limit === void 0 ? 100 : _ref5$limit;\n              _context3.next = 3;\n              return this._request({\n                endpoint: \"/addresses/\" + address + \"/utxos?page=\" + page + \"&count=\" + limit\n              });\n\n            case 3:\n              return _context3.abrupt(\"return\", _context3.sent);\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    function addressesAddressUtxos(_x3) {\n      return _addressesAddressUtxos.apply(this, arguments);\n    }\n\n    return addressesAddressUtxos;\n  }();\n\n  _proto.addressesAddressUtxosAsset = /*#__PURE__*/function () {\n    var _addressesAddressUtxosAsset = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_ref6) {\n      var address, asset;\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              address = _ref6.address, asset = _ref6.asset;\n              _context4.next = 3;\n              return this._request({\n                endpoint: \"/addresses/\" + address + \"/utxos/\" + asset\n              });\n\n            case 3:\n              return _context4.abrupt(\"return\", _context4.sent);\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    function addressesAddressUtxosAsset(_x4) {\n      return _addressesAddressUtxosAsset.apply(this, arguments);\n    }\n\n    return addressesAddressUtxosAsset;\n  }()\n  /**\r\n   * Information about a specific asset\r\n   * @param asset Concatenation of the policy_id and hex-encoded asset_name\r\n   * @returns asset\r\n   */\n  ;\n\n  _proto.assetSpecificAsset =\n  /*#__PURE__*/\n  function () {\n    var _assetSpecificAsset = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(_ref7) {\n      var asset;\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              asset = _ref7.asset;\n              _context5.next = 3;\n              return this._request({\n                endpoint: \"/assets/\" + asset\n              });\n\n            case 3:\n              return _context5.abrupt(\"return\", _context5.sent);\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    function assetSpecificAsset(_x5) {\n      return _assetSpecificAsset.apply(this, arguments);\n    }\n\n    return assetSpecificAsset;\n  }()\n  /**\r\n   * Return the transactions within the latest block.\r\n   * @returns\r\n   */\n  ;\n\n  _proto.blockLatestBlock =\n  /*#__PURE__*/\n  function () {\n    var _blockLatestBlock = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n      return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return this._request({\n                endpoint: '/blocks/latest'\n              });\n\n            case 2:\n              return _context6.abrupt(\"return\", _context6.sent);\n\n            case 3:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6, this);\n    }));\n\n    function blockLatestBlock() {\n      return _blockLatestBlock.apply(this, arguments);\n    }\n\n    return blockLatestBlock;\n  }()\n  /**\r\n   * Return the protocol parameters for the latest epoch.\r\n   * @returns\r\n   */\n  ;\n\n  _proto.epochsLatestEpochProtocolParameters =\n  /*#__PURE__*/\n  function () {\n    var _epochsLatestEpochProtocolParameters = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return this._request({\n                endpoint: '/epochs/latest/parameters'\n              });\n\n            case 2:\n              return _context7.abrupt(\"return\", _context7.sent);\n\n            case 3:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7, this);\n    }));\n\n    function epochsLatestEpochProtocolParameters() {\n      return _epochsLatestEpochProtocolParameters.apply(this, arguments);\n    }\n\n    return epochsLatestEpochProtocolParameters;\n  }();\n\n  _proto.transactionsSpecificTransaction = /*#__PURE__*/function () {\n    var _transactionsSpecificTransaction = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(_ref8) {\n      var hash;\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              hash = _ref8.hash;\n              _context8.next = 3;\n              return this._request({\n                endpoint: \"/txs/\" + hash\n              });\n\n            case 3:\n              return _context8.abrupt(\"return\", _context8.sent);\n\n            case 4:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8, this);\n    }));\n\n    function transactionsSpecificTransaction(_x6) {\n      return _transactionsSpecificTransaction.apply(this, arguments);\n    }\n\n    return transactionsSpecificTransaction;\n  }();\n\n  _proto.transactionsTransactionUTXOs = /*#__PURE__*/function () {\n    var _transactionsTransactionUTXOs = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(_ref9) {\n      var hash;\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              hash = _ref9.hash;\n              _context9.next = 3;\n              return this._request({\n                endpoint: \"/txs/\" + hash + \"/utxos\"\n              });\n\n            case 3:\n              return _context9.abrupt(\"return\", _context9.sent);\n\n            case 4:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9, this);\n    }));\n\n    function transactionsTransactionUTXOs(_x7) {\n      return _transactionsTransactionUTXOs.apply(this, arguments);\n    }\n\n    return transactionsTransactionUTXOs;\n  }();\n\n  return Blockfrost;\n}();\n\nvar _excluded = [\"default\"];\n\nvar importCSL = /*#__PURE__*/function () {\n  var _ref = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(typeof window !== 'undefined')) {\n              _context.next = 6;\n              break;\n            }\n\n            _context.next = 3;\n            return __webpack_require__.e(/*! import() */ \"node_modules_emurgo_cardano-serialization-lib-browser_cardano_serialization_lib_js\").then(__webpack_require__.bind(__webpack_require__, /*! @emurgo/cardano-serialization-lib-browser */ \"./node_modules/@emurgo/cardano-serialization-lib-browser/cardano_serialization_lib.js\"));\n\n          case 3:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 6:\n            _context.next = 8;\n            return Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! @emurgo/cardano-serialization-lib-nodejs */ \"@emurgo/cardano-serialization-lib-nodejs\", 19));\n\n          case 8:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function importCSL() {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar resolveImport = /*#__PURE__*/function () {\n  var _ref2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n    var _yield$importCSL, rest;\n\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return importCSL();\n\n          case 3:\n            _yield$importCSL = _context2.sent;\n            rest = _objectWithoutPropertiesLoose(_yield$importCSL, _excluded);\n            return _context2.abrupt(\"return\", rest);\n\n          case 9:\n            _context2.prev = 9;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.error('An error occurred when importing the Cardano Serialization Lib module.');\n            throw _context2.t0;\n\n          case 13:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[0, 9]]);\n  }));\n\n  return function resolveImport() {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar csl = await /*#__PURE__*/resolveImport();\n\nvar fromHex = function fromHex(hex) {\n  return Buffer.from(hex, 'hex');\n};\nvar toHex = function toHex(bytes) {\n  return Buffer.from(bytes).toString('hex');\n};\nvar toLovelace = function toLovelace(ada) {\n  return ada * 1000000;\n};\nvar fromFloat = function fromFloat(_float) {\n  var parts = _float.split('.');\n\n  var numerator = \"\" + parseInt(parts[1], 10);\n  var denominator = '1' + '0'.repeat(parts[1].length);\n  return {\n    numerator: numerator,\n    denominator: denominator\n  };\n};\nvar HexToAscii = function HexToAscii(string) {\n  return fromHex(string).toString('ascii');\n};\nvar assetsToValue = function assetsToValue(assets) {\n  var multiAsset = csl.MultiAsset[\"new\"]();\n  var lovelace = assets['lovelace'];\n  var units = Object.keys(assets);\n  var policies = Array.from(new Set(units.filter(function (unit) {\n    return unit !== 'lovelace';\n  }).map(function (unit) {\n    return unit.slice(0, 56);\n  })));\n  policies.forEach(function (policy) {\n    var policyUnits = units.filter(function (unit) {\n      return unit.slice(0, 56) === policy;\n    });\n    var assetsValue = csl.Assets[\"new\"]();\n    policyUnits.forEach(function (unit) {\n      assetsValue.insert(csl.AssetName[\"new\"](fromHex(unit.slice(56))), csl.BigNum.from_str(assets[unit].toString()));\n    });\n    multiAsset.insert(csl.ScriptHash.from_bytes(fromHex(policy)), assetsValue);\n  });\n  var value = csl.Value[\"new\"](csl.BigNum.from_str(lovelace ? lovelace.toString() : '0'));\n  if (units.length > 1 || !lovelace) value.set_multiasset(multiAsset);\n  return value;\n};\nvar StringToAddress = function StringToAddress(string) {\n  return csl.Address.from_bech32(string);\n};\nvar valueToAssets = function valueToAssets(value) {\n  var assets = [];\n  assets.push({\n    unit: 'lovelace',\n    quantity: value.coin().to_str()\n  });\n\n  if (value.multiasset()) {\n    var multiAssets = value.multiasset().keys();\n\n    for (var j = 0; j < multiAssets.len(); j++) {\n      var policy = multiAssets.get(j);\n      var policyAssets = value.multiasset().get(policy);\n      var assetNames = policyAssets.keys();\n\n      for (var k = 0; k < assetNames.len(); k++) {\n        var policyAsset = assetNames.get(k);\n        var quantity = policyAssets.get(policyAsset);\n        var asset = toHex(policy.to_bytes()) + toHex(policyAsset.name());\n        assets.push({\n          unit: asset,\n          quantity: quantity.to_str()\n        });\n      }\n    }\n  }\n\n  return assets;\n};\nvar getAddressKeyHashHex = function getAddressKeyHashHex(address) {\n  var _csl$BaseAddress$from, _csl$BaseAddress$from2;\n\n  var addr = (_csl$BaseAddress$from = csl.BaseAddress.from_address(csl.Address.from_bech32(address))) == null ? void 0 : (_csl$BaseAddress$from2 = _csl$BaseAddress$from.payment_cred().to_keyhash()) == null ? void 0 : _csl$BaseAddress$from2.to_bytes();\n  if (addr) return toHex(addr);\n  return null;\n};\nvar getAddressKeyHash = function getAddressKeyHash(address) {\n  var _csl$BaseAddress$from3;\n\n  return (_csl$BaseAddress$from3 = csl.BaseAddress.from_address(csl.Address.from_bech32(address))) == null ? void 0 : _csl$BaseAddress$from3.payment_cred().to_keyhash();\n};\nvar plutusDataToHex = function plutusDataToHex(datum) {\n  return toHex(csl.hash_plutus_data(datum).to_bytes());\n};\n\nvar MIN_ADA_REQUIRED_WITH_ASSETS = 2000000;\nvar IPFS_PROVIDER = 'https://infura-ipfs.io/ipfs/';\nvar MakeTxError = {\n  NotEnoughLovelaceInput: 'Not enough lovelace to complete this transaction.',\n  NotEnoughAssetsInput: 'Not enough assets in the inputs to complete this transaction.',\n  InputNotEqualOutput: 'Input not equal to output',\n  LovelaceTooLittle: 'Lovelace must be greater than 1000000',\n  NoRecipientsAddress: 'Missing recipient address'\n};\n\nvar convertMetadataPropToString = function convertMetadataPropToString(src) {\n  if (typeof src === 'string') return src;else if (Array.isArray(src)) return src.join('');\n  return null;\n};\nvar linkToSrc = function linkToSrc(link, base64) {\n  if (base64 === void 0) {\n    base64 = false;\n  }\n\n  var base64regex = /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;\n  if (link.startsWith('https://')) return link;else if (link.startsWith('ipfs://')) return \"\" + IPFS_PROVIDER + link.split('ipfs://')[1].split('ipfs/').slice(-1)[0]; // IPFS_PROVIDER +\n  // '/' +\n  // link.split('ipfs://')[1].split('ipfs/').slice(-1)[0]\n  else if (link.startsWith('Qm') && link.length === 46 || link.startsWith('baf') && link.length === 59) {\n    // return IPFS_PROVIDER + '/' + link;\n    return \"\" + IPFS_PROVIDER + link;\n  } else if (base64 && base64regex.test(link)) return 'data:image/png;base64,' + link;else if (link.startsWith('data:image')) return link;\n  return null;\n};\n\nvar Wallet = /*#__PURE__*/function () {\n  function Wallet(_ref) {\n    var blockfrost = _ref.blockfrost;\n\n    this._init();\n\n    this._blockfrost = blockfrost;\n  }\n\n  var _proto = Wallet.prototype;\n\n  _proto._init = /*#__PURE__*/function () {\n    var _init2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function _init() {\n      return _init2.apply(this, arguments);\n    }\n\n    return _init;\n  }();\n\n  _proto._showDepreciating = function _showDepreciating() {\n    console.log(\"Depreciating.\");\n  }\n  /**\r\n   * Enable and connect wallet\r\n   *\r\n   * @example\r\n   * ```ts\r\n   * let connected = await Mesh.enableWallet({ walletName: 'ccvault' });\r\n   * ```\r\n   *\r\n   * @param walletName - Available wallets are `ccvault`, `gerowallet` and `nami`\r\n   * @returns - True if wallet is connected\r\n   */\n  ;\n\n  _proto.enable =\n  /*#__PURE__*/\n  function () {\n    var _enable = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref2) {\n      var walletName, _window$cardano, _window$cardano$ccvau, instance, _window$cardano2, _window$cardano2$gero, _instance, _window$cardano3, _window$cardano3$nami, _instance2;\n\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              walletName = _ref2.walletName;\n\n              this._showDepreciating();\n\n              if (!(walletName === 'ccvault')) {\n                _context2.next = 11;\n                break;\n              }\n\n              _context2.next = 5;\n              return (_window$cardano = window.cardano) == null ? void 0 : (_window$cardano$ccvau = _window$cardano.ccvault) == null ? void 0 : _window$cardano$ccvau.enable();\n\n            case 5:\n              instance = _context2.sent;\n\n              if (!instance) {\n                _context2.next = 9;\n                break;\n              }\n\n              this._provider = instance;\n              return _context2.abrupt(\"return\", true);\n\n            case 9:\n              _context2.next = 27;\n              break;\n\n            case 11:\n              if (!(walletName === 'gerowallet')) {\n                _context2.next = 20;\n                break;\n              }\n\n              _context2.next = 14;\n              return (_window$cardano2 = window.cardano) == null ? void 0 : (_window$cardano2$gero = _window$cardano2.gerowallet) == null ? void 0 : _window$cardano2$gero.enable();\n\n            case 14:\n              _instance = _context2.sent;\n\n              if (!_instance) {\n                _context2.next = 18;\n                break;\n              }\n\n              this._provider = _instance;\n              return _context2.abrupt(\"return\", true);\n\n            case 18:\n              _context2.next = 27;\n              break;\n\n            case 20:\n              if (!(walletName === 'nami' || walletName === null)) {\n                _context2.next = 27;\n                break;\n              }\n\n              _context2.next = 23;\n              return (_window$cardano3 = window.cardano) == null ? void 0 : (_window$cardano3$nami = _window$cardano3.nami) == null ? void 0 : _window$cardano3$nami.enable();\n\n            case 23:\n              _instance2 = _context2.sent;\n\n              if (!_instance2) {\n                _context2.next = 27;\n                break;\n              }\n\n              this._provider = _instance2;\n              return _context2.abrupt(\"return\", true);\n\n            case 27:\n              return _context2.abrupt(\"return\", false);\n\n            case 28:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    function enable(_x) {\n      return _enable.apply(this, arguments);\n    }\n\n    return enable;\n  }();\n\n  _proto.isEnabled = /*#__PURE__*/function () {\n    var _isEnabled = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              return _context3.abrupt(\"return\", this._provider !== undefined);\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    function isEnabled() {\n      return _isEnabled.apply(this, arguments);\n    }\n\n    return isEnabled;\n  }()\n  /**\r\n   * Returns the network id of the currently connected account. 0 is testnet and 1 is mainnet but other networks can possibly be returned by wallets. Those other network ID values are not governed by this document.\r\n   * @returns 0 is testnet and 1 is mainnet\r\n   */\n  ;\n\n  _proto.getNetworkId =\n  /*#__PURE__*/\n  function () {\n    var _getNetworkId = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return this._provider.getNetworkId();\n\n            case 2:\n              return _context4.abrupt(\"return\", _context4.sent);\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    function getNetworkId() {\n      return _getNetworkId.apply(this, arguments);\n    }\n\n    return getNetworkId;\n  }()\n  /**\r\n   * return a list of all UTXOs (unspent transaction outputs) controlled by the wallet\r\n   * @returns list of all UTXOs\r\n   */\n  // async getUtxos(options?: { returnAssets?: boolean }): Promise<any> {\n  //   let utxos = await this._provider.getUtxos();\n  //   if (options?.returnAssets && options.returnAssets) {\n  //     if (utxos === undefined) {\n  //       throw 'No utxos';\n  //     }\n  //     let utxosAssets: {}[] = [];\n  //     // TODO, lets get UTXOs like this as default https://docs.blockfrost.io/#tag/Cardano-Addresses/paths/~1addresses~1{address}~1utxos/get\n  //     utxos.map((u) => {\n  //       let thisUtxo: {\n  //         cbor: string; // TODO name `cbor` ok?\n  //         assets: { [assetId: string]: number };\n  //         paymentAddr: string;\n  //         txHash: string; // TODO to get?\n  //         outputIndex: number; // TODO to get?\n  //         dataHash?;\n  //       } = {\n  //         cbor: u,\n  //         assets: {},\n  //         paymentAddr: '',\n  //         txHash: '',\n  //         outputIndex: 0,\n  //       };\n  //       const utxo = csl.TransactionUnspentOutput.from_bytes(\n  //         Buffer.from(u, 'hex')\n  //       );\n  //       thisUtxo.paymentAddr = utxo.output().address().to_bech32();\n  //       valueToAssets(utxo.output().amount()).forEach((nnn) => {\n  //         const unit = nnn.unit;\n  //         const _policy = unit.slice(0, 56);\n  //         const _name = HexToAscii(unit.slice(56));\n  //         const assetId =\n  //           _policy == 'lovelace' ? 'lovelace' : `${_policy}.${_name}`;\n  //         thisUtxo.assets[assetId] = parseInt(nnn.quantity);\n  //       });\n  //       utxosAssets.push(thisUtxo);\n  //     });\n  //     return utxosAssets;\n  //   }\n  //   return utxos;\n  // }\n  ;\n\n  _proto.getUtxos =\n  /*#__PURE__*/\n  function () {\n    var _getUtxos = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n      var utxos, utxosAssets;\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return this._provider.getUtxos();\n\n            case 2:\n              utxos = _context5.sent;\n\n              if (!(utxos === undefined)) {\n                _context5.next = 5;\n                break;\n              }\n\n              throw 'No utxos';\n\n            case 5:\n              utxosAssets = []; // TODO, lets get UTXOs like this as default https://docs.blockfrost.io/#tag/Cardano-Addresses/paths/~1addresses~1{address}~1utxos/get\n\n              utxos.map(function (u) {\n                var thisUtxo = {\n                  cbor: u,\n                  assets: {},\n                  address: '',\n                  txHash: '',\n                  outputIndex: 0\n                };\n                var utxo = csl.TransactionUnspentOutput.from_bytes(Buffer.from(u, 'hex'));\n                thisUtxo.address = utxo.output().address().to_bech32(); // thisUtxo.txHash = utxo.output().data_hash()\n                //   ? toHex(utxo.output().data_hash()!.to_bytes())\n                //   : '';\n\n                valueToAssets(utxo.output().amount()).forEach(function (nnn) {\n                  var unit = nnn.unit;\n\n                  var _policy = unit.slice(0, 56);\n\n                  var _name = HexToAscii(unit.slice(56));\n\n                  var assetId = _policy == 'lovelace' ? 'lovelace' : _policy + \".\" + _name;\n                  thisUtxo.assets[assetId] = parseInt(nnn.quantity);\n                });\n                utxosAssets.push(thisUtxo);\n              });\n              return _context5.abrupt(\"return\", utxosAssets);\n\n            case 8:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    function getUtxos() {\n      return _getUtxos.apply(this, arguments);\n    }\n\n    return getUtxos;\n  }();\n\n  _proto.getBalance = /*#__PURE__*/function () {\n    var _getBalance = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n      return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return this._provider.getBalance();\n\n            case 2:\n              return _context6.abrupt(\"return\", _context6.sent);\n\n            case 3:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6, this);\n    }));\n\n    function getBalance() {\n      return _getBalance.apply(this, arguments);\n    }\n\n    return getBalance;\n  }()\n  /**\r\n   * Returns a list of all used (included in some on-chain transaction) addresses controlled by the wallet.\r\n   * @returns list of bech32 addresses\r\n   */\n  ;\n\n  _proto.getUsedAddresses =\n  /*#__PURE__*/\n  function () {\n    var _getUsedAddresses = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n      var usedAddresses;\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return this._provider.getUsedAddresses();\n\n            case 2:\n              usedAddresses = _context7.sent;\n              return _context7.abrupt(\"return\", usedAddresses.map(function (address) {\n                return csl.Address.from_bytes(fromHex(address)).to_bech32();\n              }));\n\n            case 4:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7, this);\n    }));\n\n    function getUsedAddresses() {\n      return _getUsedAddresses.apply(this, arguments);\n    }\n\n    return getUsedAddresses;\n  }();\n\n  _proto.getUnusedAddresses = /*#__PURE__*/function () {\n    var _getUnusedAddresses = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n      var unusedAddresses;\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return this._provider.getUnusedAddresses();\n\n            case 2:\n              unusedAddresses = _context8.sent;\n              return _context8.abrupt(\"return\", unusedAddresses.map(function (address) {\n                return csl.Address.from_bytes(fromHex(address)).to_bech32();\n              }));\n\n            case 4:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8, this);\n    }));\n\n    function getUnusedAddresses() {\n      return _getUnusedAddresses.apply(this, arguments);\n    }\n\n    return getUnusedAddresses;\n  }();\n\n  _proto.getChangeAddress = /*#__PURE__*/function () {\n    var _getChangeAddress = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n      var changeAddress;\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.next = 2;\n              return this._provider.getChangeAddress();\n\n            case 2:\n              changeAddress = _context9.sent;\n              return _context9.abrupt(\"return\", csl.Address.from_bytes(fromHex(changeAddress)).to_bech32());\n\n            case 4:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9, this);\n    }));\n\n    function getChangeAddress() {\n      return _getChangeAddress.apply(this, arguments);\n    }\n\n    return getChangeAddress;\n  }();\n\n  _proto.getCollateral = /*#__PURE__*/function () {\n    var _getCollateral = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.next = 2;\n              return this._provider.getCollateral();\n\n            case 2:\n              return _context10.abrupt(\"return\", _context10.sent);\n\n            case 3:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10, this);\n    }));\n\n    function getCollateral() {\n      return _getCollateral.apply(this, arguments);\n    }\n\n    return getCollateral;\n  }()\n  /**\r\n   * Returns the reward addresses owned by the wallet. This can return multiple addresses e.g. CIP-0018.\r\n   * @returns list of reward addresses\r\n   */\n  ;\n\n  _proto.getRewardAddresses =\n  /*#__PURE__*/\n  function () {\n    var _getRewardAddresses = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11() {\n      var unusedAddresses;\n      return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              _context11.next = 2;\n              return this._provider.getRewardAddresses();\n\n            case 2:\n              unusedAddresses = _context11.sent;\n              return _context11.abrupt(\"return\", unusedAddresses.map(function (address) {\n                return csl.Address.from_bytes(fromHex(address)).to_bech32();\n              }));\n\n            case 4:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11, this);\n    }));\n\n    function getRewardAddresses() {\n      return _getRewardAddresses.apply(this, arguments);\n    }\n\n    return getRewardAddresses;\n  }()\n  /**\r\n   * Requests that a user sign the unsigned portions of the supplied transaction. The wallet should ask the user for permission, and if given, try to sign the supplied body and return a signed transaction.\r\n   * @param tx - Transaction in CBOR\r\n   * @param partialSign - True if partial sign for multi-signature\r\n   * @returns signature\r\n   */\n  ;\n\n  _proto.signTx =\n  /*#__PURE__*/\n  function () {\n    var _signTx = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(_ref3) {\n      var tx, _ref3$partialSign, partialSign;\n\n      return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              tx = _ref3.tx, _ref3$partialSign = _ref3.partialSign, partialSign = _ref3$partialSign === void 0 ? false : _ref3$partialSign;\n              _context12.next = 3;\n              return this._provider.signTx(tx, partialSign);\n\n            case 3:\n              return _context12.abrupt(\"return\", _context12.sent);\n\n            case 4:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, _callee12, this);\n    }));\n\n    function signTx(_x2) {\n      return _signTx.apply(this, arguments);\n    }\n\n    return signTx;\n  }()\n  /**\r\n   * This endpoint utilizes the CIP-0008 signing spec for standardization/safety reasons. It allows the dApp to request the user to sign a payload conforming to said spec.\r\n   * @param payload - Nonce string\r\n   * @returns signature\r\n   */\n  ;\n\n  _proto.signData =\n  /*#__PURE__*/\n  function () {\n    var _signData = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(_ref4) {\n      var payload, rewardAddress, coseSign1Hex;\n      return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              payload = _ref4.payload;\n              _context13.next = 3;\n              return this.getRewardAddresses();\n\n            case 3:\n              rewardAddress = _context13.sent;\n              _context13.next = 6;\n              return this._provider.signData(rewardAddress[0], payload);\n\n            case 6:\n              coseSign1Hex = _context13.sent;\n              return _context13.abrupt(\"return\", coseSign1Hex);\n\n            case 8:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee13, this);\n    }));\n\n    function signData(_x3) {\n      return _signData.apply(this, arguments);\n    }\n\n    return signData;\n  }();\n\n  _proto.submitTx = /*#__PURE__*/function () {\n    var _submitTx = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(_ref5) {\n      var tx;\n      return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n        while (1) {\n          switch (_context14.prev = _context14.next) {\n            case 0:\n              tx = _ref5.tx;\n              _context14.next = 3;\n              return this._provider.submitTx(tx);\n\n            case 3:\n              return _context14.abrupt(\"return\", _context14.sent);\n\n            case 4:\n            case \"end\":\n              return _context14.stop();\n          }\n        }\n      }, _callee14, this);\n    }));\n\n    function submitTx(_x4) {\n      return _submitTx.apply(this, arguments);\n    }\n\n    return submitTx;\n  }()\n  /**\r\n   * These are helper functions\r\n   */\n\n  /**\r\n   * Get a list wallets installed on this browse\r\n   * @returns a list of available wallets\r\n   */\n  ;\n\n  _proto.getAvailableWallets =\n  /*#__PURE__*/\n  function () {\n    var _getAvailableWallets = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15() {\n      var availableWallets;\n      return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              availableWallets = [];\n\n              if (!(window.cardano === undefined)) {\n                _context15.next = 3;\n                break;\n              }\n\n              return _context15.abrupt(\"return\", availableWallets);\n\n            case 3:\n              if (window.cardano.ccvault) {\n                availableWallets.push('ccvault');\n              }\n\n              if (window.cardano.gerowallet) {\n                availableWallets.push('gerowallet');\n              }\n\n              if (window.cardano.nami) {\n                availableWallets.push('nami');\n              }\n\n              return _context15.abrupt(\"return\", availableWallets);\n\n            case 7:\n            case \"end\":\n              return _context15.stop();\n          }\n        }\n      }, _callee15);\n    }));\n\n    function getAvailableWallets() {\n      return _getAvailableWallets.apply(this, arguments);\n    }\n\n    return getAvailableWallets;\n  }()\n  /**\r\n   * Return the first used address\r\n   * @returns first address in string\r\n   */\n  ;\n\n  _proto.getWalletAddress =\n  /*#__PURE__*/\n  function () {\n    var _getWalletAddress = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16() {\n      return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n        while (1) {\n          switch (_context16.prev = _context16.next) {\n            case 0:\n              _context16.next = 2;\n              return this.getUsedAddresses();\n\n            case 2:\n              return _context16.abrupt(\"return\", _context16.sent[0]);\n\n            case 3:\n            case \"end\":\n              return _context16.stop();\n          }\n        }\n      }, _callee16, this);\n    }));\n\n    function getWalletAddress() {\n      return _getWalletAddress.apply(this, arguments);\n    }\n\n    return getWalletAddress;\n  }()\n  /**\r\n   * Return lovelace amount\r\n   * TODO: why get `underflow` error?\r\n   * @returns lovelance\r\n   */\n  ;\n\n  _proto.getLovelace =\n  /*#__PURE__*/\n  function () {\n    var _getLovelace = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee17() {\n      var lovelace, utxos, inputs;\n      return _regeneratorRuntime().wrap(function _callee17$(_context17) {\n        while (1) {\n          switch (_context17.prev = _context17.next) {\n            case 0:\n              lovelace = 0;\n              _context17.next = 3;\n              return this.getUtxos();\n\n            case 3:\n              utxos = _context17.sent;\n\n              if (utxos !== undefined) {\n                // // v1\n                // const parsedUtxos = utxos.map((utxo) =>\n                //   csl.TransactionUnspentOutput.from_bytes(fromHex(utxo.cbor))\n                // );\n                // let countedValue = csl.Value.new(\n                //   csl.BigNum.from_str('0')\n                // );\n                // parsedUtxos.forEach(\n                //   (element: {\n                //     output: () => {\n                //       (): any;\n                //       new (): any;\n                //       amount: { (): Value; new (): any };\n                //     };\n                //   }) => {\n                //     countedValue = countedValue.checked_add(element.output().amount());\n                //   }\n                // );\n                // const minAda = csl.min_ada_required(\n                //   countedValue,\n                //   false,\n                //   csl.BigNum.from_str(MIN_ADA_REQUIRED.toString())\n                // );\n                // const availableAda = countedValue.coin().checked_sub(minAda);\n                // const lovelace = parseInt(availableAda.to_str());\n                // return lovelace;\n                // // v2\n                inputs = utxos.map(function (utxo) {\n                  return csl.TransactionUnspentOutput.from_bytes(Buffer.from(utxo.cbor, 'hex'));\n                });\n                inputs.forEach(function (nn) {\n                  valueToAssets(nn.output().amount()).forEach(function (nnn) {\n                    if (nnn.unit === 'lovelace') {\n                      lovelace += parseInt(nnn.quantity, 10);\n                    }\n                  });\n                });\n              }\n\n              return _context17.abrupt(\"return\", lovelace);\n\n            case 6:\n            case \"end\":\n              return _context17.stop();\n          }\n        }\n      }, _callee17, this);\n    }));\n\n    function getLovelace() {\n      return _getLovelace.apply(this, arguments);\n    }\n\n    return getLovelace;\n  }()\n  /**\r\n   * Get a list of assets in connected wallet\r\n   * Note: includeOnchain requires `Mesh.blockfrost.init`\r\n   * @param policyId (optional) if provided will filter only assets in this policy\r\n   * @param includeOnchain (optional) if provided will get on-chain metadata\r\n   * @param limit (optional) if provided will limit the number of (random) assets returned\r\n   * @returns assets - List of asset\r\n   */\n  ;\n\n  _proto.getAssets =\n  /*#__PURE__*/\n  function () {\n    var _getAssets = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee19(options) {\n      var _this = this;\n\n      var valueCBOR, value, assets, _value$multiasset, multiAssets, j, _value$multiasset2, policy, policyAssets, assetNames, k, policyAsset, quantity, asset, _policy, _name, filteredAssets;\n\n      return _regeneratorRuntime().wrap(function _callee19$(_context19) {\n        while (1) {\n          switch (_context19.prev = _context19.next) {\n            case 0:\n              _context19.next = 2;\n              return this.getBalance();\n\n            case 2:\n              valueCBOR = _context19.sent;\n              value = csl.Value.from_bytes(fromHex(valueCBOR));\n              assets = [];\n\n              if (value.multiasset()) {\n                multiAssets = (_value$multiasset = value.multiasset()) == null ? void 0 : _value$multiasset.keys();\n\n                if (multiAssets) {\n                  for (j = 0; j < multiAssets.len(); j++) {\n                    policy = multiAssets.get(j);\n                    policyAssets = (_value$multiasset2 = value.multiasset()) == null ? void 0 : _value$multiasset2.get(policy);\n                    assetNames = policyAssets == null ? void 0 : policyAssets.keys();\n\n                    if (policyAssets && assetNames) {\n                      for (k = 0; k < assetNames.len(); k++) {\n                        policyAsset = assetNames.get(k);\n                        quantity = policyAssets.get(policyAsset);\n                        asset = toHex(policy.to_bytes()) + toHex(policyAsset.name());\n                        _policy = asset.slice(0, 56);\n                        _name = asset.slice(56);\n                        assets.push({\n                          unit: asset,\n                          quantity: parseInt(quantity.to_str()),\n                          policy: _policy,\n                          name: HexToAscii(_name)\n                        });\n                      }\n                    }\n                  }\n                }\n              } // if `policyId` is provided, return assets in this policy ID\n\n\n              if (options != null && options.policyId && options.policyId && (options == null ? void 0 : options.policyId.length) > 0) {\n                filteredAssets = assets.filter(function (el) {\n                  return el.unit.includes(options.policyId);\n                }).map(function (item) {\n                  return item;\n                });\n                assets = [].concat(filteredAssets);\n              } // if `limit` provided, pick the first `limit` number of assets\n\n\n              if (options != null && options.limit && options.limit > 0) {\n                assets = assets.slice(0, options.limit);\n              } // if blockfrost is loaded and `includeOnchain`, pull on-chain info\n\n\n              if (!(this._blockfrost.isLoaded() && options != null && options.includeOnchain)) {\n                _context19.next = 11;\n                break;\n              }\n\n              _context19.next = 11;\n              return Promise.all(assets.map( /*#__PURE__*/function () {\n                var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee18(asset) {\n                  return _regeneratorRuntime().wrap(function _callee18$(_context18) {\n                    while (1) {\n                      switch (_context18.prev = _context18.next) {\n                        case 0:\n                          _context18.next = 2;\n                          return _this._blockfrost.assetSpecificAsset({\n                            asset: asset.unit\n                          });\n\n                        case 2:\n                          asset.onchain = _context18.sent;\n                          asset.image = asset.onchain.onchain_metadata && asset.onchain.onchain_metadata.image && linkToSrc(convertMetadataPropToString(asset.onchain.onchain_metadata.image)) || '';\n\n                        case 4:\n                        case \"end\":\n                          return _context18.stop();\n                      }\n                    }\n                  }, _callee18);\n                }));\n\n                return function (_x6) {\n                  return _ref6.apply(this, arguments);\n                };\n              }()));\n\n            case 11:\n              return _context19.abrupt(\"return\", assets);\n\n            case 12:\n            case \"end\":\n              return _context19.stop();\n          }\n        }\n      }, _callee19, this);\n    }));\n\n    function getAssets(_x5) {\n      return _getAssets.apply(this, arguments);\n    }\n\n    return getAssets;\n  }();\n\n  _proto.submitTransaction = /*#__PURE__*/function () {\n    var _submitTransaction = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee20(_ref7) {\n      var tx, witnesses, _ref7$metadata, metadata, transaction, txWitnesses, txVkeys, txScripts, totalVkeys, totalScripts, _iterator, _step, witness, addWitnesses, addVkeys, _i2, i, _i, totalWitnesses, aux, generalMetadata, signedTx, txHash;\n\n      return _regeneratorRuntime().wrap(function _callee20$(_context20) {\n        while (1) {\n          switch (_context20.prev = _context20.next) {\n            case 0:\n              tx = _ref7.tx, witnesses = _ref7.witnesses, _ref7$metadata = _ref7.metadata, metadata = _ref7$metadata === void 0 ? undefined : _ref7$metadata;\n              transaction = csl.Transaction.from_bytes(Buffer.from(tx, 'hex'));\n              txWitnesses = transaction.witness_set();\n              txVkeys = txWitnesses.vkeys();\n              txScripts = txWitnesses.native_scripts();\n              totalVkeys = csl.Vkeywitnesses[\"new\"]();\n              totalScripts = csl.NativeScripts[\"new\"]();\n\n              for (_iterator = _createForOfIteratorHelperLoose(witnesses); !(_step = _iterator()).done;) {\n                witness = _step.value;\n                addWitnesses = csl.TransactionWitnessSet.from_bytes(Buffer.from(witness, 'hex'));\n                addVkeys = addWitnesses.vkeys();\n\n                if (addVkeys) {\n                  for (_i2 = 0; _i2 < addVkeys.len(); _i2++) {\n                    totalVkeys.add(addVkeys.get(_i2));\n                  }\n                }\n              }\n\n              if (txVkeys) {\n                for (i = 0; i < txVkeys.len(); i++) {\n                  totalVkeys.add(txVkeys.get(i));\n                }\n              }\n\n              if (txScripts) {\n                for (_i = 0; _i < txScripts.len(); _i++) {\n                  totalScripts.add(txScripts.get(_i));\n                }\n              }\n\n              totalWitnesses = csl.TransactionWitnessSet[\"new\"]();\n              totalWitnesses.set_vkeys(totalVkeys);\n              totalWitnesses.set_native_scripts(totalScripts);\n\n              if (metadata) {\n                aux = csl.AuxiliaryData[\"new\"]();\n                generalMetadata = csl.GeneralTransactionMetadata[\"new\"]();\n                Object.entries(metadata).map(function (_ref8) {\n                  var MetadataLabel = _ref8[0],\n                      Metadata = _ref8[1];\n                  generalMetadata.insert(csl.BigNum.from_str(MetadataLabel), csl.encode_json_str_to_metadatum(JSON.stringify(Metadata), 0));\n                });\n                aux.set_metadata(generalMetadata);\n              } else {\n                aux = transaction.auxiliary_data();\n              }\n\n              _context20.prev = 14;\n              _context20.next = 17;\n              return csl.Transaction[\"new\"](transaction.body(), totalWitnesses, aux);\n\n            case 17:\n              signedTx = _context20.sent;\n              _context20.next = 20;\n              return this.submitTx({\n                tx: toHex(signedTx.to_bytes())\n              });\n\n            case 20:\n              txHash = _context20.sent;\n              return _context20.abrupt(\"return\", txHash);\n\n            case 24:\n              _context20.prev = 24;\n              _context20.t0 = _context20[\"catch\"](14);\n              throw _context20.t0;\n\n            case 27:\n            case \"end\":\n              return _context20.stop();\n          }\n        }\n      }, _callee20, this, [[14, 24]]);\n    }));\n\n    function submitTransaction(_x7) {\n      return _submitTransaction.apply(this, arguments);\n    }\n\n    return submitTransaction;\n  }();\n\n  return Wallet;\n}();\n\nvar Transaction = /*#__PURE__*/function () {\n  function Transaction(_ref) {\n    var wallet = _ref.wallet;\n\n    this._createTxOutput = function (_ref2) {\n      var address = _ref2.address,\n          value = _ref2.value,\n          datum = _ref2.datum;\n      var output;\n\n      if (datum) {\n        output = csl.TransactionOutputBuilder[\"new\"]().with_address(address).with_plutus_data(datum).with_data_hash(csl.hash_plutus_data(datum)).next().with_value(value).build();\n      } else {\n        output = csl.TransactionOutputBuilder[\"new\"]().with_address(address).next().with_value(value).build();\n      }\n\n      return output;\n    };\n\n    this.createTxUnspentOutput = function (address, utxo) {\n      var amount = {};\n\n      for (var i = 0; i < utxo.amount.length; i++) {\n        var thisAsset = utxo.amount[i];\n        amount[thisAsset.unit] = thisAsset.quantity;\n      }\n\n      try {\n        return csl.TransactionUnspentOutput[\"new\"](csl.TransactionInput[\"new\"](csl.TransactionHash.from_bytes(fromHex(utxo.tx_hash)), utxo.output_index), csl.TransactionOutput[\"new\"](address, assetsToValue(amount)));\n      } catch (error) {\n        console.error(\"Unexpected error in createTxUnspentOutput. [Message: \" + error + \"]\");\n        throw error;\n      }\n    };\n\n    this.wallet = wallet;\n    this._blockfrost = new Blockfrost();\n  }\n\n  var _proto = Transaction.prototype;\n\n  _proto._getTxBuilderConfig = /*#__PURE__*/function () {\n    var _getTxBuilderConfig2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var _fromFloat, price_mem_numerator, price_mem_denominator, _fromFloat2, price_step_numerator, price_step_denominator, txBuilderConfig;\n\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return this._blockfrost.epochsLatestEpochProtocolParameters();\n\n            case 2:\n              this.protocolParameters = _context.sent;\n              _fromFloat = fromFloat(this.protocolParameters.price_mem.toString()), price_mem_numerator = _fromFloat.numerator, price_mem_denominator = _fromFloat.denominator;\n              _fromFloat2 = fromFloat(this.protocolParameters.price_step.toString()), price_step_numerator = _fromFloat2.numerator, price_step_denominator = _fromFloat2.denominator;\n              txBuilderConfig = csl.TransactionBuilderConfigBuilder[\"new\"]().coins_per_utxo_byte(csl.BigNum.from_str(this.protocolParameters.coins_per_utxo_word)).fee_algo(csl.LinearFee[\"new\"](csl.BigNum.from_str(this.protocolParameters.min_fee_a.toString()), csl.BigNum.from_str(this.protocolParameters.min_fee_b.toString()))).key_deposit(csl.BigNum.from_str(this.protocolParameters.key_deposit)).pool_deposit(csl.BigNum.from_str(this.protocolParameters.pool_deposit)).max_tx_size(this.protocolParameters.max_tx_size).max_value_size(parseInt(this.protocolParameters.max_val_size)).ex_unit_prices(csl.ExUnitPrices[\"new\"](csl.UnitInterval[\"new\"](csl.BigNum.from_str(price_mem_numerator), csl.BigNum.from_str(price_mem_denominator)), csl.UnitInterval[\"new\"](csl.BigNum.from_str(price_step_numerator), csl.BigNum.from_str(price_step_denominator)))).build();\n              return _context.abrupt(\"return\", txBuilderConfig);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function _getTxBuilderConfig() {\n      return _getTxBuilderConfig2.apply(this, arguments);\n    }\n\n    return _getTxBuilderConfig;\n  }();\n\n  _proto._buildTransaction = /*#__PURE__*/function () {\n    var _buildTransaction2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref3) {\n      var txBuilder, txBody, witnesses, transaction, transactionBytes, transactionHex;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              txBuilder = _ref3.txBuilder;\n              txBody = txBuilder.build();\n              witnesses = csl.TransactionWitnessSet[\"new\"]();\n              transaction = csl.Transaction[\"new\"](txBody, witnesses);\n              transactionBytes = transaction.to_bytes();\n              transactionHex = toHex(transactionBytes);\n              return _context2.abrupt(\"return\", transactionHex);\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    function _buildTransaction(_x) {\n      return _buildTransaction2.apply(this, arguments);\n    }\n\n    return _buildTransaction;\n  }();\n\n  _proto._addChange = /*#__PURE__*/function () {\n    var _addChange2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref4) {\n      var txBuilder, changeAddress;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              txBuilder = _ref4.txBuilder, changeAddress = _ref4.changeAddress;\n\n              if (!(changeAddress == undefined)) {\n                _context3.next = 5;\n                break;\n              }\n\n              _context3.next = 4;\n              return this.wallet.getWalletAddress();\n\n            case 4:\n              changeAddress = _context3.sent;\n\n            case 5:\n              txBuilder.add_change_if_needed(StringToAddress(changeAddress));\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    function _addChange(_x2) {\n      return _addChange2.apply(this, arguments);\n    }\n\n    return _addChange;\n  }();\n\n  _proto._addMetadata = /*#__PURE__*/function () {\n    var _addMetadata2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_ref5) {\n      var txBuilder, metadata, auxData, generalMetadata;\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              txBuilder = _ref5.txBuilder, metadata = _ref5.metadata;\n              auxData = csl.AuxiliaryData[\"new\"]();\n              generalMetadata = csl.GeneralTransactionMetadata[\"new\"]();\n              generalMetadata.insert(csl.BigNum.from_str('100'), csl.encode_json_str_to_metadatum(JSON.stringify(metadata), 1));\n              auxData.set_metadata(generalMetadata);\n              txBuilder.set_auxiliary_data(auxData);\n\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    function _addMetadata(_x3) {\n      return _addMetadata2.apply(this, arguments);\n    }\n\n    return _addMetadata;\n  }() // helper function to sort the 2nd item in array\n  ;\n\n  _proto._sortDescendingArray = function _sortDescendingArray(array) {\n    array.sort(function (i, j) {\n      return j[1] - i[1];\n    });\n  };\n\n  _proto._selectUtxosForLovelace = function _selectUtxosForLovelace(_ref6) {\n    var utxosContainLovelaceArray = _ref6.utxosContainLovelaceArray,\n        remainingLovelace = _ref6.remainingLovelace;\n    var chosenUtxoCborStringList = [];\n\n    this._sortDescendingArray(utxosContainLovelaceArray);\n\n    for (var _iterator = _createForOfIteratorHelperLoose(utxosContainLovelaceArray), _step; !(_step = _iterator()).done;) {\n      var u = _step.value;\n      var cbor = u[0];\n      var amountLovelace = u[1];\n      chosenUtxoCborStringList.push(cbor);\n      remainingLovelace -= amountLovelace;\n\n      if (remainingLovelace < 0) {\n        break;\n      }\n    }\n\n    return {\n      chosenUtxoCborStringList: chosenUtxoCborStringList,\n      remainingLovelace: remainingLovelace\n    };\n  }\n  /**\r\n   * todos:\r\n   * get enough lovelace for fees, instead of hardcoded\r\n   * get enough lovelace for attached assets, instead of hardcoded\r\n   * improve: lets try to find the largest lovelace/asset utxo just enough to fulfill tx, instead of picking the largest\r\n   */\n  ;\n\n  _proto.selectUtxoInputs =\n  /*#__PURE__*/\n  function () {\n    var _selectUtxoInputs = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(_ref7) {\n      var _this = this;\n\n      var outputs, _debug, chosenUtxoCborStringList, remainingLovelace, remainingAssets, utxoDictByCborKeys, utxos, _iterator2, _step2, output, _assetId2, _iterator3, _step3, utxo, _loop, assetId, _assetId, utxosContainLovelace, selectedLovelaceUtxos, _utxosContainLovelace;\n\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              outputs = _ref7.outputs;\n              _debug = false;\n              chosenUtxoCborStringList = []; // to return and to stop repeated utxo selected\n\n              remainingLovelace = 0; // to track lovelace\n\n              remainingAssets = {}; // to track assets\n\n              utxoDictByCborKeys = {}; // for quick look up\n\n              /**\r\n               * 1. prepare\r\n               */\n\n              _context5.next = 8;\n              return this.wallet.getUtxos();\n\n            case 8:\n              utxos = _context5.sent;\n\n              for (_iterator2 = _createForOfIteratorHelperLoose(outputs); !(_step2 = _iterator2()).done;) {\n                output = _step2.value;\n\n                for (_assetId2 in output.assets) {\n                  if (_assetId2 === 'lovelace') {\n                    remainingLovelace += output.assets[_assetId2];\n                  } else {\n                    if (!(_assetId2 in remainingAssets)) {\n                      remainingAssets[_assetId2] = 0;\n                    }\n\n                    remainingAssets[_assetId2] += output.assets[_assetId2];\n                    remainingLovelace += toLovelace(2); // todo: attached ADA for assets is hardcoded\n                  }\n                }\n              }\n\n              for (_iterator3 = _createForOfIteratorHelperLoose(utxos); !(_step3 = _iterator3()).done;) {\n                utxo = _step3.value;\n                utxoDictByCborKeys[utxo.cbor] = utxo;\n              }\n\n              remainingLovelace += toLovelace(1); // todo: hardcoded for fees\n\n              if (_debug) {\n                console.log('utxos', utxos);\n                console.log('assets requirements', remainingLovelace, remainingAssets);\n              }\n              /**\r\n               * 2. add assets UTXOs\r\n               */\n              // 2a. for each assets in remainingAssets, lets look for their utxos\n\n\n              _loop = function _loop(assetId) {\n                if (remainingAssets[assetId] > 0) {\n                  var utxosContainAsset = utxos.filter(function (utxo) {\n                    return !chosenUtxoCborStringList.includes(utxo.cbor) && assetId in utxo.assets;\n                  }).map(function (utxo) {\n                    return [utxo.cbor, utxo.assets[assetId], utxo];\n                  });\n\n                  _this._sortDescendingArray(utxosContainAsset);\n\n                  for (var _iterator4 = _createForOfIteratorHelperLoose(utxosContainAsset), _step4; !(_step4 = _iterator4()).done;) {\n                    var u = _step4.value;\n                    var cbor = u[0];\n                    var quantity = u[1];\n                    var _utxo = u[2];\n                    remainingAssets[assetId] -= quantity;\n                    chosenUtxoCborStringList.push(cbor);\n                    remainingLovelace -= _utxo.assets.lovelace;\n\n                    if (remainingAssets[assetId] <= 0) {\n                      break;\n                    }\n                  }\n                }\n              };\n\n              for (assetId in remainingAssets) {\n                _loop(assetId);\n              }\n\n              if (_debug) {\n                console.log('-------');\n                console.log('after assets selection', utxos.filter(function (utxo) {\n                  return chosenUtxoCborStringList.includes(utxo.cbor);\n                }));\n                console.log('assets remaining', remainingLovelace, remainingAssets);\n              } // 2b. if not enough to fulfill remainingAssets, throw error\n\n\n              _context5.t0 = _regeneratorRuntime().keys(remainingAssets);\n\n            case 17:\n              if ((_context5.t1 = _context5.t0()).done) {\n                _context5.next = 23;\n                break;\n              }\n\n              _assetId = _context5.t1.value;\n\n              if (!(remainingAssets[_assetId] > 0)) {\n                _context5.next = 21;\n                break;\n              }\n\n              throw MakeTxError.NotEnoughAssetsInput;\n\n            case 21:\n              _context5.next = 17;\n              break;\n\n            case 23:\n              if (!(remainingLovelace > 0)) {\n                _context5.next = 32;\n                break;\n              }\n\n              // 3a. lets try to find utxos that has only lovelace\n              utxosContainLovelace = utxos.filter(function (utxo) {\n                return !chosenUtxoCborStringList.includes(utxo.cbor) && Object.keys(utxo.assets).length === 1;\n              }).map(function (utxo) {\n                return [utxo.cbor, utxo.assets.lovelace];\n              });\n              selectedLovelaceUtxos = this._selectUtxosForLovelace({\n                utxosContainLovelaceArray: utxosContainLovelace,\n                remainingLovelace: remainingLovelace\n              });\n\n              if (_debug) {\n                console.log('-------');\n                console.log('after lovelace selection step 1', utxos.filter(function (utxo) {\n                  return selectedLovelaceUtxos.chosenUtxoCborStringList.includes(utxo.cbor);\n                }));\n                console.log('assets remaining', selectedLovelaceUtxos.remainingLovelace);\n              } // 3b. if cant find any or cant find enough lovelace, lets include utxos that also has assets\n\n\n              if (selectedLovelaceUtxos.remainingLovelace > 0) {\n                _utxosContainLovelace = utxos.filter(function (utxo) {\n                  return !chosenUtxoCborStringList.includes(utxo.cbor);\n                }).map(function (utxo) {\n                  return [utxo.cbor, utxo.assets.lovelace];\n                });\n                selectedLovelaceUtxos = this._selectUtxosForLovelace({\n                  utxosContainLovelaceArray: _utxosContainLovelace,\n                  remainingLovelace: remainingLovelace\n                });\n\n                if (_debug) {\n                  console.log('-------');\n                  console.log('after lovelace selection step 2', utxos.filter(function (utxo) {\n                    return selectedLovelaceUtxos.chosenUtxoCborStringList.includes(utxo.cbor);\n                  }));\n                  console.log('assets remaining', selectedLovelaceUtxos.remainingLovelace);\n                }\n              } // 3c. if still not enough lovelace to fulfill tx, throw error\n\n\n              if (!(selectedLovelaceUtxos.remainingLovelace > 0)) {\n                _context5.next = 30;\n                break;\n              }\n\n              throw MakeTxError.NotEnoughLovelaceInput;\n\n            case 30:\n              // 3d. if all is well with lovelace\n              chosenUtxoCborStringList.push.apply(chosenUtxoCborStringList, selectedLovelaceUtxos.chosenUtxoCborStringList);\n              remainingLovelace = selectedLovelaceUtxos.remainingLovelace;\n\n            case 32:\n              if (_debug) {\n                console.log('-------');\n                console.log('final utxos selection', utxos.filter(function (utxo) {\n                  return chosenUtxoCborStringList.includes(utxo.cbor);\n                }));\n                console.log('assets remaining', remainingLovelace, remainingAssets);\n              }\n\n              return _context5.abrupt(\"return\", chosenUtxoCborStringList);\n\n            case 34:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    function selectUtxoInputs(_x4) {\n      return _selectUtxoInputs.apply(this, arguments);\n    }\n\n    return selectUtxoInputs;\n  }();\n\n  _proto._addInputUtxo = /*#__PURE__*/function () {\n    var _addInputUtxo2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(_ref8) {\n      var inputs, outputs, txInputsBuilder, utxos;\n      return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              inputs = _ref8.inputs, outputs = _ref8.outputs;\n\n              if (!(inputs.length === 0)) {\n                _context6.next = 5;\n                break;\n              }\n\n              _context6.next = 4;\n              return this.selectUtxoInputs({\n                outputs: outputs\n              });\n\n            case 4:\n              inputs = _context6.sent;\n\n            case 5:\n              // end Version 3\n\n              /**\r\n               * from the inputs, create TxInputsBuilder\r\n               */\n              txInputsBuilder = csl.TxInputsBuilder[\"new\"]();\n              utxos = inputs.map(function (utxo) {\n                return csl.TransactionUnspentOutput.from_bytes(Buffer.from(utxo, 'hex'));\n              });\n              utxos.forEach(function (utxo) {\n                txInputsBuilder.add_input(utxo.output().address(), utxo.input(), utxo.output().amount());\n              });\n              return _context6.abrupt(\"return\", txInputsBuilder);\n\n            case 9:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6, this);\n    }));\n\n    function _addInputUtxo(_x5) {\n      return _addInputUtxo2.apply(this, arguments);\n    }\n\n    return _addInputUtxo;\n  }();\n\n  _proto._addPlutus = function _addPlutus(_ref9) {\n    _objectDestructuringEmpty(_ref9);\n  };\n\n  _proto._makeMultiAsset = function _makeMultiAsset(assets) {\n    var AssetsMap = {};\n\n    for (var _iterator5 = _createForOfIteratorHelperLoose(assets), _step5; !(_step5 = _iterator5()).done;) {\n      var _asset = _step5.value;\n      var unit = _asset.unit,\n          quantity = _asset.quantity;\n\n      var _unit$split = unit.split('.'),\n          _policy = _unit$split[0],\n          assetName = _unit$split[1];\n\n      if (!Array.isArray(AssetsMap[_policy])) {\n        AssetsMap[_policy] = [];\n      }\n\n      AssetsMap[_policy].push({\n        unit: Buffer.from(assetName, 'ascii').toString('hex'),\n        quantity: quantity\n      });\n    }\n\n    var multiAsset = csl.MultiAsset[\"new\"]();\n\n    for (var policy in AssetsMap) {\n      var ScriptHash = csl.ScriptHash.from_bytes(Buffer.from(policy, 'hex'));\n      var Assets = csl.Assets[\"new\"]();\n      var _assets = AssetsMap[policy];\n\n      for (var _iterator6 = _createForOfIteratorHelperLoose(_assets), _step6; !(_step6 = _iterator6()).done;) {\n        var asset = _step6.value;\n        var AssetName = csl.AssetName[\"new\"](Buffer.from(asset.unit, 'hex'));\n        var BigNum = csl.BigNum.from_str(asset.quantity.toString());\n        Assets.insert(AssetName, BigNum);\n      }\n\n      multiAsset.insert(ScriptHash, Assets);\n    }\n\n    return multiAsset;\n  };\n\n  _proto._addOutputs = /*#__PURE__*/function () {\n    var _addOutputs2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(_ref10) {\n      var _this2 = this;\n\n      var txBuilder, outputs, ownerAddressBech32, datumAssetsList, txOutputs, i;\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              txBuilder = _ref10.txBuilder, outputs = _ref10.outputs, ownerAddressBech32 = _ref10.ownerAddressBech32, datumAssetsList = _ref10.datumAssetsList;\n              txOutputs = csl.TransactionOutputs[\"new\"]();\n              outputs.map(function (output) {\n                if (output.address === undefined || output.address.length === 0) {\n                  throw MakeTxError.NoRecipientsAddress;\n                } // add lovelace\n\n\n                var amountLovelace = output.assets.lovelace && output.assets.lovelace > MIN_ADA_REQUIRED_WITH_ASSETS ? output.assets.lovelace : MIN_ADA_REQUIRED_WITH_ASSETS; // TODO, cannot hardcode 2ADA. if too many assets, 2 ADA is not enough\n\n                var outputValue = csl.Value[\"new\"](csl.BigNum.from_str(amountLovelace.toString())); // if have native tokens\n\n                if (Object.keys(output.assets)) {\n                  var assets = [];\n                  Object.keys(output.assets).map( /*#__PURE__*/function () {\n                    var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(assetId) {\n                      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n                        while (1) {\n                          switch (_context7.prev = _context7.next) {\n                            case 0:\n                              if (assetId !== 'lovelace') {\n                                assets.push({\n                                  unit: assetId,\n                                  quantity: output.assets[assetId]\n                                });\n                              }\n\n                            case 1:\n                            case \"end\":\n                              return _context7.stop();\n                          }\n                        }\n                      }, _callee7);\n                    }));\n\n                    return function (_x7) {\n                      return _ref11.apply(this, arguments);\n                    };\n                  }());\n\n                  var multiAsset = _this2._makeMultiAsset(assets);\n\n                  outputValue.set_multiasset(multiAsset);\n                } // let datumHash: string | null = null;\n\n\n                var datum = null;\n\n                if (datumAssetsList) {\n                  datum = _this2.createDatum({\n                    ownerAddressBech32: ownerAddressBech32,\n                    assets: datumAssetsList\n                  }); // datumHash = plutusDataToHex(datum);\n                }\n\n                var thisOutput = _this2._createTxOutput({\n                  address: StringToAddress(output.address),\n                  value: outputValue,\n                  datum: datum\n                });\n\n                txOutputs.add( // csl.TransactionOutput.new(StringToAddress(output.address), outputValue)\n                thisOutput);\n              });\n\n              for (i = 0; i < txOutputs.len(); i++) {\n                txBuilder.add_output(txOutputs.get(i));\n              }\n\n            case 4:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    function _addOutputs(_x6) {\n      return _addOutputs2.apply(this, arguments);\n    }\n\n    return _addOutputs;\n  }();\n\n  _proto.build = /*#__PURE__*/function () {\n    var _build = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(_ref12) {\n      var _ref12$inputs, inputs, outputs, ttl, changeAddress, metadata, plutusScripts, _ref12$hasDatum, hasDatum, blockfrostApiKey, network, txBuilder, txInputsBuilder, datumAssetsList, _iterator7, _step7, output, transactionHex;\n\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              _ref12$inputs = _ref12.inputs, inputs = _ref12$inputs === void 0 ? [] : _ref12$inputs, outputs = _ref12.outputs, ttl = _ref12.ttl, changeAddress = _ref12.changeAddress, metadata = _ref12.metadata, plutusScripts = _ref12.plutusScripts, _ref12$hasDatum = _ref12.hasDatum, hasDatum = _ref12$hasDatum === void 0 ? false : _ref12$hasDatum, blockfrostApiKey = _ref12.blockfrostApiKey, network = _ref12.network;\n              // start: init\n              this._blockfrost = new Blockfrost();\n              _context9.next = 4;\n              return this._blockfrost.init({\n                blockfrostApiKey: blockfrostApiKey,\n                network: network\n              });\n\n            case 4:\n              _context9.t0 = csl.TransactionBuilder;\n              _context9.next = 7;\n              return this._getTxBuilderConfig();\n\n            case 7:\n              _context9.t1 = _context9.sent;\n              txBuilder = _context9.t0[\"new\"].call(_context9.t0, _context9.t1);\n\n              // end: init\n              if (ttl) {\n                txBuilder.set_ttl(ttl);\n              } // add inputs\n\n\n              _context9.next = 12;\n              return this._addInputUtxo({\n                inputs: inputs,\n                outputs: outputs\n              });\n\n            case 12:\n              txInputsBuilder = _context9.sent;\n              // if datum\n              datumAssetsList = null;\n\n              if (hasDatum) {\n                datumAssetsList = [];\n\n                for (_iterator7 = _createForOfIteratorHelperLoose(outputs); !(_step7 = _iterator7()).done;) {\n                  output = _step7.value;\n                  datumAssetsList = [].concat(Object.keys(output.assets));\n                  datumAssetsList = datumAssetsList.filter(function (el) {\n                    return el != 'lovelace';\n                  });\n                }\n\n                console.log('datumAssetsList', datumAssetsList); // [\"ds8dh9s8dhs.Pixel\"]\n              } // add outputs\n\n\n              _context9.t2 = this;\n              _context9.t3 = txBuilder;\n              _context9.t4 = outputs;\n              _context9.next = 20;\n              return this.wallet.getWalletAddress();\n\n            case 20:\n              _context9.t5 = _context9.sent;\n              _context9.t6 = datumAssetsList;\n              _context9.t7 = {\n                txBuilder: _context9.t3,\n                outputs: _context9.t4,\n                ownerAddressBech32: _context9.t5,\n                datumAssetsList: _context9.t6\n              };\n              _context9.next = 25;\n              return _context9.t2._addOutputs.call(_context9.t2, _context9.t7);\n\n            case 25:\n\n\n              if (!metadata) {\n                _context9.next = 29;\n                break;\n              }\n\n              _context9.next = 29;\n              return this._addMetadata({\n                txBuilder: txBuilder,\n                metadata: metadata\n              });\n\n            case 29:\n              if (!plutusScripts) {\n                _context9.next = 32;\n                break;\n              }\n\n              _context9.next = 32;\n              return this._addPlutus({});\n\n            case 32:\n              txBuilder.set_inputs(txInputsBuilder); // add change\n\n              _context9.next = 35;\n              return this._addChange({\n                txBuilder: txBuilder,\n                changeAddress: changeAddress\n              });\n\n            case 35:\n              _context9.next = 37;\n              return this._buildTransaction({\n                txBuilder: txBuilder\n              });\n\n            case 37:\n              transactionHex = _context9.sent;\n              return _context9.abrupt(\"return\", transactionHex);\n\n            case 39:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9, this);\n    }));\n\n    function build(_x8) {\n      return _build.apply(this, arguments);\n    }\n\n    return build;\n  }()\n  /**\r\n   * for smart contract\r\n   * this is for devt only, will need to refactor everything eventually\r\n   */\n  ;\n\n  _proto.finalizeTx =\n  /*#__PURE__*/\n  function () {\n    var _finalizeTx = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(_ref13) {\n      var txBuilder, changeAddress;\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              txBuilder = _ref13.txBuilder, changeAddress = _ref13.changeAddress;\n              console.log(txBuilder, changeAddress);\n\n            case 2:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10);\n    }));\n\n    function finalizeTx(_x9) {\n      return _finalizeTx.apply(this, arguments);\n    }\n\n    return finalizeTx;\n  }();\n\n  _proto.createDatum = function createDatum(_ref14) {\n    var ownerAddressBech32 = _ref14.ownerAddressBech32,\n        assets = _ref14.assets;\n    var fields = csl.PlutusList[\"new\"]();\n\n    for (var _iterator8 = _createForOfIteratorHelperLoose(assets), _step8; !(_step8 = _iterator8()).done;) {\n      var asset = _step8.value;\n      var assetDetails = csl.PlutusList[\"new\"]();\n\n      var _asset$split = asset.split('.'),\n          policy = _asset$split[0],\n          assetName = _asset$split[1];\n\n      assetDetails.add(csl.PlutusData.new_bytes(fromHex(policy)));\n      assetDetails.add(csl.PlutusData.new_bytes(fromHex(toHex(assetName))));\n      fields.add(csl.PlutusData.new_constr_plutus_data(csl.ConstrPlutusData[\"new\"](csl.BigNum.from_str('0'), assetDetails)));\n    }\n\n    var owner = getAddressKeyHashHex(ownerAddressBech32);\n\n    if (owner) {\n      fields.add(csl.PlutusData.new_bytes(fromHex(owner)));\n    }\n\n    var datum = csl.PlutusData.new_constr_plutus_data(csl.ConstrPlutusData[\"new\"](csl.BigNum.from_str('0'), fields));\n    return datum;\n  };\n\n  _proto._addInputUtxoSC = /*#__PURE__*/function () {\n    var _addInputUtxoSC2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(_ref15) {\n      var _this3 = this;\n\n      var scriptAddress, asset, utxosFromBF, utxos, txInputsBuilder;\n      return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              scriptAddress = _ref15.scriptAddress, asset = _ref15.asset;\n              _context11.next = 3;\n              return this._blockfrost.addressesAddressUtxosAsset({\n                address: scriptAddress,\n                asset: asset\n              });\n\n            case 3:\n              utxosFromBF = _context11.sent;\n              console.log('utxosFromBF', utxosFromBF);\n              utxos = utxosFromBF.filter(function (utxo) {\n                return utxo.data_hash !== null;\n              }).map(function (utxoBF) {\n                var txoutput = _this3.createTxUnspentOutput(StringToAddress(scriptAddress), utxoBF);\n\n                return txoutput;\n              });\n              txInputsBuilder = csl.TxInputsBuilder[\"new\"](); // utxos.forEach((utxo: any) => {\n              //   txInputsBuilder.add_input(\n              //     utxo.output().address(),\n              //     utxo.input(),\n              //     utxo.output().amount()\n              //   );\n              // });\n\n              txInputsBuilder.add_input(utxos[0].output().address(), utxos[0].input(), utxos[0].output().amount());\n              return _context11.abrupt(\"return\", {\n                txInputsBuilder: txInputsBuilder,\n                utxoselected: utxos[0]\n              });\n\n            case 9:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11, this);\n    }));\n\n    function _addInputUtxoSC(_x10) {\n      return _addInputUtxoSC2.apply(this, arguments);\n    }\n\n    return _addInputUtxoSC;\n  }() // this is for devt only, will need to refactor everything eventually\n  ;\n\n  _proto.buildSC =\n  /*#__PURE__*/\n  function () {\n    var _buildSC = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(_ref16) {\n      var ownerAddress, scriptAddress, assets, blockfrostApiKey, network, txBuilder, datum, datumHash, outputs, asset, _asset$split2, policy, assetName, _yield$this$_addInput, txInputsBuilder, utxoselected, scriptWitness, transactionHex;\n\n      return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              ownerAddress = _ref16.ownerAddress, scriptAddress = _ref16.scriptAddress, assets = _ref16.assets, blockfrostApiKey = _ref16.blockfrostApiKey, network = _ref16.network;\n              // start: init\n              this._blockfrost = new Blockfrost();\n              _context12.next = 4;\n              return this._blockfrost.init({\n                blockfrostApiKey: blockfrostApiKey,\n                network: network\n              });\n\n            case 4:\n              _context12.t0 = csl.TransactionBuilder;\n              _context12.next = 7;\n              return this._getTxBuilderConfig();\n\n            case 7:\n              _context12.t1 = _context12.sent;\n              txBuilder = _context12.t0[\"new\"].call(_context12.t0, _context12.t1);\n              // end: init\n              // prepare datum\n              datum = this.createDatum({\n                ownerAddressBech32: ownerAddress,\n                assets: assets\n              });\n              datumHash = plutusDataToHex(datum);\n              console.log('datumHash', datumHash); // outputs\n\n              outputs = [{\n                address: ownerAddress,\n                assets: {},\n                datum: datum\n              }];\n              asset = null;\n              assets.map(function (assetId) {\n                outputs[0].assets[assetId] = 1;\n                asset = assetId;\n              });\n              outputs[0].assets['lovelace'] = 3000000;\n              console.log(44, 'outputs', outputs);\n              _context12.next = 19;\n              return this._addOutputs({\n                txBuilder: txBuilder,\n                outputs: outputs\n              });\n\n            case 19:\n              // inputs\n              _asset$split2 = asset.split('.'), policy = _asset$split2[0], assetName = _asset$split2[1];\n              asset = \"\" + policy + toHex(assetName);\n              _context12.next = 23;\n              return this._addInputUtxoSC({\n                scriptAddress: scriptAddress,\n                asset: asset\n              });\n\n            case 23:\n              _yield$this$_addInput = _context12.sent;\n              txInputsBuilder = _yield$this$_addInput.txInputsBuilder;\n              utxoselected = _yield$this$_addInput.utxoselected;\n              console.log(22);\n              scriptWitness = this.getPlutusWitness(csl.PlutusScript[\"new\"](fromHex('4e4d01000033222220051200120011')), datum, this.unlock, utxoselected);\n              console.log(33);\n              txInputsBuilder.add_plutus_script_input(scriptWitness, utxoselected.input(), utxoselected.output().amount());\n              console.log(44);\n              txBuilder.set_inputs(txInputsBuilder);\n              console.log(44); // here to finalizeTx\n\n              txBuilder.calc_script_data_hash(csl.TxBuilderConstants.plutus_vasil_cost_models());\n              console.log(55);\n              _context12.next = 37;\n              return this._addChange({\n                txBuilder: txBuilder,\n                changeAddress: ownerAddress\n              });\n\n            case 37:\n              console.log(66);\n              _context12.next = 40;\n              return this._buildTransaction({\n                txBuilder: txBuilder\n              });\n\n            case 40:\n              transactionHex = _context12.sent;\n              console.log(77);\n              return _context12.abrupt(\"return\", transactionHex);\n\n            case 43:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, _callee12, this);\n    }));\n\n    function buildSC(_x11) {\n      return _buildSC.apply(this, arguments);\n    }\n\n    return buildSC;\n  }();\n\n  _proto.unlock = function unlock(index) {\n    var data = csl.PlutusData.new_constr_plutus_data(csl.ConstrPlutusData[\"new\"](csl.BigNum.from_str('0'), csl.PlutusList[\"new\"]()));\n    var redeemer = csl.Redeemer[\"new\"](csl.RedeemerTag.new_spend(), csl.BigNum.from_str(index), data, csl.ExUnits[\"new\"](csl.BigNum.from_str('7000000'), csl.BigNum.from_str('3000000000')));\n    return redeemer;\n  };\n\n  _proto.setCollateral = function setCollateral(txBuilder, utxos) {\n    var inputBuilder = csl.TxInputsBuilder[\"new\"]();\n    utxos.forEach(function (utxo) {\n      inputBuilder.add_input(utxo.output().address(), utxo.input(), utxo.output().amount());\n    });\n    txBuilder.set_collateral(inputBuilder);\n  };\n\n  _proto.getPlutusWitness = function getPlutusWitness(script, datum, redeemer, utxo) {\n    return csl.PlutusWitness[\"new\"](script, datum, redeemer(utxo.input().index().toString()));\n  };\n\n  _proto.getRequiredSigners = function getRequiredSigners(utxos, scriptInput, collateral) {\n    var inputs = [].concat(utxos, collateral);\n    var addresses = new Set();\n    inputs.forEach(function (utxo) {\n      addresses.add(utxo.output().address().to_bech32());\n    });\n    addresses[\"delete\"](scriptInput.output().address().to_bech32());\n    var requiredSigners = csl.Ed25519KeyHashes[\"new\"]();\n    addresses.forEach(function (address) {\n      var keyHash = getAddressKeyHash(address);\n\n      if (keyHash) {\n        requiredSigners.add(keyHash);\n      }\n    });\n    return requiredSigners;\n  };\n\n  _proto.getCollateral = /*#__PURE__*/function () {\n    var _getCollateral = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13() {\n      var collatUtxos, collateral, _iterator9, _step9, x, utxo;\n\n      return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              collatUtxos = [];\n              _context13.next = 3;\n              return this.wallet.getCollateral();\n\n            case 3:\n              collateral = _context13.sent;\n\n              for (_iterator9 = _createForOfIteratorHelperLoose(collateral); !(_step9 = _iterator9()).done;) {\n                x = _step9.value;\n                utxo = csl.TransactionUnspentOutput.from_bytes(Buffer.from(x, 'hex'));\n                collatUtxos.push(utxo);\n              }\n\n              return _context13.abrupt(\"return\", collatUtxos);\n\n            case 6:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee13, this);\n    }));\n\n    function getCollateral() {\n      return _getCollateral.apply(this, arguments);\n    }\n\n    return getCollateral;\n  }();\n\n  _proto.buildSCv2 = /*#__PURE__*/function () {\n    var _buildSCv = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(_ref17) {\n      var ownerAddress, scriptAddress, blockfrostApiKey, network, txBuilder, scriptAddressObj, shelleyChangeAddress, assetName, assetNameHex, assetAmountToSend, assetPolicyIdHex, transactionIdLocked, lovelaceLocked, plutusScriptCborHex, transactionIndxLocked, manualFee, multiAsset, assets, scripts, txOutputBuilder, walletUtxos, utxos, transactionUnspentOutputs, txBody, collateral, inputs, datum, datumHash, datums, redeemers, data, redeemer, transactionWitnessSet, cost_model_vals, costModel, costModels, scriptDataHash, baseAddress, requiredSigners, transaction, transactionBytes, transactionHex;\n      return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n        while (1) {\n          switch (_context14.prev = _context14.next) {\n            case 0:\n              ownerAddress = _ref17.ownerAddress, scriptAddress = _ref17.scriptAddress, blockfrostApiKey = _ref17.blockfrostApiKey, network = _ref17.network;\n              // start: init\n              this._blockfrost = new Blockfrost();\n              _context14.next = 4;\n              return this._blockfrost.init({\n                blockfrostApiKey: blockfrostApiKey,\n                network: network\n              });\n\n            case 4:\n              _context14.t0 = csl.TransactionBuilder;\n              _context14.next = 7;\n              return this._getTxBuilderConfig();\n\n            case 7:\n              _context14.t1 = _context14.sent;\n              txBuilder = _context14.t0[\"new\"].call(_context14.t0, _context14.t1);\n              // end: init\n              scriptAddressObj = StringToAddress(scriptAddress);\n              shelleyChangeAddress = StringToAddress(ownerAddress);\n              assetName = 'SOCIETY';\n              assetNameHex = toHex(assetName);\n              assetAmountToSend = 1;\n              assetPolicyIdHex = 'f57f145fb8dd8373daff7cf55cea181669e99c4b73328531ebd4419a';\n              transactionIdLocked = '3c0fc4774e529432b2eaa654720231ad6c6d92ae2a4a7ab2544a93dcfa3c8561';\n              lovelaceLocked = 3000000;\n              plutusScriptCborHex = '4e4d01000033222220051200120011';\n              transactionIndxLocked = 0;\n              manualFee = 900000;\n              multiAsset = csl.MultiAsset[\"new\"]();\n              assets = csl.Assets[\"new\"]();\n              assets.insert(csl.AssetName[\"new\"](Buffer.from(assetNameHex, 'hex')), // Asset Name\n              csl.BigNum.from_str(assetAmountToSend.toString()) // How much to send\n              );\n              multiAsset.insert(csl.ScriptHash.from_bytes(Buffer.from(assetPolicyIdHex, 'hex')), // PolicyID\n              assets);\n              txBuilder.add_input(scriptAddressObj, csl.TransactionInput[\"new\"](csl.TransactionHash.from_bytes(Buffer.from(transactionIdLocked, 'hex')), transactionIndxLocked), csl.Value.new_from_assets(multiAsset)); // how much lovelace is at that UTXO\n\n              txBuilder.set_fee(csl.BigNum.from_str(Number(manualFee).toString()));\n              scripts = csl.PlutusScripts[\"new\"]();\n              scripts.add(csl.PlutusScript.from_bytes(Buffer.from(plutusScriptCborHex, 'hex'))); //from cbor of plutus script\n              // Add outputs\n\n              txOutputBuilder = csl.TransactionOutputBuilder[\"new\"]().with_address(shelleyChangeAddress).next().with_coin_and_asset(csl.BigNum.from_str(lovelaceLocked.toString()), multiAsset).build();\n              txBuilder.add_output(txOutputBuilder); // add utxos from user\n\n              _context14.next = 32;\n              return this.wallet.getUtxos();\n\n            case 32:\n              walletUtxos = _context14.sent;\n              utxos = walletUtxos.map(function (utxo) {\n                return csl.TransactionUnspentOutput.from_bytes(Buffer.from(utxo.cbor, 'hex'));\n              });\n              transactionUnspentOutputs = csl.TransactionUnspentOutputs[\"new\"]();\n              utxos.forEach(function (utxo) {\n                transactionUnspentOutputs.add(utxo);\n              });\n              txBuilder.add_inputs_from(transactionUnspentOutputs, csl.CoinSelectionStrategyCIP2.LargestFirstMultiAsset); //txBuilder.add_change_if_needed(shelleyChangeAddress);\n              // once the transaction is ready, we build it to get the tx body without witnesses\n\n              txBody = txBuilder.build();\n              _context14.next = 40;\n              return this.getCollateral();\n\n            case 40:\n              collateral = _context14.sent;\n              inputs = csl.TransactionInputs[\"new\"]();\n              collateral.forEach(function (utxo) {\n                inputs.add(utxo.input());\n              }); // make datum\n\n              datum = this.createDatum({\n                ownerAddressBech32: ownerAddress,\n                assets: [assetPolicyIdHex + \".\" + assetName]\n              });\n              datumHash = plutusDataToHex(datum);\n              console.log('datumHash', datumHash);\n              datums = csl.PlutusList[\"new\"](); // datums.add(PlutusData.from_bytes(Buffer.from(this.state.datumStr, \"utf8\")))\n\n              datums.add(datum);\n              redeemers = csl.Redeemers[\"new\"]();\n              data = csl.PlutusData.new_constr_plutus_data(csl.ConstrPlutusData[\"new\"](csl.BigNum.from_str('0'), csl.PlutusList[\"new\"]()));\n              redeemer = csl.Redeemer[\"new\"](csl.RedeemerTag.new_spend(), csl.BigNum.from_str('0'), data, csl.ExUnits[\"new\"](csl.BigNum.from_str('7000000'), csl.BigNum.from_str('3000000000')));\n              redeemers.add(redeemer); // Tx witness\n\n              transactionWitnessSet = csl.TransactionWitnessSet[\"new\"]();\n              transactionWitnessSet.set_plutus_scripts(scripts);\n              transactionWitnessSet.set_plutus_data(datums);\n              transactionWitnessSet.set_redeemers(redeemers); // Pre Vasil hard fork cost model\n              // const cost_model_vals = [197209, 0, 1, 1, 396231, 621, 0, 1, 150000, 1000, 0, 1, 150000, 32, 2477736, 29175, 4, 29773, 100, 29773, 100, 29773, 100, 29773, 100, 29773, 100, 29773, 100, 100, 100, 29773, 100, 150000, 32, 150000, 32, 150000, 32, 150000, 1000, 0, 1, 150000, 32, 150000, 1000, 0, 8, 148000, 425507, 118, 0, 1, 1, 150000, 1000, 0, 8, 150000, 112536, 247, 1, 150000, 10000, 1, 136542, 1326, 1, 1000, 150000, 1000, 1, 150000, 32, 150000, 32, 150000, 32, 1, 1, 150000, 1, 150000, 4, 103599, 248, 1, 103599, 248, 1, 145276, 1366, 1, 179690, 497, 1, 150000, 32, 150000, 32, 150000, 32, 150000, 32, 150000, 32, 150000, 32, 148000, 425507, 118, 0, 1, 1, 61516, 11218, 0, 1, 150000, 32, 148000, 425507, 118, 0, 1, 1, 148000, 425507, 118, 0, 1, 1, 2477736, 29175, 4, 0, 82363, 4, 150000, 5000, 0, 1, 150000, 32, 197209, 0, 1, 1, 150000, 32, 150000, 32, 150000, 32, 150000, 32, 150000, 32, 150000, 32, 150000, 32, 3345831, 1, 1];\n\n              /*\r\n                  Post Vasil hard fork cost model\r\n                  If you need to make this code work on the Mainnnet, before Vasil hard-fork\r\n                  Then you need to comment this section below and uncomment the cost model above\r\n                  Otherwise it will give errors when redeeming from Scripts\r\n                  Sending assets and ada to Script addresses is unaffected by this cost model\r\n                   */\n\n              cost_model_vals = [205665, 812, 1, 1, 1000, 571, 0, 1, 1000, 24177, 4, 1, 1000, 32, 117366, 10475, 4, 23000, 100, 23000, 100, 23000, 100, 23000, 100, 23000, 100, 23000, 100, 100, 100, 23000, 100, 19537, 32, 175354, 32, 46417, 4, 221973, 511, 0, 1, 89141, 32, 497525, 14068, 4, 2, 196500, 453240, 220, 0, 1, 1, 1000, 28662, 4, 2, 245000, 216773, 62, 1, 1060367, 12586, 1, 208512, 421, 1, 187000, 1000, 52998, 1, 80436, 32, 43249, 32, 1000, 32, 80556, 1, 57667, 4, 1000, 10, 197145, 156, 1, 197145, 156, 1, 204924, 473, 1, 208896, 511, 1, 52467, 32, 64832, 32, 65493, 32, 22558, 32, 16563, 32, 76511, 32, 196500, 453240, 220, 0, 1, 1, 69522, 11687, 0, 1, 60091, 32, 196500, 453240, 220, 0, 1, 1, 196500, 453240, 220, 0, 1, 1, 806990, 30482, 4, 1927926, 82523, 4, 265318, 0, 4, 0, 85931, 32, 205665, 812, 1, 1, 41182, 32, 212342, 32, 31220, 32, 32696, 32, 43357, 32, 32247, 32, 38314, 32, 9462713, 1021, 10];\n              costModel = csl.CostModel[\"new\"]();\n              cost_model_vals.forEach(function (x, i) {\n                return costModel.set(i, csl.Int.new_i32(x));\n              });\n              costModels = csl.Costmdls[\"new\"]();\n              costModels.insert(csl.Language.new_plutus_v1(), costModel);\n              scriptDataHash = csl.hash_script_data(redeemers, costModels, datums);\n              txBody.set_script_data_hash(scriptDataHash);\n              txBody.set_collateral(inputs);\n              baseAddress = csl.BaseAddress.from_address(shelleyChangeAddress);\n              requiredSigners = csl.Ed25519KeyHashes[\"new\"]();\n              requiredSigners.add(baseAddress == null ? void 0 : baseAddress.payment_cred().to_keyhash());\n              txBody.set_required_signers(requiredSigners);\n              transaction = csl.Transaction[\"new\"](txBody, csl.TransactionWitnessSet.from_bytes(transactionWitnessSet.to_bytes()));\n              transactionBytes = transaction.to_bytes();\n              transactionHex = toHex(transactionBytes);\n              return _context14.abrupt(\"return\", transactionHex);\n\n            case 72:\n            case \"end\":\n              return _context14.stop();\n          }\n        }\n      }, _callee14, this);\n    }));\n\n    function buildSCv2(_x12) {\n      return _buildSCv.apply(this, arguments);\n    }\n\n    return buildSCv2;\n  }();\n\n  _proto._getAssetUtxo = /*#__PURE__*/function () {\n    var _getAssetUtxo2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(_ref18) {\n      var _this4 = this;\n\n      var scriptAddress, asset, utxosFromBF, utxos;\n      return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              scriptAddress = _ref18.scriptAddress, asset = _ref18.asset;\n              _context15.next = 3;\n              return this._blockfrost.addressesAddressUtxosAsset({\n                address: scriptAddress,\n                asset: asset\n              });\n\n            case 3:\n              utxosFromBF = _context15.sent;\n              console.log('utxosFromBF', utxosFromBF);\n              utxos = utxosFromBF.filter(function (utxo) {\n                // return utxo.data_hash !== null;\n                return utxo.data_hash == \"287bb96b1b2b86658cae7a5a2c10a8e6663f710a7e0aa9df7b439891be6ede8c\";\n              }).map(function (utxoBF) {\n                var txoutput = _this4.createTxUnspentOutput(StringToAddress(scriptAddress), utxoBF);\n\n                console.log('txoutput', txoutput);\n                return txoutput;\n              });\n              return _context15.abrupt(\"return\", utxos[0]);\n\n            case 7:\n            case \"end\":\n              return _context15.stop();\n          }\n        }\n      }, _callee15, this);\n    }));\n\n    function _getAssetUtxo(_x13) {\n      return _getAssetUtxo2.apply(this, arguments);\n    }\n\n    return _getAssetUtxo;\n  }();\n\n  _proto.buildSCv3 = /*#__PURE__*/function () {\n    var _buildSCv2 = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16(_ref19) {\n      var _assets2;\n\n      var ownerAddress, scriptAddress, blockfrostApiKey, network, txBuilder, assetName, assetNameHex, assetPolicyIdHex, assetUtxo, walletUtxos, utxos, transactionUnspentOutputs, inputs, outputs, plutusScripts, datum, datumHash, datums, txInputsBuilder, plutusWitness, collateral, requiredSigners, _transactionUnspentOutputs, tx, txVkeyWitnessesHex, txVkeyWitnesses, transactionWitnessSet, signedTx, txHex, txHash;\n\n      return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n        while (1) {\n          switch (_context16.prev = _context16.next) {\n            case 0:\n              ownerAddress = _ref19.ownerAddress, scriptAddress = _ref19.scriptAddress, blockfrostApiKey = _ref19.blockfrostApiKey, network = _ref19.network;\n              // start: init\n              this._blockfrost = new Blockfrost();\n              _context16.next = 4;\n              return this._blockfrost.init({\n                blockfrostApiKey: blockfrostApiKey,\n                network: network\n              });\n\n            case 4:\n              _context16.t0 = csl.TransactionBuilder;\n              _context16.next = 7;\n              return this._getTxBuilderConfig();\n\n            case 7:\n              _context16.t1 = _context16.sent;\n              txBuilder = _context16.t0[\"new\"].call(_context16.t0, _context16.t1);\n              assetName = 'SOCIETY';\n              assetNameHex = toHex(assetName);\n              assetPolicyIdHex = 'f57f145fb8dd8373daff7cf55cea181669e99c4b73328531ebd4419a'; // let transactionIdLocked =\n              //   '3c0fc4774e529432b2eaa654720231ad6c6d92ae2a4a7ab2544a93dcfa3c8561';\n\n              _context16.next = 14;\n              return this._getAssetUtxo({\n                scriptAddress: scriptAddress,\n                asset: \"\" + assetPolicyIdHex + assetNameHex\n              });\n\n            case 14:\n              assetUtxo = _context16.sent;\n              _context16.next = 17;\n              return this.wallet.getUtxos();\n\n            case 17:\n              walletUtxos = _context16.sent;\n              utxos = walletUtxos.map(function (utxo) {\n                return csl.TransactionUnspentOutput.from_bytes(Buffer.from(utxo.cbor, 'hex'));\n              });\n              transactionUnspentOutputs = csl.TransactionUnspentOutputs[\"new\"]();\n              utxos.forEach(function (utxo) {\n                transactionUnspentOutputs.add(utxo);\n              });\n              inputs = [].concat(utxos);\n\n              if (assetUtxo) {\n                inputs.push(assetUtxo);\n              } ////\n\n\n              outputs = [{\n                address: ownerAddress,\n                assets: (_assets2 = {}, _assets2[assetPolicyIdHex + \".\" + assetName] = 1, _assets2.lovelace = 3000000, _assets2)\n              }];\n\n              this._addOutputs({\n                txBuilder: txBuilder,\n                outputs: outputs,\n                ownerAddressBech32: ownerAddress\n              }); ////\n\n\n              plutusScripts = csl.PlutusScripts[\"new\"]();\n              plutusScripts.add(csl.PlutusScript.from_bytes(Buffer.from('4e4d01000033222220051200120011', 'hex'))); // make datum\n\n              datum = this.createDatum({\n                ownerAddressBech32: ownerAddress,\n                assets: [assetPolicyIdHex + \".\" + assetName]\n              });\n              datumHash = plutusDataToHex(datum);\n              console.log('datumHash', datumHash);\n              datums = csl.PlutusList[\"new\"]();\n              datums.add(datum);\n\n              if (!plutusScripts) {\n                _context16.next = 43;\n                break;\n              }\n\n              txInputsBuilder = csl.TxInputsBuilder[\"new\"]();\n              plutusWitness = this.getPlutusWitness(plutusScripts.get(0), datums.get(0), this.unlock, assetUtxo);\n              txInputsBuilder.add_plutus_script_input(plutusWitness, assetUtxo.input(), assetUtxo.output().amount());\n              _context16.next = 38;\n              return this.wallet.getCollateral();\n\n            case 38:\n              collateral = _context16.sent.map(function (utxo) {\n                return csl.TransactionUnspentOutput.from_bytes(fromHex(utxo));\n              }).slice(0, 1);\n              this.setCollateral(txBuilder, collateral);\n              requiredSigners = this.getRequiredSigners(inputs, assetUtxo, collateral);\n              txInputsBuilder.add_required_signers(requiredSigners);\n              txBuilder.set_inputs(txInputsBuilder);\n\n            case 43:\n              txBuilder.calc_script_data_hash(csl.TxBuilderConstants.plutus_vasil_cost_models());\n              _context16.prev = 44;\n              _transactionUnspentOutputs = csl.TransactionUnspentOutputs[\"new\"]();\n              inputs.forEach(function (utxo) {\n                _transactionUnspentOutputs.add(utxo);\n              });\n              txBuilder.add_inputs_from(_transactionUnspentOutputs, csl.CoinSelectionStrategyCIP2.LargestFirstMultiAsset);\n              txBuilder.add_change_if_needed(StringToAddress(ownerAddress));\n              _context16.next = 54;\n              break;\n\n            case 51:\n              _context16.prev = 51;\n              _context16.t2 = _context16[\"catch\"](44);\n              throw new Error(\"INPUTS_EXHAUSTED\");\n\n            case 54:\n              tx = txBuilder.build_tx();\n              _context16.next = 57;\n              return this.wallet.signTx({\n                tx: toHex(tx.to_bytes()),\n                partialSign: true\n              });\n\n            case 57:\n              txVkeyWitnessesHex = _context16.sent;\n              txVkeyWitnesses = csl.TransactionWitnessSet.from_bytes(fromHex(txVkeyWitnessesHex));\n              transactionWitnessSet = csl.TransactionWitnessSet.from_bytes(tx.witness_set().to_bytes());\n              transactionWitnessSet.set_vkeys(txVkeyWitnesses == null ? void 0 : txVkeyWitnesses.vkeys());\n              signedTx = csl.Transaction[\"new\"](tx.body(), transactionWitnessSet, tx.auxiliary_data());\n              txHex = toHex(signedTx.to_bytes());\n              _context16.next = 65;\n              return this.wallet.submitTx({\n                tx: txHex\n              });\n\n            case 65:\n              txHash = _context16.sent;\n              console.log('txHash', txHash);\n              return _context16.abrupt(\"return\", txHash);\n\n            case 68:\n            case \"end\":\n              return _context16.stop();\n          }\n        }\n      }, _callee16, this, [[44, 51]]);\n    }));\n\n    function buildSCv3(_x14) {\n      return _buildSCv2.apply(this, arguments);\n    }\n\n    return buildSCv3;\n  }();\n\n  return Transaction;\n}();\n\nvar Axios = function Axios(_ref2) {\n  var _this = this;\n\n  var baseURL = _ref2.baseURL,\n      _ref2$headers = _ref2.headers,\n      headers = _ref2$headers === void 0 ? {} : _ref2$headers;\n\n  this._createAxiosInstance = function (_ref3) {\n    var baseURL = _ref3.baseURL,\n        headers = _ref3.headers;\n    return axios__WEBPACK_IMPORTED_MODULE_1__.create({\n      baseURL: baseURL,\n      headers: headers\n    });\n  };\n\n  this.post = function (_ref4) {\n    var endpoint = _ref4.endpoint,\n        data = _ref4.data,\n        _ref4$headers = _ref4.headers,\n        headers = _ref4$headers === void 0 ? {} : _ref4$headers;\n    return _this._instance.post(endpoint, data, {\n      headers: headers\n    });\n  };\n\n  this.get = function (_ref5) {\n    var endpoint = _ref5.endpoint;\n    return _this._instance.get(endpoint);\n  };\n\n  this._instance = this._createAxiosInstance({\n    baseURL: baseURL,\n    headers: headers\n  });\n};\n\nvar Infura = /*#__PURE__*/function () {\n  function Infura() {}\n\n  var _proto = Infura.prototype;\n\n  _proto.init = /*#__PURE__*/function () {\n    var _init = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref) {\n      var projectId, projectSecret, ipfsApiEndpoint, headers;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              projectId = _ref.projectId, projectSecret = _ref.projectSecret, ipfsApiEndpoint = _ref.ipfsApiEndpoint;\n              headers = {\n                auth: projectId + \":\" + projectSecret\n              };\n              this._instance = new Axios({\n                baseURL: ipfsApiEndpoint != null ? ipfsApiEndpoint : 'https://ipfs.infura.io:5001/api/v0',\n                headers: headers\n              });\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function init(_x) {\n      return _init.apply(this, arguments);\n    }\n\n    return init;\n  }()\n  /**\r\n   * Add a file or directory to IPFS.\r\n   * https://docs.infura.io/infura/networks/ipfs/http-api-methods/add\r\n   * @returns\r\n   */\n  ;\n\n  _proto.addFileIpfs =\n  /*#__PURE__*/\n  function () {\n    var _addFileIpfs = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref2) {\n      var formData;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              formData = _ref2.formData;\n              _context2.next = 3;\n              return this._instance.post({\n                endpoint: '/add?',\n                data: formData,\n                headers: {\n                  'Content-Type': 'multipart/form-data'\n                }\n              }).then(function (_ref3) {\n                var data = _ref3.data;\n                return data;\n              })[\"catch\"](function (error) {\n                throw error;\n              });\n\n            case 3:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    function addFileIpfs(_x2) {\n      return _addFileIpfs.apply(this, arguments);\n    }\n\n    return addFileIpfs;\n  }();\n\n  return Infura;\n}();\n\nvar DEFAULT_PROTOCOL_PARAMETERS = {\n  coinsPerUTxOSize: '4310',\n  priceMem: 0.0577,\n  priceStep: 0.0000721,\n  minFeeA: 44,\n  minFeeB: 155381,\n  keyDeposit: '2000000',\n  maxTxSize: 16384,\n  maxValSize: '5000',\n  poolDeposit: '500000000'\n};\nvar POLICY_ID_LENGTH = 56;\n\nvar Trackable = function Trackable(constructor) {\n  return /*#__PURE__*/function (_constructor) {\n    _inheritsLoose(_class, _constructor);\n\n    function _class() {\n      var _this;\n\n      _this = _constructor.apply(this, arguments) || this;\n      _this.__visits = [];\n      return _this;\n    }\n\n    return _class;\n  }(constructor);\n};\nvar Checkpoint = function Checkpoint() {\n  return function (_target, propertyKey, descriptor) {\n    var method = descriptor.value;\n\n    descriptor.value = function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var result = method.call.apply(method, [this].concat(args));\n      if (this.__visits) this.__visits.push(propertyKey);\n      return result;\n    };\n  };\n};\n\nvar deserializeAddress = function deserializeAddress(address) {\n  return csl.Address.from_bytes(toBytes(address));\n};\nvar deserializeDataHash = function deserializeDataHash(dataHash) {\n  return csl.DataHash.from_bytes(toBytes(dataHash));\n};\nvar deserializePlutusData = function deserializePlutusData(plutusData) {\n  return csl.PlutusData.from_bytes(toBytes(plutusData));\n};\nvar deserializeScriptRef = function deserializeScriptRef(scriptRef) {\n  return csl.ScriptRef.from_bytes(toBytes(scriptRef));\n};\nvar deserializeScriptHash = function deserializeScriptHash(scriptHash) {\n  return csl.ScriptHash.from_bytes(toBytes(scriptHash));\n};\nvar deserializeTx = function deserializeTx(tx) {\n  return csl.Transaction.from_bytes(toBytes(tx));\n};\nvar deserializeTxHash = function deserializeTxHash(txHash) {\n  return csl.TransactionHash.from_bytes(toBytes(txHash));\n};\nvar deserializeTxUnspentOutput = function deserializeTxUnspentOutput(txUnspentOutput) {\n  return csl.TransactionUnspentOutput.from_bytes(toBytes(txUnspentOutput));\n};\nvar deserializeTxWitnessSet = function deserializeTxWitnessSet(txWitnessSet) {\n  return csl.TransactionWitnessSet.from_bytes(toBytes(txWitnessSet));\n};\nvar deserializeValue = function deserializeValue(value) {\n  return csl.Value.from_bytes(toBytes(value));\n};\n\n/* -----------------[ ASCII ]----------------- */\n\nvar toASCII = function toASCII(hex) {\n  return Buffer.from(hex, 'hex').toString('ascii');\n};\n/* -----------------[ Address ]----------------- */\n\nvar toAddress = function toAddress(bech32) {\n  return csl.Address.from_bech32(bech32);\n};\n/* -----------------[ Bytes ]----------------- */\n\nvar fromBytes = function fromBytes(bytes) {\n  return Buffer.from(bytes).toString('hex');\n};\nvar toBytes = function toBytes(hex) {\n  return Buffer.from(hex, 'hex');\n};\n/* -----------------[ TransactionUnspentOutput ]----------------- */\n\nvar fromTxUnspentOutput = function fromTxUnspentOutput(txUnspentOutput) {\n  var _txUnspentOutput$outp, _txUnspentOutput$outp2, _txUnspentOutput$outp3;\n\n  var dataHash = txUnspentOutput.output().has_data_hash() ? fromBytes((_txUnspentOutput$outp = txUnspentOutput.output().data_hash()) == null ? void 0 : _txUnspentOutput$outp.to_bytes()) : undefined;\n  var plutusData = txUnspentOutput.output().has_plutus_data() ? fromBytes((_txUnspentOutput$outp2 = txUnspentOutput.output().plutus_data()) == null ? void 0 : _txUnspentOutput$outp2.to_bytes()) : undefined;\n  var scriptRef = txUnspentOutput.output().has_script_ref() ? fromBytes((_txUnspentOutput$outp3 = txUnspentOutput.output().script_ref()) == null ? void 0 : _txUnspentOutput$outp3.to_bytes()) : undefined;\n  return {\n    input: {\n      outputIndex: txUnspentOutput.input().index(),\n      txHash: fromBytes(txUnspentOutput.input().transaction_id().to_bytes())\n    },\n    output: {\n      address: txUnspentOutput.output().address().to_bech32(),\n      amount: fromValue(txUnspentOutput.output().amount()),\n      dataHash: dataHash,\n      plutusData: plutusData,\n      scriptRef: scriptRef\n    }\n  };\n};\nvar toTxUnspentOutput = function toTxUnspentOutput(utxo) {\n  var txInput = csl.TransactionInput[\"new\"](deserializeTxHash(utxo.input.txHash), utxo.input.outputIndex);\n  var txOutput = csl.TransactionOutput[\"new\"](toAddress(utxo.output.address), toValue(utxo.output.amount));\n\n  if (utxo.output.dataHash !== undefined) {\n    txOutput.set_data_hash(deserializeDataHash(utxo.output.dataHash));\n  }\n\n  if (utxo.output.plutusData !== undefined) {\n    txOutput.set_plutus_data(deserializePlutusData(utxo.output.plutusData));\n  }\n\n  if (utxo.output.scriptRef !== undefined) {\n    txOutput.set_script_ref(deserializeScriptRef(utxo.output.scriptRef));\n  }\n\n  return csl.TransactionUnspentOutput[\"new\"](txInput, txOutput);\n};\n/* -----------------[ UnitInterval ]----------------- */\n\nvar toUnitInterval = function toUnitInterval(_float) {\n  var decimal = _float.split('.')[1];\n\n  var numerator = \"\" + parseInt(decimal, 10);\n  var denominator = '1' + '0'.repeat(decimal.length);\n  return csl.UnitInterval[\"new\"](csl.BigNum.from_str(numerator), csl.BigNum.from_str(denominator));\n};\n/* -----------------[ Value ]----------------- */\n\nvar fromValue = function fromValue(value) {\n  var assets = [{\n    unit: 'lovelace',\n    quantity: value.coin().to_str()\n  }];\n  var multiasset = value.multiasset();\n\n  if (multiasset !== undefined) {\n    var policies = multiasset.keys();\n\n    for (var i = 0; i < policies.len(); i += 1) {\n      var policyId = policies.get(i);\n      var policyAssets = multiasset.get(policyId);\n\n      if (policyAssets !== undefined) {\n        var policyAssetNames = policyAssets.keys();\n\n        for (var j = 0; j < policyAssetNames.len(); j += 1) {\n          var _policyAssets$get;\n\n          var assetName = policyAssetNames.get(j);\n          var quantity = (_policyAssets$get = policyAssets.get(assetName)) != null ? _policyAssets$get : csl.BigNum.from_str('0');\n          var assetId = fromBytes(policyId.to_bytes()) + fromBytes(assetName.name());\n          assets.push({\n            unit: assetId,\n            quantity: quantity.to_str()\n          });\n        }\n      }\n    }\n  }\n\n  return assets;\n};\nvar toValue = function toValue(assets) {\n  var lovelace = assets.find(function (asset) {\n    return asset.unit === 'lovelace';\n  });\n  var policies = Array.from(new Set(assets.filter(function (asset) {\n    return asset.unit !== 'lovelace';\n  }).map(function (asset) {\n    return asset.unit.slice(0, POLICY_ID_LENGTH);\n  })));\n  var multiAsset = csl.MultiAsset[\"new\"]();\n  policies.forEach(function (policyId) {\n    var policyAssets = csl.Assets[\"new\"]();\n    assets.filter(function (asset) {\n      return asset.unit.slice(0, POLICY_ID_LENGTH) === policyId;\n    }).forEach(function (asset) {\n      policyAssets.insert(csl.AssetName[\"new\"](toBytes(asset.unit.slice(POLICY_ID_LENGTH))), csl.BigNum.from_str(asset.quantity));\n    });\n    multiAsset.insert(deserializeScriptHash(policyId), policyAssets);\n  });\n  var value = csl.Value[\"new\"](csl.BigNum.from_str(lovelace ? lovelace.quantity : '0'));\n\n  if (assets.length > 1 || !lovelace) {\n    value.set_multiasset(multiAsset);\n  }\n\n  return value;\n};\n\nvar resolveFingerprint = function resolveFingerprint(policyId, assetName) {\n  return \"\" + policyId + assetName; // TODO: CIP 14 - User-Facing Asset Fingerprint\n};\n\nvar TransactionService_1;\n\nvar TransactionService = TransactionService_1 = /*#__PURE__*/function () {\n  function TransactionService(_walletService, parameters) {\n    this._walletService = _walletService;\n    this._txBuilder = TransactionService_1.createTxBuilder(parameters);\n  }\n\n  var _proto = TransactionService.prototype;\n\n  _proto.build = /*#__PURE__*/function () {\n    var _build = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return this.addTxInputsIfNeeded();\n\n            case 3:\n              _context.next = 5;\n              return this.addChangeAddressIfNeeded();\n\n            case 5:\n              return _context.abrupt(\"return\", fromBytes(this._txBuilder.build_tx().to_bytes()));\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n              throw _context.t0;\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[0, 8]]);\n    }));\n\n    function build() {\n      return _build.apply(this, arguments);\n    }\n\n    return build;\n  }();\n\n  _proto.sendLovelace = function sendLovelace(address, lovelace) {\n    var txOutput = csl.TransactionOutputBuilder[\"new\"]().with_address(toAddress(address)).next().with_coin(csl.BigNum.from_str(lovelace)).build();\n\n    this._txBuilder.add_output(txOutput);\n\n    return this;\n  };\n\n  _proto.sendAssets = function sendAssets(address, assets, coinsPerByte) {\n    if (coinsPerByte === void 0) {\n      coinsPerByte = DEFAULT_PROTOCOL_PARAMETERS.coinsPerUTxOSize;\n    }\n\n    var amount = toValue(assets);\n    var multiasset = amount.multiasset();\n\n    if (amount.is_zero() || multiasset === undefined) {\n      return this;\n    }\n\n    var txOutput = csl.TransactionOutputBuilder[\"new\"]().with_address(toAddress(address)).next().with_asset_and_min_required_coin_by_utxo_cost(multiasset, csl.DataCost.new_coins_per_byte(csl.BigNum.from_str(coinsPerByte))).build();\n\n    this._txBuilder.add_output(txOutput);\n\n    return this;\n  };\n\n  _proto.setChangeAddress = function setChangeAddress(address) {\n    this._txBuilder.add_change_if_needed(toAddress(address));\n\n    return this;\n  };\n\n  _proto.setMetadata = function setMetadata(key, value) {\n    this._txBuilder.add_json_metadatum_with_schema(csl.BigNum.from_str(key.toString()), JSON.stringify(value), csl.MetadataJsonSchema.DetailedSchema);\n\n    return this;\n  };\n\n  _proto.setTimeToLive = function setTimeToLive(slot) {\n    this._txBuilder.set_ttl_bignum(csl.BigNum.from_str(slot));\n\n    return this;\n  };\n\n  _proto.setTxInputs = function setTxInputs(inputs) {\n    var txInputsBuilder = csl.TxInputsBuilder[\"new\"]();\n    inputs.map(function (input) {\n      return toTxUnspentOutput(input);\n    }).forEach(function (utxo) {\n      txInputsBuilder.add_input(utxo.output().address(), utxo.input(), utxo.output().amount());\n    });\n\n    this._txBuilder.set_inputs(txInputsBuilder);\n\n    return this;\n  };\n\n  TransactionService.createTxBuilder = function createTxBuilder(parameters) {\n    if (parameters === void 0) {\n      parameters = DEFAULT_PROTOCOL_PARAMETERS;\n    }\n\n    var txBuilderConfig = csl.TransactionBuilderConfigBuilder[\"new\"]().coins_per_utxo_byte(csl.BigNum.from_str(parameters.coinsPerUTxOSize)).ex_unit_prices(csl.ExUnitPrices[\"new\"](toUnitInterval(parameters.priceMem.toString()), toUnitInterval(parameters.priceStep.toString()))).fee_algo(csl.LinearFee[\"new\"](csl.BigNum.from_str(parameters.minFeeA.toString()), csl.BigNum.from_str(parameters.minFeeB.toString()))).key_deposit(csl.BigNum.from_str(parameters.keyDeposit)).max_tx_size(parameters.maxTxSize).max_value_size(parseInt(parameters.maxValSize)).pool_deposit(csl.BigNum.from_str(parameters.poolDeposit)).build();\n    return csl.TransactionBuilder[\"new\"](txBuilderConfig);\n  };\n\n  _proto.addChangeAddressIfNeeded = /*#__PURE__*/function () {\n    var _addChangeAddressIfNeeded = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var changeAddress;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!this.notReached('setChangeAddress')) {\n                _context2.next = 5;\n                break;\n              }\n\n              _context2.next = 3;\n              return this._walletService.getChangeAddress();\n\n            case 3:\n              changeAddress = _context2.sent;\n\n              this._txBuilder.add_change_if_needed(toAddress(changeAddress));\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    function addChangeAddressIfNeeded() {\n      return _addChangeAddressIfNeeded.apply(this, arguments);\n    }\n\n    return addChangeAddressIfNeeded;\n  }();\n\n  _proto.addTxInputsIfNeeded = /*#__PURE__*/function () {\n    var _addTxInputsIfNeeded = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      var walletUtxos, coinSelectionStrategy;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!this.notReached('setTxInputs')) {\n                _context3.next = 6;\n                break;\n              }\n\n              _context3.next = 3;\n              return this.getWalletUtxos();\n\n            case 3:\n              walletUtxos = _context3.sent;\n              coinSelectionStrategy = !this.notReached('sendAssets') ? csl.CoinSelectionStrategyCIP2.LargestFirstMultiAsset : csl.CoinSelectionStrategyCIP2.LargestFirst;\n\n              this._txBuilder.add_inputs_from(walletUtxos, coinSelectionStrategy);\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    function addTxInputsIfNeeded() {\n      return _addTxInputsIfNeeded.apply(this, arguments);\n    }\n\n    return addTxInputsIfNeeded;\n  }();\n\n  _proto.getWalletUtxos = /*#__PURE__*/function () {\n    var _getWalletUtxos = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      var txUnspentOutputs, walletUtxos;\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              txUnspentOutputs = csl.TransactionUnspentOutputs[\"new\"]();\n              _context4.next = 3;\n              return this._walletService.getDeserializedUtxos();\n\n            case 3:\n              walletUtxos = _context4.sent;\n              walletUtxos.forEach(function (utxo) {\n                txUnspentOutputs.add(utxo);\n              });\n              return _context4.abrupt(\"return\", txUnspentOutputs);\n\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    function getWalletUtxos() {\n      return _getWalletUtxos.apply(this, arguments);\n    }\n\n    return getWalletUtxos;\n  }();\n\n  _proto.notReached = function notReached(checkpoint) {\n    return this.__visits.includes(checkpoint) === false;\n  };\n\n  return TransactionService;\n}();\n\n(0,tslib__WEBPACK_IMPORTED_MODULE_2__.__decorate)([Checkpoint()], TransactionService.prototype, \"sendAssets\", null);\n\n(0,tslib__WEBPACK_IMPORTED_MODULE_2__.__decorate)([Checkpoint()], TransactionService.prototype, \"setChangeAddress\", null);\n\n(0,tslib__WEBPACK_IMPORTED_MODULE_2__.__decorate)([Checkpoint()], TransactionService.prototype, \"setTxInputs\", null);\n\nTransactionService = TransactionService_1 = /*#__PURE__*/(0,tslib__WEBPACK_IMPORTED_MODULE_2__.__decorate)([Trackable], TransactionService);\n\nvar WalletService = /*#__PURE__*/function () {\n  function WalletService(_walletInstance) {\n    this._walletInstance = _walletInstance;\n  }\n\n  WalletService.getInstalledWallets = function getInstalledWallets() {\n    if (window.cardano === undefined) return [];\n    return WalletService.supportedWallets.filter(function (sw) {\n      return window.cardano[sw] !== undefined;\n    }).map(function (sw) {\n      return {\n        name: window.cardano[sw].name,\n        icon: window.cardano[sw].icon,\n        version: window.cardano[sw].apiVersion\n      };\n    });\n  };\n\n  WalletService.enable = /*#__PURE__*/function () {\n    var _enable = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(walletName) {\n      var walletInstance;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return WalletService.resolveInstance(walletName);\n\n            case 3:\n              walletInstance = _context.sent;\n\n              if (!(walletInstance !== undefined)) {\n                _context.next = 6;\n                break;\n              }\n\n              return _context.abrupt(\"return\", new WalletService(walletInstance));\n\n            case 6:\n              throw new Error(\"Couldn't create an instance of wallet: \" + walletName + \".\");\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              throw _context.t0;\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 9]]);\n    }));\n\n    function enable(_x) {\n      return _enable.apply(this, arguments);\n    }\n\n    return enable;\n  }();\n\n  var _proto = WalletService.prototype;\n\n  _proto.getBalance = /*#__PURE__*/function () {\n    var _getBalance = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var balance;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return this._walletInstance.getBalance();\n\n            case 2:\n              balance = _context2.sent;\n              return _context2.abrupt(\"return\", fromValue(deserializeValue(balance)));\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    function getBalance() {\n      return _getBalance.apply(this, arguments);\n    }\n\n    return getBalance;\n  }();\n\n  _proto.getChangeAddress = /*#__PURE__*/function () {\n    var _getChangeAddress = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      var changeAddress;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return this._walletInstance.getChangeAddress();\n\n            case 2:\n              changeAddress = _context3.sent;\n              return _context3.abrupt(\"return\", deserializeAddress(changeAddress).to_bech32());\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    function getChangeAddress() {\n      return _getChangeAddress.apply(this, arguments);\n    }\n\n    return getChangeAddress;\n  }();\n\n  _proto.getCollateral = /*#__PURE__*/function () {\n    var _getCollateral = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      var deserializedCollateral;\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return this.getDeserializedCollateral();\n\n            case 2:\n              deserializedCollateral = _context4.sent;\n              return _context4.abrupt(\"return\", deserializedCollateral.map(function (dc) {\n                return fromTxUnspentOutput(dc);\n              }));\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    function getCollateral() {\n      return _getCollateral.apply(this, arguments);\n    }\n\n    return getCollateral;\n  }();\n\n  _proto.getDeserializedCollateral = /*#__PURE__*/function () {\n    var _getDeserializedCollateral = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n      var _yield$this$_walletIn;\n\n      var collateral;\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return this._walletInstance.experimental.getCollateral();\n\n            case 2:\n              _context5.t0 = _yield$this$_walletIn = _context5.sent;\n\n              if (!(_context5.t0 != null)) {\n                _context5.next = 7;\n                break;\n              }\n\n              _context5.t1 = _yield$this$_walletIn;\n              _context5.next = 8;\n              break;\n\n            case 7:\n              _context5.t1 = [];\n\n            case 8:\n              collateral = _context5.t1;\n              return _context5.abrupt(\"return\", collateral.map(function (c) {\n                return deserializeTxUnspentOutput(c);\n              }));\n\n            case 10:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    function getDeserializedCollateral() {\n      return _getDeserializedCollateral.apply(this, arguments);\n    }\n\n    return getDeserializedCollateral;\n  }();\n\n  _proto.getNetworkId = function getNetworkId() {\n    return this._walletInstance.getNetworkId();\n  };\n\n  _proto.getRewardAddresses = /*#__PURE__*/function () {\n    var _getRewardAddresses = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n      var rewardAddresses;\n      return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return this._walletInstance.getRewardAddresses();\n\n            case 2:\n              rewardAddresses = _context6.sent;\n              return _context6.abrupt(\"return\", rewardAddresses.map(function (ra) {\n                return deserializeAddress(ra).to_bech32();\n              }));\n\n            case 4:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6, this);\n    }));\n\n    function getRewardAddresses() {\n      return _getRewardAddresses.apply(this, arguments);\n    }\n\n    return getRewardAddresses;\n  }();\n\n  _proto.getUnusedAddresses = /*#__PURE__*/function () {\n    var _getUnusedAddresses = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n      var unusedAddresses;\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return this._walletInstance.getUnusedAddresses();\n\n            case 2:\n              unusedAddresses = _context7.sent;\n              return _context7.abrupt(\"return\", unusedAddresses.map(function (una) {\n                return deserializeAddress(una).to_bech32();\n              }));\n\n            case 4:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7, this);\n    }));\n\n    function getUnusedAddresses() {\n      return _getUnusedAddresses.apply(this, arguments);\n    }\n\n    return getUnusedAddresses;\n  }();\n\n  _proto.getUsedAddresses = /*#__PURE__*/function () {\n    var _getUsedAddresses = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n      var usedAddresses;\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return this._walletInstance.getUsedAddresses();\n\n            case 2:\n              usedAddresses = _context8.sent;\n              return _context8.abrupt(\"return\", usedAddresses.map(function (usa) {\n                return deserializeAddress(usa).to_bech32();\n              }));\n\n            case 4:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8, this);\n    }));\n\n    function getUsedAddresses() {\n      return _getUsedAddresses.apply(this, arguments);\n    }\n\n    return getUsedAddresses;\n  }();\n\n  _proto.getUtxos = /*#__PURE__*/function () {\n    var _getUtxos = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n      var deserializedUtxos;\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.next = 2;\n              return this.getDeserializedUtxos();\n\n            case 2:\n              deserializedUtxos = _context9.sent;\n              return _context9.abrupt(\"return\", deserializedUtxos.map(function (du) {\n                return fromTxUnspentOutput(du);\n              }));\n\n            case 4:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9, this);\n    }));\n\n    function getUtxos() {\n      return _getUtxos.apply(this, arguments);\n    }\n\n    return getUtxos;\n  }();\n\n  _proto.getDeserializedUtxos = /*#__PURE__*/function () {\n    var _getDeserializedUtxos = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n      var _yield$this$_walletIn2;\n\n      var utxos;\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.next = 2;\n              return this._walletInstance.getUtxos();\n\n            case 2:\n              _context10.t0 = _yield$this$_walletIn2 = _context10.sent;\n\n              if (!(_context10.t0 != null)) {\n                _context10.next = 7;\n                break;\n              }\n\n              _context10.t1 = _yield$this$_walletIn2;\n              _context10.next = 8;\n              break;\n\n            case 7:\n              _context10.t1 = [];\n\n            case 8:\n              utxos = _context10.t1;\n              return _context10.abrupt(\"return\", utxos.map(function (u) {\n                return deserializeTxUnspentOutput(u);\n              }));\n\n            case 10:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10, this);\n    }));\n\n    function getDeserializedUtxos() {\n      return _getDeserializedUtxos.apply(this, arguments);\n    }\n\n    return getDeserializedUtxos;\n  }();\n\n  _proto.signData = /*#__PURE__*/function () {\n    var _signData = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(payload) {\n      var changeAddress;\n      return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              _context11.next = 2;\n              return this._walletInstance.getChangeAddress();\n\n            case 2:\n              changeAddress = _context11.sent;\n              return _context11.abrupt(\"return\", this._walletInstance.signData(changeAddress, payload));\n\n            case 4:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11, this);\n    }));\n\n    function signData(_x2) {\n      return _signData.apply(this, arguments);\n    }\n\n    return signData;\n  }();\n\n  _proto.signTx = /*#__PURE__*/function () {\n    var _signTx = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(unsignedTx, partialSign) {\n      var tx, txWitnessSet, walletWitnessSet, walletVerificationKeys, signedTx;\n      return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              if (partialSign === void 0) {\n                partialSign = false;\n              }\n\n              _context12.prev = 1;\n              tx = deserializeTx(unsignedTx);\n              txWitnessSet = deserializeTxWitnessSet(fromBytes(tx.witness_set().to_bytes()));\n              _context12.next = 6;\n              return this._walletInstance.signTx(unsignedTx, partialSign);\n\n            case 6:\n              walletWitnessSet = _context12.sent;\n              walletVerificationKeys = deserializeTxWitnessSet(walletWitnessSet).vkeys();\n              if (walletVerificationKeys !== undefined) txWitnessSet.set_vkeys(walletVerificationKeys);\n              signedTx = fromBytes(csl.Transaction[\"new\"](tx.body(), txWitnessSet, tx.auxiliary_data()).to_bytes());\n              return _context12.abrupt(\"return\", signedTx);\n\n            case 13:\n              _context12.prev = 13;\n              _context12.t0 = _context12[\"catch\"](1);\n              throw _context12.t0;\n\n            case 16:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, _callee12, this, [[1, 13]]);\n    }));\n\n    function signTx(_x3, _x4) {\n      return _signTx.apply(this, arguments);\n    }\n\n    return signTx;\n  }();\n\n  _proto.submitTx = function submitTx(tx) {\n    return this._walletInstance.submitTx(tx);\n  };\n\n  _proto.getAssets = /*#__PURE__*/function () {\n    var _getAssets = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13() {\n      var balance;\n      return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              _context13.next = 2;\n              return this.getBalance();\n\n            case 2:\n              balance = _context13.sent;\n              return _context13.abrupt(\"return\", balance.filter(function (v) {\n                return v.unit !== 'lovelace';\n              }).map(function (v) {\n                var policyId = v.unit.slice(0, POLICY_ID_LENGTH);\n                var assetName = v.unit.slice(POLICY_ID_LENGTH);\n                var fingerprint = resolveFingerprint(policyId, assetName);\n                return {\n                  unit: v.unit,\n                  policyId: policyId,\n                  assetName: toASCII(assetName),\n                  fingerprint: fingerprint,\n                  quantity: v.quantity\n                };\n              }));\n\n            case 4:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee13, this);\n    }));\n\n    function getAssets() {\n      return _getAssets.apply(this, arguments);\n    }\n\n    return getAssets;\n  }();\n\n  _proto.getLovelace = /*#__PURE__*/function () {\n    var _getLovelace = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14() {\n      var balance, nativeAsset;\n      return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n        while (1) {\n          switch (_context14.prev = _context14.next) {\n            case 0:\n              _context14.next = 2;\n              return this.getBalance();\n\n            case 2:\n              balance = _context14.sent;\n              nativeAsset = balance.find(function (v) {\n                return v.unit === 'lovelace';\n              });\n              return _context14.abrupt(\"return\", nativeAsset !== undefined ? nativeAsset.quantity : '0');\n\n            case 5:\n            case \"end\":\n              return _context14.stop();\n          }\n        }\n      }, _callee14, this);\n    }));\n\n    function getLovelace() {\n      return _getLovelace.apply(this, arguments);\n    }\n\n    return getLovelace;\n  }();\n\n  _proto.getPolicyIdAssets = /*#__PURE__*/function () {\n    var _getPolicyIdAssets = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(policyId) {\n      var assets;\n      return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              _context15.next = 2;\n              return this.getAssets();\n\n            case 2:\n              assets = _context15.sent;\n              return _context15.abrupt(\"return\", assets.filter(function (v) {\n                return v.policyId === policyId;\n              }));\n\n            case 4:\n            case \"end\":\n              return _context15.stop();\n          }\n        }\n      }, _callee15, this);\n    }));\n\n    function getPolicyIdAssets(_x5) {\n      return _getPolicyIdAssets.apply(this, arguments);\n    }\n\n    return getPolicyIdAssets;\n  }();\n\n  _proto.getPolicyIds = /*#__PURE__*/function () {\n    var _getPolicyIds = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16() {\n      var balance;\n      return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n        while (1) {\n          switch (_context16.prev = _context16.next) {\n            case 0:\n              _context16.next = 2;\n              return this.getBalance();\n\n            case 2:\n              balance = _context16.sent;\n              return _context16.abrupt(\"return\", Array.from(new Set(balance.map(function (v) {\n                return v.unit.slice(0, POLICY_ID_LENGTH);\n              }))).filter(function (p) {\n                return p !== 'lovelace';\n              }));\n\n            case 4:\n            case \"end\":\n              return _context16.stop();\n          }\n        }\n      }, _callee16, this);\n    }));\n\n    function getPolicyIds() {\n      return _getPolicyIds.apply(this, arguments);\n    }\n\n    return getPolicyIds;\n  }();\n\n  WalletService.resolveInstance = function resolveInstance(walletName) {\n    if (window.cardano === undefined) return undefined;\n    var wallet = WalletService.supportedWallets.map(function (sw) {\n      return window.cardano[sw];\n    }).filter(function (sw) {\n      return sw !== undefined;\n    }).find(function (sw) {\n      return sw.name === walletName;\n    });\n    return wallet == null ? void 0 : wallet.enable();\n  };\n\n  return WalletService;\n}();\nWalletService.supportedWallets = ['flint', 'nami', 'eternl', 'nufi'];\n\nvar Mesh = function Mesh() {\n  this.blockfrost = new Blockfrost();\n  this.infura = new Infura();\n  this.wallet = new Wallet({\n    blockfrost: this.blockfrost\n  });\n  this.transaction = new Transaction({\n    wallet: this.wallet\n  });\n};\n\nvar index = /*#__PURE__*/new Mesh();\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (index);\n\n//# sourceMappingURL=mesh.esm.js.map\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } }, 1);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQG1hcnRpZnlsYWJzL21lc2gvZGlzdC9tZXNoLmVzbS5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBZ0M7QUFDSjtBQUNPOztBQUVuQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBLHlEQUF5RDtBQUN6RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0EsYUFBYTtBQUNiLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHlEQUF5RDtBQUN6RDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsb0ZBQW9GO0FBQ3BGO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHNCQUFzQjs7QUFFdkM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIOztBQUVBOztBQUVBO0FBQ0EsYUFBYSxZQUFZO0FBQ3pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsK0NBQStDLFFBQVE7QUFDdkQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLCtDQUErQyxRQUFRO0FBQ3ZEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLCtDQUErQyxRQUFRO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLCtDQUErQyxRQUFRO0FBQ3ZEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsY0FBYyx1QkFBdUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEseUNBQXlDLFNBQVM7O0FBRWxEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsK0NBQVk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBLGVBQWU7O0FBRWY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0EsZUFBZTs7QUFFZjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTs7QUFFZjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FB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QUNBLGVBQWU7O0FBRWY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsV0FBVztBQUM5QztBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFD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QUFDQSxHQUFHOztBQUVIO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwwRUFBMEUsYUFBYTtBQUN2RjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOztBQUVBLG9CQUFvQixvQkFBb0I7QUFDeEM7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0Esb0NBQW9DO0FBQ3BDOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQsaURBQVU7O0FBRVYsaURBQVU7O0FBRVYsaURBQVU7O0FBRVYseURBQXlELGlEQUFVOztBQUVuRTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTs7QUFFZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7O0FBRWY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7O0FBRWY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTs7QUFFZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7O0FBRWY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlOztBQUVmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7O0FBRWY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7O0FBRWY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0EsZUFBZTs7QUFFZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0EsQ0FBQztBQUNEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTs7QUFFQSxpRUFBZSxLQUFLLEVBQUM7QUFDd0I7QUFDN0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcGJsLWZyb250LWVuZC10ZW1wbGF0ZS1uZXh0anMtbWVzaC8uL25vZGVfbW9kdWxlcy9AbWFydGlmeWxhYnMvbWVzaC9kaXN0L21lc2guZXNtLmpzP2UyMjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zL2luZGV4JztcbmltcG9ydCBheGlvcyQxIGZyb20gJ2F4aW9zJztcbmltcG9ydCB7IF9fZGVjb3JhdGUgfSBmcm9tICd0c2xpYic7XG5cbmZ1bmN0aW9uIF9yZWdlbmVyYXRvclJ1bnRpbWUoKSB7XG4gIC8qISByZWdlbmVyYXRvci1ydW50aW1lIC0tIENvcHlyaWdodCAoYykgMjAxNC1wcmVzZW50LCBGYWNlYm9vaywgSW5jLiAtLSBsaWNlbnNlIChNSVQpOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVnZW5lcmF0b3IvYmxvYi9tYWluL0xJQ0VOU0UgKi9cblxuICBfcmVnZW5lcmF0b3JSdW50aW1lID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBleHBvcnRzO1xuICB9O1xuXG4gIHZhciBleHBvcnRzID0ge30sXG4gICAgICBPcCA9IE9iamVjdC5wcm90b3R5cGUsXG4gICAgICBoYXNPd24gPSBPcC5oYXNPd25Qcm9wZXJ0eSxcbiAgICAgICRTeW1ib2wgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCA/IFN5bWJvbCA6IHt9LFxuICAgICAgaXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLml0ZXJhdG9yIHx8IFwiQEBpdGVyYXRvclwiLFxuICAgICAgYXN5bmNJdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuYXN5bmNJdGVyYXRvciB8fCBcIkBAYXN5bmNJdGVyYXRvclwiLFxuICAgICAgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8IFwiQEB0b1N0cmluZ1RhZ1wiO1xuXG4gIGZ1bmN0aW9uIGRlZmluZShvYmosIGtleSwgdmFsdWUpIHtcbiAgICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICBlbnVtZXJhYmxlOiAhMCxcbiAgICAgIGNvbmZpZ3VyYWJsZTogITAsXG4gICAgICB3cml0YWJsZTogITBcbiAgICB9KSwgb2JqW2tleV07XG4gIH1cblxuICB0cnkge1xuICAgIGRlZmluZSh7fSwgXCJcIik7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGRlZmluZSA9IGZ1bmN0aW9uIChvYmosIGtleSwgdmFsdWUpIHtcbiAgICAgIHJldHVybiBvYmpba2V5XSA9IHZhbHVlO1xuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiB3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgdmFyIHByb3RvR2VuZXJhdG9yID0gb3V0ZXJGbiAmJiBvdXRlckZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvciA/IG91dGVyRm4gOiBHZW5lcmF0b3IsXG4gICAgICAgIGdlbmVyYXRvciA9IE9iamVjdC5jcmVhdGUocHJvdG9HZW5lcmF0b3IucHJvdG90eXBlKSxcbiAgICAgICAgY29udGV4dCA9IG5ldyBDb250ZXh0KHRyeUxvY3NMaXN0IHx8IFtdKTtcbiAgICByZXR1cm4gZ2VuZXJhdG9yLl9pbnZva2UgPSBmdW5jdGlvbiAoaW5uZXJGbiwgc2VsZiwgY29udGV4dCkge1xuICAgICAgdmFyIHN0YXRlID0gXCJzdXNwZW5kZWRTdGFydFwiO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtZXRob2QsIGFyZykge1xuICAgICAgICBpZiAoXCJleGVjdXRpbmdcIiA9PT0gc3RhdGUpIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmdcIik7XG5cbiAgICAgICAgaWYgKFwiY29tcGxldGVkXCIgPT09IHN0YXRlKSB7XG4gICAgICAgICAgaWYgKFwidGhyb3dcIiA9PT0gbWV0aG9kKSB0aHJvdyBhcmc7XG4gICAgICAgICAgcmV0dXJuIGRvbmVSZXN1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29udGV4dC5tZXRob2QgPSBtZXRob2QsIGNvbnRleHQuYXJnID0gYXJnOzspIHtcbiAgICAgICAgICB2YXIgZGVsZWdhdGUgPSBjb250ZXh0LmRlbGVnYXRlO1xuXG4gICAgICAgICAgaWYgKGRlbGVnYXRlKSB7XG4gICAgICAgICAgICB2YXIgZGVsZWdhdGVSZXN1bHQgPSBtYXliZUludm9rZURlbGVnYXRlKGRlbGVnYXRlLCBjb250ZXh0KTtcblxuICAgICAgICAgICAgaWYgKGRlbGVnYXRlUmVzdWx0KSB7XG4gICAgICAgICAgICAgIGlmIChkZWxlZ2F0ZVJlc3VsdCA9PT0gQ29udGludWVTZW50aW5lbCkgY29udGludWU7XG4gICAgICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZVJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoXCJuZXh0XCIgPT09IGNvbnRleHQubWV0aG9kKSBjb250ZXh0LnNlbnQgPSBjb250ZXh0Ll9zZW50ID0gY29udGV4dC5hcmc7ZWxzZSBpZiAoXCJ0aHJvd1wiID09PSBjb250ZXh0Lm1ldGhvZCkge1xuICAgICAgICAgICAgaWYgKFwic3VzcGVuZGVkU3RhcnRcIiA9PT0gc3RhdGUpIHRocm93IHN0YXRlID0gXCJjb21wbGV0ZWRcIiwgY29udGV4dC5hcmc7XG4gICAgICAgICAgICBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGNvbnRleHQuYXJnKTtcbiAgICAgICAgICB9IGVsc2UgXCJyZXR1cm5cIiA9PT0gY29udGV4dC5tZXRob2QgJiYgY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgY29udGV4dC5hcmcpO1xuICAgICAgICAgIHN0YXRlID0gXCJleGVjdXRpbmdcIjtcbiAgICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG5cbiAgICAgICAgICBpZiAoXCJub3JtYWxcIiA9PT0gcmVjb3JkLnR5cGUpIHtcbiAgICAgICAgICAgIGlmIChzdGF0ZSA9IGNvbnRleHQuZG9uZSA/IFwiY29tcGxldGVkXCIgOiBcInN1c3BlbmRlZFlpZWxkXCIsIHJlY29yZC5hcmcgPT09IENvbnRpbnVlU2VudGluZWwpIGNvbnRpbnVlO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdmFsdWU6IHJlY29yZC5hcmcsXG4gICAgICAgICAgICAgIGRvbmU6IGNvbnRleHQuZG9uZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBcInRocm93XCIgPT09IHJlY29yZC50eXBlICYmIChzdGF0ZSA9IFwiY29tcGxldGVkXCIsIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiLCBjb250ZXh0LmFyZyA9IHJlY29yZC5hcmcpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0oaW5uZXJGbiwgc2VsZiwgY29udGV4dCksIGdlbmVyYXRvcjtcbiAgfVxuXG4gIGZ1bmN0aW9uIHRyeUNhdGNoKGZuLCBvYmosIGFyZykge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcIm5vcm1hbFwiLFxuICAgICAgICBhcmc6IGZuLmNhbGwob2JqLCBhcmcpXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJ0aHJvd1wiLFxuICAgICAgICBhcmc6IGVyclxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBleHBvcnRzLndyYXAgPSB3cmFwO1xuICB2YXIgQ29udGludWVTZW50aW5lbCA9IHt9O1xuXG4gIGZ1bmN0aW9uIEdlbmVyYXRvcigpIHt9XG5cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fVxuXG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKCkge31cblxuICB2YXIgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTtcbiAgZGVmaW5lKEl0ZXJhdG9yUHJvdG90eXBlLCBpdGVyYXRvclN5bWJvbCwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9KTtcbiAgdmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuICAgICAgTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90byAmJiBnZXRQcm90byhnZXRQcm90byh2YWx1ZXMoW10pKSk7XG4gIE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlICYmIE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlICE9PSBPcCAmJiBoYXNPd24uY2FsbChOYXRpdmVJdGVyYXRvclByb3RvdHlwZSwgaXRlcmF0b3JTeW1ib2wpICYmIChJdGVyYXRvclByb3RvdHlwZSA9IE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlKTtcbiAgdmFyIEdwID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUucHJvdG90eXBlID0gR2VuZXJhdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUpO1xuXG4gIGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhwcm90b3R5cGUpIHtcbiAgICBbXCJuZXh0XCIsIFwidGhyb3dcIiwgXCJyZXR1cm5cIl0uZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7XG4gICAgICBkZWZpbmUocHJvdG90eXBlLCBtZXRob2QsIGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIEFzeW5jSXRlcmF0b3IoZ2VuZXJhdG9yLCBQcm9taXNlSW1wbCkge1xuICAgIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goZ2VuZXJhdG9yW21ldGhvZF0sIGdlbmVyYXRvciwgYXJnKTtcblxuICAgICAgaWYgKFwidGhyb3dcIiAhPT0gcmVjb3JkLnR5cGUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHJlY29yZC5hcmcsXG4gICAgICAgICAgICB2YWx1ZSA9IHJlc3VsdC52YWx1ZTtcbiAgICAgICAgcmV0dXJuIHZhbHVlICYmIFwib2JqZWN0XCIgPT0gdHlwZW9mIHZhbHVlICYmIGhhc093bi5jYWxsKHZhbHVlLCBcIl9fYXdhaXRcIikgPyBQcm9taXNlSW1wbC5yZXNvbHZlKHZhbHVlLl9fYXdhaXQpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgaW52b2tlKFwibmV4dFwiLCB2YWx1ZSwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgIGludm9rZShcInRocm93XCIsIGVyciwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgfSkgOiBQcm9taXNlSW1wbC5yZXNvbHZlKHZhbHVlKS50aGVuKGZ1bmN0aW9uICh1bndyYXBwZWQpIHtcbiAgICAgICAgICByZXN1bHQudmFsdWUgPSB1bndyYXBwZWQsIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuIGludm9rZShcInRocm93XCIsIGVycm9yLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmVqZWN0KHJlY29yZC5hcmcpO1xuICAgIH1cblxuICAgIHZhciBwcmV2aW91c1Byb21pc2U7XG5cbiAgICB0aGlzLl9pbnZva2UgPSBmdW5jdGlvbiAobWV0aG9kLCBhcmcpIHtcbiAgICAgIGZ1bmN0aW9uIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2VJbXBsKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICBpbnZva2UobWV0aG9kLCBhcmcsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcHJldmlvdXNQcm9taXNlID0gcHJldmlvdXNQcm9taXNlID8gcHJldmlvdXNQcm9taXNlLnRoZW4oY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcsIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKSA6IGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCk7XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1heWJlSW52b2tlRGVsZWdhdGUoZGVsZWdhdGUsIGNvbnRleHQpIHtcbiAgICB2YXIgbWV0aG9kID0gZGVsZWdhdGUuaXRlcmF0b3JbY29udGV4dC5tZXRob2RdO1xuXG4gICAgaWYgKHVuZGVmaW5lZCA9PT0gbWV0aG9kKSB7XG4gICAgICBpZiAoY29udGV4dC5kZWxlZ2F0ZSA9IG51bGwsIFwidGhyb3dcIiA9PT0gY29udGV4dC5tZXRob2QpIHtcbiAgICAgICAgaWYgKGRlbGVnYXRlLml0ZXJhdG9yLnJldHVybiAmJiAoY29udGV4dC5tZXRob2QgPSBcInJldHVyblwiLCBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZCwgbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCksIFwidGhyb3dcIiA9PT0gY29udGV4dC5tZXRob2QpKSByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCIsIGNvbnRleHQuYXJnID0gbmV3IFR5cGVFcnJvcihcIlRoZSBpdGVyYXRvciBkb2VzIG5vdCBwcm92aWRlIGEgJ3Rocm93JyBtZXRob2RcIik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChtZXRob2QsIGRlbGVnYXRlLml0ZXJhdG9yLCBjb250ZXh0LmFyZyk7XG4gICAgaWYgKFwidGhyb3dcIiA9PT0gcmVjb3JkLnR5cGUpIHJldHVybiBjb250ZXh0Lm1ldGhvZCA9IFwidGhyb3dcIiwgY29udGV4dC5hcmcgPSByZWNvcmQuYXJnLCBjb250ZXh0LmRlbGVnYXRlID0gbnVsbCwgQ29udGludWVTZW50aW5lbDtcbiAgICB2YXIgaW5mbyA9IHJlY29yZC5hcmc7XG4gICAgcmV0dXJuIGluZm8gPyBpbmZvLmRvbmUgPyAoY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWUsIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2MsIFwicmV0dXJuXCIgIT09IGNvbnRleHQubWV0aG9kICYmIChjb250ZXh0Lm1ldGhvZCA9IFwibmV4dFwiLCBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZCksIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsLCBDb250aW51ZVNlbnRpbmVsKSA6IGluZm8gOiAoY29udGV4dC5tZXRob2QgPSBcInRocm93XCIsIGNvbnRleHQuYXJnID0gbmV3IFR5cGVFcnJvcihcIml0ZXJhdG9yIHJlc3VsdCBpcyBub3QgYW4gb2JqZWN0XCIpLCBjb250ZXh0LmRlbGVnYXRlID0gbnVsbCwgQ29udGludWVTZW50aW5lbCk7XG4gIH1cblxuICBmdW5jdGlvbiBwdXNoVHJ5RW50cnkobG9jcykge1xuICAgIHZhciBlbnRyeSA9IHtcbiAgICAgIHRyeUxvYzogbG9jc1swXVxuICAgIH07XG4gICAgMSBpbiBsb2NzICYmIChlbnRyeS5jYXRjaExvYyA9IGxvY3NbMV0pLCAyIGluIGxvY3MgJiYgKGVudHJ5LmZpbmFsbHlMb2MgPSBsb2NzWzJdLCBlbnRyeS5hZnRlckxvYyA9IGxvY3NbM10pLCB0aGlzLnRyeUVudHJpZXMucHVzaChlbnRyeSk7XG4gIH1cblxuICBmdW5jdGlvbiByZXNldFRyeUVudHJ5KGVudHJ5KSB7XG4gICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb24gfHwge307XG4gICAgcmVjb3JkLnR5cGUgPSBcIm5vcm1hbFwiLCBkZWxldGUgcmVjb3JkLmFyZywgZW50cnkuY29tcGxldGlvbiA9IHJlY29yZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIENvbnRleHQodHJ5TG9jc0xpc3QpIHtcbiAgICB0aGlzLnRyeUVudHJpZXMgPSBbe1xuICAgICAgdHJ5TG9jOiBcInJvb3RcIlxuICAgIH1dLCB0cnlMb2NzTGlzdC5mb3JFYWNoKHB1c2hUcnlFbnRyeSwgdGhpcyksIHRoaXMucmVzZXQoITApO1xuICB9XG5cbiAgZnVuY3Rpb24gdmFsdWVzKGl0ZXJhYmxlKSB7XG4gICAgaWYgKGl0ZXJhYmxlKSB7XG4gICAgICB2YXIgaXRlcmF0b3JNZXRob2QgPSBpdGVyYWJsZVtpdGVyYXRvclN5bWJvbF07XG4gICAgICBpZiAoaXRlcmF0b3JNZXRob2QpIHJldHVybiBpdGVyYXRvck1ldGhvZC5jYWxsKGl0ZXJhYmxlKTtcbiAgICAgIGlmIChcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGl0ZXJhYmxlLm5leHQpIHJldHVybiBpdGVyYWJsZTtcblxuICAgICAgaWYgKCFpc05hTihpdGVyYWJsZS5sZW5ndGgpKSB7XG4gICAgICAgIHZhciBpID0gLTEsXG4gICAgICAgICAgICBuZXh0ID0gZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgICBmb3IgKDsgKytpIDwgaXRlcmFibGUubGVuZ3RoOykgaWYgKGhhc093bi5jYWxsKGl0ZXJhYmxlLCBpKSkgcmV0dXJuIG5leHQudmFsdWUgPSBpdGVyYWJsZVtpXSwgbmV4dC5kb25lID0gITEsIG5leHQ7XG5cbiAgICAgICAgICByZXR1cm4gbmV4dC52YWx1ZSA9IHVuZGVmaW5lZCwgbmV4dC5kb25lID0gITAsIG5leHQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG5leHQubmV4dCA9IG5leHQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIG5leHQ6IGRvbmVSZXN1bHRcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gZG9uZVJlc3VsdCgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgIGRvbmU6ICEwXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBHZW5lcmF0b3JGdW5jdGlvbi5wcm90b3R5cGUgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgZGVmaW5lKEdwLCBcImNvbnN0cnVjdG9yXCIsIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKSwgZGVmaW5lKEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLCBcImNvbnN0cnVjdG9yXCIsIEdlbmVyYXRvckZ1bmN0aW9uKSwgR2VuZXJhdG9yRnVuY3Rpb24uZGlzcGxheU5hbWUgPSBkZWZpbmUoR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIHRvU3RyaW5nVGFnU3ltYm9sLCBcIkdlbmVyYXRvckZ1bmN0aW9uXCIpLCBleHBvcnRzLmlzR2VuZXJhdG9yRnVuY3Rpb24gPSBmdW5jdGlvbiAoZ2VuRnVuKSB7XG4gICAgdmFyIGN0b3IgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGdlbkZ1biAmJiBnZW5GdW4uY29uc3RydWN0b3I7XG4gICAgcmV0dXJuICEhY3RvciAmJiAoY3RvciA9PT0gR2VuZXJhdG9yRnVuY3Rpb24gfHwgXCJHZW5lcmF0b3JGdW5jdGlvblwiID09PSAoY3Rvci5kaXNwbGF5TmFtZSB8fCBjdG9yLm5hbWUpKTtcbiAgfSwgZXhwb3J0cy5tYXJrID0gZnVuY3Rpb24gKGdlbkZ1bikge1xuICAgIHJldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YoZ2VuRnVuLCBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSkgOiAoZ2VuRnVuLl9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLCBkZWZpbmUoZ2VuRnVuLCB0b1N0cmluZ1RhZ1N5bWJvbCwgXCJHZW5lcmF0b3JGdW5jdGlvblwiKSksIGdlbkZ1bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdwKSwgZ2VuRnVuO1xuICB9LCBleHBvcnRzLmF3cmFwID0gZnVuY3Rpb24gKGFyZykge1xuICAgIHJldHVybiB7XG4gICAgICBfX2F3YWl0OiBhcmdcbiAgICB9O1xuICB9LCBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpLCBkZWZpbmUoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUsIGFzeW5jSXRlcmF0b3JTeW1ib2wsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfSksIGV4cG9ydHMuQXN5bmNJdGVyYXRvciA9IEFzeW5jSXRlcmF0b3IsIGV4cG9ydHMuYXN5bmMgPSBmdW5jdGlvbiAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QsIFByb21pc2VJbXBsKSB7XG4gICAgdm9pZCAwID09PSBQcm9taXNlSW1wbCAmJiAoUHJvbWlzZUltcGwgPSBQcm9taXNlKTtcbiAgICB2YXIgaXRlciA9IG5ldyBBc3luY0l0ZXJhdG9yKHdyYXAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpLCBQcm9taXNlSW1wbCk7XG4gICAgcmV0dXJuIGV4cG9ydHMuaXNHZW5lcmF0b3JGdW5jdGlvbihvdXRlckZuKSA/IGl0ZXIgOiBpdGVyLm5leHQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgIHJldHVybiByZXN1bHQuZG9uZSA/IHJlc3VsdC52YWx1ZSA6IGl0ZXIubmV4dCgpO1xuICAgIH0pO1xuICB9LCBkZWZpbmVJdGVyYXRvck1ldGhvZHMoR3ApLCBkZWZpbmUoR3AsIHRvU3RyaW5nVGFnU3ltYm9sLCBcIkdlbmVyYXRvclwiKSwgZGVmaW5lKEdwLCBpdGVyYXRvclN5bWJvbCwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9KSwgZGVmaW5lKEdwLCBcInRvU3RyaW5nXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gXCJbb2JqZWN0IEdlbmVyYXRvcl1cIjtcbiAgfSksIGV4cG9ydHMua2V5cyA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICB2YXIga2V5cyA9IFtdO1xuXG4gICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkga2V5cy5wdXNoKGtleSk7XG5cbiAgICByZXR1cm4ga2V5cy5yZXZlcnNlKCksIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICBmb3IgKDsga2V5cy5sZW5ndGg7KSB7XG4gICAgICAgIHZhciBrZXkgPSBrZXlzLnBvcCgpO1xuICAgICAgICBpZiAoa2V5IGluIG9iamVjdCkgcmV0dXJuIG5leHQudmFsdWUgPSBrZXksIG5leHQuZG9uZSA9ICExLCBuZXh0O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV4dC5kb25lID0gITAsIG5leHQ7XG4gICAgfTtcbiAgfSwgZXhwb3J0cy52YWx1ZXMgPSB2YWx1ZXMsIENvbnRleHQucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDb250ZXh0LFxuICAgIHJlc2V0OiBmdW5jdGlvbiAoc2tpcFRlbXBSZXNldCkge1xuICAgICAgaWYgKHRoaXMucHJldiA9IDAsIHRoaXMubmV4dCA9IDAsIHRoaXMuc2VudCA9IHRoaXMuX3NlbnQgPSB1bmRlZmluZWQsIHRoaXMuZG9uZSA9ICExLCB0aGlzLmRlbGVnYXRlID0gbnVsbCwgdGhpcy5tZXRob2QgPSBcIm5leHRcIiwgdGhpcy5hcmcgPSB1bmRlZmluZWQsIHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKHJlc2V0VHJ5RW50cnkpLCAhc2tpcFRlbXBSZXNldCkgZm9yICh2YXIgbmFtZSBpbiB0aGlzKSBcInRcIiA9PT0gbmFtZS5jaGFyQXQoMCkgJiYgaGFzT3duLmNhbGwodGhpcywgbmFtZSkgJiYgIWlzTmFOKCtuYW1lLnNsaWNlKDEpKSAmJiAodGhpc1tuYW1lXSA9IHVuZGVmaW5lZCk7XG4gICAgfSxcbiAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmRvbmUgPSAhMDtcbiAgICAgIHZhciByb290UmVjb3JkID0gdGhpcy50cnlFbnRyaWVzWzBdLmNvbXBsZXRpb247XG4gICAgICBpZiAoXCJ0aHJvd1wiID09PSByb290UmVjb3JkLnR5cGUpIHRocm93IHJvb3RSZWNvcmQuYXJnO1xuICAgICAgcmV0dXJuIHRoaXMucnZhbDtcbiAgICB9LFxuICAgIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbiAoZXhjZXB0aW9uKSB7XG4gICAgICBpZiAodGhpcy5kb25lKSB0aHJvdyBleGNlcHRpb247XG4gICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG5cbiAgICAgIGZ1bmN0aW9uIGhhbmRsZShsb2MsIGNhdWdodCkge1xuICAgICAgICByZXR1cm4gcmVjb3JkLnR5cGUgPSBcInRocm93XCIsIHJlY29yZC5hcmcgPSBleGNlcHRpb24sIGNvbnRleHQubmV4dCA9IGxvYywgY2F1Z2h0ICYmIChjb250ZXh0Lm1ldGhvZCA9IFwibmV4dFwiLCBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZCksICEhY2F1Z2h0O1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXSxcbiAgICAgICAgICAgIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG4gICAgICAgIGlmIChcInJvb3RcIiA9PT0gZW50cnkudHJ5TG9jKSByZXR1cm4gaGFuZGxlKFwiZW5kXCIpO1xuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2KSB7XG4gICAgICAgICAgdmFyIGhhc0NhdGNoID0gaGFzT3duLmNhbGwoZW50cnksIFwiY2F0Y2hMb2NcIiksXG4gICAgICAgICAgICAgIGhhc0ZpbmFsbHkgPSBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpO1xuXG4gICAgICAgICAgaWYgKGhhc0NhdGNoICYmIGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgITApO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNDYXRjaCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCAhMCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICghaGFzRmluYWxseSkgdGhyb3cgbmV3IEVycm9yKFwidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHlcIik7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGFicnVwdDogZnVuY3Rpb24gKHR5cGUsIGFyZykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYgJiYgaGFzT3duLmNhbGwoZW50cnksIFwiZmluYWxseUxvY1wiKSAmJiB0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgdmFyIGZpbmFsbHlFbnRyeSA9IGVudHJ5O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZpbmFsbHlFbnRyeSAmJiAoXCJicmVha1wiID09PSB0eXBlIHx8IFwiY29udGludWVcIiA9PT0gdHlwZSkgJiYgZmluYWxseUVudHJ5LnRyeUxvYyA8PSBhcmcgJiYgYXJnIDw9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jICYmIChmaW5hbGx5RW50cnkgPSBudWxsKTtcbiAgICAgIHZhciByZWNvcmQgPSBmaW5hbGx5RW50cnkgPyBmaW5hbGx5RW50cnkuY29tcGxldGlvbiA6IHt9O1xuICAgICAgcmV0dXJuIHJlY29yZC50eXBlID0gdHlwZSwgcmVjb3JkLmFyZyA9IGFyZywgZmluYWxseUVudHJ5ID8gKHRoaXMubWV0aG9kID0gXCJuZXh0XCIsIHRoaXMubmV4dCA9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jLCBDb250aW51ZVNlbnRpbmVsKSA6IHRoaXMuY29tcGxldGUocmVjb3JkKTtcbiAgICB9LFxuICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAocmVjb3JkLCBhZnRlckxvYykge1xuICAgICAgaWYgKFwidGhyb3dcIiA9PT0gcmVjb3JkLnR5cGUpIHRocm93IHJlY29yZC5hcmc7XG4gICAgICByZXR1cm4gXCJicmVha1wiID09PSByZWNvcmQudHlwZSB8fCBcImNvbnRpbnVlXCIgPT09IHJlY29yZC50eXBlID8gdGhpcy5uZXh0ID0gcmVjb3JkLmFyZyA6IFwicmV0dXJuXCIgPT09IHJlY29yZC50eXBlID8gKHRoaXMucnZhbCA9IHRoaXMuYXJnID0gcmVjb3JkLmFyZywgdGhpcy5tZXRob2QgPSBcInJldHVyblwiLCB0aGlzLm5leHQgPSBcImVuZFwiKSA6IFwibm9ybWFsXCIgPT09IHJlY29yZC50eXBlICYmIGFmdGVyTG9jICYmICh0aGlzLm5leHQgPSBhZnRlckxvYyksIENvbnRpbnVlU2VudGluZWw7XG4gICAgfSxcbiAgICBmaW5pc2g6IGZ1bmN0aW9uIChmaW5hbGx5TG9jKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LmZpbmFsbHlMb2MgPT09IGZpbmFsbHlMb2MpIHJldHVybiB0aGlzLmNvbXBsZXRlKGVudHJ5LmNvbXBsZXRpb24sIGVudHJ5LmFmdGVyTG9jKSwgcmVzZXRUcnlFbnRyeShlbnRyeSksIENvbnRpbnVlU2VudGluZWw7XG4gICAgICB9XG4gICAgfSxcbiAgICBjYXRjaDogZnVuY3Rpb24gKHRyeUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG5cbiAgICAgICAgICBpZiAoXCJ0aHJvd1wiID09PSByZWNvcmQudHlwZSkge1xuICAgICAgICAgICAgdmFyIHRocm93biA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgICByZXNldFRyeUVudHJ5KGVudHJ5KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gdGhyb3duO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdFwiKTtcbiAgICB9LFxuICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uIChpdGVyYWJsZSwgcmVzdWx0TmFtZSwgbmV4dExvYykge1xuICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUgPSB7XG4gICAgICAgIGl0ZXJhdG9yOiB2YWx1ZXMoaXRlcmFibGUpLFxuICAgICAgICByZXN1bHROYW1lOiByZXN1bHROYW1lLFxuICAgICAgICBuZXh0TG9jOiBuZXh0TG9jXG4gICAgICB9LCBcIm5leHRcIiA9PT0gdGhpcy5tZXRob2QgJiYgKHRoaXMuYXJnID0gdW5kZWZpbmVkKSwgQ29udGludWVTZW50aW5lbDtcbiAgICB9XG4gIH0sIGV4cG9ydHM7XG59XG5cbmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHtcbiAgdHJ5IHtcbiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7XG4gICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZWplY3QoZXJyb3IpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChpbmZvLmRvbmUpIHtcbiAgICByZXNvbHZlKHZhbHVlKTtcbiAgfSBlbHNlIHtcbiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTtcblxuICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHtcbiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBcIm5leHRcIiwgdmFsdWUpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7XG4gICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgXCJ0aHJvd1wiLCBlcnIpO1xuICAgICAgfVxuXG4gICAgICBfbmV4dCh1bmRlZmluZWQpO1xuICAgIH0pO1xuICB9O1xufVxuXG5mdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTtcbiAgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7XG5cbiAgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTtcbn1cblxuZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHtcbiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mLmJpbmQoKSA6IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7XG4gICAgby5fX3Byb3RvX18gPSBwO1xuICAgIHJldHVybiBvO1xuICB9O1xuICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApO1xufVxuXG5mdW5jdGlvbiBfb2JqZWN0RGVzdHJ1Y3R1cmluZ0VtcHR5KG9iaikge1xuICBpZiAob2JqID09IG51bGwpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgZGVzdHJ1Y3R1cmUgdW5kZWZpbmVkXCIpO1xufVxuXG5mdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7XG4gIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICB2YXIgdGFyZ2V0ID0ge307XG4gIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcbiAgdmFyIGtleSwgaTtcblxuICBmb3IgKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGtleSA9IHNvdXJjZUtleXNbaV07XG4gICAgaWYgKGV4Y2x1ZGVkLmluZGV4T2Yoa2V5KSA+PSAwKSBjb250aW51ZTtcbiAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICB9XG5cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikge1xuICBpZiAoIW8pIHJldHVybjtcbiAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTtcbiAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xuICBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lO1xuICBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTtcbiAgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xufVxuXG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikge1xuICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDtcblxuICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIGFycjJbaV0gPSBhcnJbaV07XG5cbiAgcmV0dXJuIGFycjI7XG59XG5cbmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2UobywgYWxsb3dBcnJheUxpa2UpIHtcbiAgdmFyIGl0ID0gdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0gfHwgb1tcIkBAaXRlcmF0b3JcIl07XG4gIGlmIChpdCkgcmV0dXJuIChpdCA9IGl0LmNhbGwobykpLm5leHQuYmluZChpdCk7XG5cbiAgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgIGlmIChpdCkgbyA9IGl0O1xuICAgIHZhciBpID0gMDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGkgPj0gby5sZW5ndGgpIHJldHVybiB7XG4gICAgICAgIGRvbmU6IHRydWVcbiAgICAgIH07XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkb25lOiBmYWxzZSxcbiAgICAgICAgdmFsdWU6IG9baSsrXVxuICAgICAgfTtcbiAgICB9O1xuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBpdGVyYXRlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xufVxuXG52YXIgQmxvY2tmcm9zdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEJsb2NrZnJvc3QoKSB7fVxuXG4gIHZhciBfcHJvdG8gPSBCbG9ja2Zyb3N0LnByb3RvdHlwZTtcblxuICBfcHJvdG8uaW5pdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9pbml0ID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShfcmVmKSB7XG4gICAgICB2YXIgYmxvY2tmcm9zdEFwaUtleSwgbmV0d29yaywgbmV0d29ya0VuZHBvaW50O1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBibG9ja2Zyb3N0QXBpS2V5ID0gX3JlZi5ibG9ja2Zyb3N0QXBpS2V5LCBuZXR3b3JrID0gX3JlZi5uZXR3b3JrO1xuICAgICAgICAgICAgICBuZXR3b3JrRW5kcG9pbnQgPSBuZXR3b3JrID09IDAgPyAnaHR0cHM6Ly9jYXJkYW5vLXRlc3RuZXQuYmxvY2tmcm9zdC5pby9hcGkvdjAnIDogJ2h0dHBzOi8vY2FyZGFuby1tYWlubmV0LmJsb2NrZnJvc3QuaW8vYXBpL3YwJztcbiAgICAgICAgICAgICAgdGhpcy5faW5zdGFuY2UgPSBheGlvcy5jcmVhdGUoe1xuICAgICAgICAgICAgICAgIGJhc2VVUkw6IG5ldHdvcmtFbmRwb2ludCxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICBwcm9qZWN0X2lkOiBibG9ja2Zyb3N0QXBpS2V5XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gaW5pdChfeCkge1xuICAgICAgcmV0dXJuIF9pbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGluaXQ7XG4gIH0oKTtcblxuICBfcHJvdG8uaXNMb2FkZWQgPSBmdW5jdGlvbiBpc0xvYWRlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5zdGFuY2UgIT09IHVuZGVmaW5lZDtcbiAgfTtcblxuICBfcHJvdG8uX3JlcXVlc3QgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfcmVxdWVzdDIgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMihfcmVmMikge1xuICAgICAgdmFyIF9yZWYyJGVuZHBvaW50LCBlbmRwb2ludCwgX3JlZjIkYm9keSwgYm9keSwgX3JlZjIkbWV0aG9kLCBtZXRob2Q7XG5cbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9yZWYyJGVuZHBvaW50ID0gX3JlZjIuZW5kcG9pbnQsIGVuZHBvaW50ID0gX3JlZjIkZW5kcG9pbnQgPT09IHZvaWQgMCA/ICcnIDogX3JlZjIkZW5kcG9pbnQsIF9yZWYyJGJvZHkgPSBfcmVmMi5ib2R5LCBib2R5ID0gX3JlZjIkYm9keSA9PT0gdm9pZCAwID8gbnVsbCA6IF9yZWYyJGJvZHksIF9yZWYyJG1ldGhvZCA9IF9yZWYyLm1ldGhvZCwgbWV0aG9kID0gX3JlZjIkbWV0aG9kID09PSB2b2lkIDAgPyAnR0VUJyA6IF9yZWYyJG1ldGhvZDtcblxuICAgICAgICAgICAgICBpZiAoIShtZXRob2QgPT0gJ0dFVCcpKSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faW5zdGFuY2UuZ2V0KFwiXCIgKyBlbmRwb2ludCkudGhlbihmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IF9yZWYzLmRhdGE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIF9jb250ZXh0Mi5zZW50KTtcblxuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICBpZiAoIShtZXRob2QgPT0gJ1BPU1QnKSkge1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gOTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2luc3RhbmNlLnBvc3QoXCJcIiArIGVuZHBvaW50LCBib2R5KS50aGVuKGZ1bmN0aW9uIChfcmVmNCkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gX3JlZjQuZGF0YTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgX2NvbnRleHQyLnNlbnQpO1xuXG4gICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIF9yZXF1ZXN0KF94Mikge1xuICAgICAgcmV0dXJuIF9yZXF1ZXN0Mi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBfcmVxdWVzdDtcbiAgfSgpO1xuXG4gIF9wcm90by5hZGRyZXNzZXNBZGRyZXNzVXR4b3MgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfYWRkcmVzc2VzQWRkcmVzc1V0eG9zID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoX3JlZjUpIHtcbiAgICAgIHZhciBhZGRyZXNzLCBfcmVmNSRwYWdlLCBwYWdlLCBfcmVmNSRsaW1pdCwgbGltaXQ7XG5cbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIGFkZHJlc3MgPSBfcmVmNS5hZGRyZXNzLCBfcmVmNSRwYWdlID0gX3JlZjUucGFnZSwgcGFnZSA9IF9yZWY1JHBhZ2UgPT09IHZvaWQgMCA/IDEgOiBfcmVmNSRwYWdlLCBfcmVmNSRsaW1pdCA9IF9yZWY1LmxpbWl0LCBsaW1pdCA9IF9yZWY1JGxpbWl0ID09PSB2b2lkIDAgPyAxMDAgOiBfcmVmNSRsaW1pdDtcbiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgZW5kcG9pbnQ6IFwiL2FkZHJlc3Nlcy9cIiArIGFkZHJlc3MgKyBcIi91dHhvcz9wYWdlPVwiICsgcGFnZSArIFwiJmNvdW50PVwiICsgbGltaXRcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoXCJyZXR1cm5cIiwgX2NvbnRleHQzLnNlbnQpO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGFkZHJlc3Nlc0FkZHJlc3NVdHhvcyhfeDMpIHtcbiAgICAgIHJldHVybiBfYWRkcmVzc2VzQWRkcmVzc1V0eG9zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFkZHJlc3Nlc0FkZHJlc3NVdHhvcztcbiAgfSgpO1xuXG4gIF9wcm90by5hZGRyZXNzZXNBZGRyZXNzVXR4b3NBc3NldCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9hZGRyZXNzZXNBZGRyZXNzVXR4b3NBc3NldCA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KF9yZWY2KSB7XG4gICAgICB2YXIgYWRkcmVzcywgYXNzZXQ7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBhZGRyZXNzID0gX3JlZjYuYWRkcmVzcywgYXNzZXQgPSBfcmVmNi5hc3NldDtcbiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgZW5kcG9pbnQ6IFwiL2FkZHJlc3Nlcy9cIiArIGFkZHJlc3MgKyBcIi91dHhvcy9cIiArIGFzc2V0XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KFwicmV0dXJuXCIsIF9jb250ZXh0NC5zZW50KTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBhZGRyZXNzZXNBZGRyZXNzVXR4b3NBc3NldChfeDQpIHtcbiAgICAgIHJldHVybiBfYWRkcmVzc2VzQWRkcmVzc1V0eG9zQXNzZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWRkcmVzc2VzQWRkcmVzc1V0eG9zQXNzZXQ7XG4gIH0oKVxuICAvKipcclxuICAgKiBJbmZvcm1hdGlvbiBhYm91dCBhIHNwZWNpZmljIGFzc2V0XHJcbiAgICogQHBhcmFtIGFzc2V0IENvbmNhdGVuYXRpb24gb2YgdGhlIHBvbGljeV9pZCBhbmQgaGV4LWVuY29kZWQgYXNzZXRfbmFtZVxyXG4gICAqIEByZXR1cm5zIGFzc2V0XHJcbiAgICovXG4gIDtcblxuICBfcHJvdG8uYXNzZXRTcGVjaWZpY0Fzc2V0ID1cbiAgLyojX19QVVJFX18qL1xuICBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9hc3NldFNwZWNpZmljQXNzZXQgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNShfcmVmNykge1xuICAgICAgdmFyIGFzc2V0O1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgYXNzZXQgPSBfcmVmNy5hc3NldDtcbiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgZW5kcG9pbnQ6IFwiL2Fzc2V0cy9cIiArIGFzc2V0XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KFwicmV0dXJuXCIsIF9jb250ZXh0NS5zZW50KTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU1LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBhc3NldFNwZWNpZmljQXNzZXQoX3g1KSB7XG4gICAgICByZXR1cm4gX2Fzc2V0U3BlY2lmaWNBc3NldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBhc3NldFNwZWNpZmljQXNzZXQ7XG4gIH0oKVxuICAvKipcclxuICAgKiBSZXR1cm4gdGhlIHRyYW5zYWN0aW9ucyB3aXRoaW4gdGhlIGxhdGVzdCBibG9jay5cclxuICAgKiBAcmV0dXJuc1xyXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLmJsb2NrTGF0ZXN0QmxvY2sgPVxuICAvKiNfX1BVUkVfXyovXG4gIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX2Jsb2NrTGF0ZXN0QmxvY2sgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHtcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3Qoe1xuICAgICAgICAgICAgICAgIGVuZHBvaW50OiAnL2Jsb2Nrcy9sYXRlc3QnXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KFwicmV0dXJuXCIsIF9jb250ZXh0Ni5zZW50KTtcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU2LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBibG9ja0xhdGVzdEJsb2NrKCkge1xuICAgICAgcmV0dXJuIF9ibG9ja0xhdGVzdEJsb2NrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJsb2NrTGF0ZXN0QmxvY2s7XG4gIH0oKVxuICAvKipcclxuICAgKiBSZXR1cm4gdGhlIHByb3RvY29sIHBhcmFtZXRlcnMgZm9yIHRoZSBsYXRlc3QgZXBvY2guXHJcbiAgICogQHJldHVybnNcclxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5lcG9jaHNMYXRlc3RFcG9jaFByb3RvY29sUGFyYW1ldGVycyA9XG4gIC8qI19fUFVSRV9fKi9cbiAgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZXBvY2hzTGF0ZXN0RXBvY2hQcm90b2NvbFBhcmFtZXRlcnMgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHtcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3Qoe1xuICAgICAgICAgICAgICAgIGVuZHBvaW50OiAnL2Vwb2Nocy9sYXRlc3QvcGFyYW1ldGVycydcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoXCJyZXR1cm5cIiwgX2NvbnRleHQ3LnNlbnQpO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTcsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGVwb2Noc0xhdGVzdEVwb2NoUHJvdG9jb2xQYXJhbWV0ZXJzKCkge1xuICAgICAgcmV0dXJuIF9lcG9jaHNMYXRlc3RFcG9jaFByb3RvY29sUGFyYW1ldGVycy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBlcG9jaHNMYXRlc3RFcG9jaFByb3RvY29sUGFyYW1ldGVycztcbiAgfSgpO1xuXG4gIF9wcm90by50cmFuc2FjdGlvbnNTcGVjaWZpY1RyYW5zYWN0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX3RyYW5zYWN0aW9uc1NwZWNpZmljVHJhbnNhY3Rpb24gPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOChfcmVmOCkge1xuICAgICAgdmFyIGhhc2g7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBoYXNoID0gX3JlZjguaGFzaDtcbiAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAzO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgZW5kcG9pbnQ6IFwiL3R4cy9cIiArIGhhc2hcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoXCJyZXR1cm5cIiwgX2NvbnRleHQ4LnNlbnQpO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTgsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIHRyYW5zYWN0aW9uc1NwZWNpZmljVHJhbnNhY3Rpb24oX3g2KSB7XG4gICAgICByZXR1cm4gX3RyYW5zYWN0aW9uc1NwZWNpZmljVHJhbnNhY3Rpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJhbnNhY3Rpb25zU3BlY2lmaWNUcmFuc2FjdGlvbjtcbiAgfSgpO1xuXG4gIF9wcm90by50cmFuc2FjdGlvbnNUcmFuc2FjdGlvblVUWE9zID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX3RyYW5zYWN0aW9uc1RyYW5zYWN0aW9uVVRYT3MgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOShfcmVmOSkge1xuICAgICAgdmFyIGhhc2g7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBoYXNoID0gX3JlZjkuaGFzaDtcbiAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAzO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgZW5kcG9pbnQ6IFwiL3R4cy9cIiArIGhhc2ggKyBcIi91dHhvc1wiXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KFwicmV0dXJuXCIsIF9jb250ZXh0OS5zZW50KTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU5LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiB0cmFuc2FjdGlvbnNUcmFuc2FjdGlvblVUWE9zKF94Nykge1xuICAgICAgcmV0dXJuIF90cmFuc2FjdGlvbnNUcmFuc2FjdGlvblVUWE9zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRyYW5zYWN0aW9uc1RyYW5zYWN0aW9uVVRYT3M7XG4gIH0oKTtcblxuICByZXR1cm4gQmxvY2tmcm9zdDtcbn0oKTtcblxudmFyIF9leGNsdWRlZCA9IFtcImRlZmF1bHRcIl07XG5cbnZhciBpbXBvcnRDU0wgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgX3JlZiA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgaWYgKCEodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7XG4gICAgICAgICAgICByZXR1cm4gaW1wb3J0KCdAZW11cmdvL2NhcmRhbm8tc2VyaWFsaXphdGlvbi1saWItYnJvd3NlcicpO1xuXG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBfY29udGV4dC5zZW50KTtcblxuICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4O1xuICAgICAgICAgICAgcmV0dXJuIGltcG9ydCgnQGVtdXJnby9jYXJkYW5vLXNlcmlhbGl6YXRpb24tbGliLW5vZGVqcycpO1xuXG4gICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBfY29udGV4dC5zZW50KTtcblxuICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZSk7XG4gIH0pKTtcblxuICByZXR1cm4gZnVuY3Rpb24gaW1wb3J0Q1NMKCkge1xuICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG59KCk7XG5cbnZhciByZXNvbHZlSW1wb3J0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIF9yZWYyID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7XG4gICAgdmFyIF95aWVsZCRpbXBvcnRDU0wsIHJlc3Q7XG5cbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAwO1xuICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzO1xuICAgICAgICAgICAgcmV0dXJuIGltcG9ydENTTCgpO1xuXG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgX3lpZWxkJGltcG9ydENTTCA9IF9jb250ZXh0Mi5zZW50O1xuICAgICAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF95aWVsZCRpbXBvcnRDU0wsIF9leGNsdWRlZCk7XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCByZXN0KTtcblxuICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gOTtcbiAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MltcImNhdGNoXCJdKDApO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiBpbXBvcnRpbmcgdGhlIENhcmRhbm8gU2VyaWFsaXphdGlvbiBMaWIgbW9kdWxlLicpO1xuICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQyLnQwO1xuXG4gICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUyLCBudWxsLCBbWzAsIDldXSk7XG4gIH0pKTtcblxuICByZXR1cm4gZnVuY3Rpb24gcmVzb2x2ZUltcG9ydCgpIHtcbiAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcbn0oKTtcblxudmFyIGNzbCA9IGF3YWl0IC8qI19fUFVSRV9fKi9yZXNvbHZlSW1wb3J0KCk7XG5cbnZhciBmcm9tSGV4ID0gZnVuY3Rpb24gZnJvbUhleChoZXgpIHtcbiAgcmV0dXJuIEJ1ZmZlci5mcm9tKGhleCwgJ2hleCcpO1xufTtcbnZhciB0b0hleCA9IGZ1bmN0aW9uIHRvSGV4KGJ5dGVzKSB7XG4gIHJldHVybiBCdWZmZXIuZnJvbShieXRlcykudG9TdHJpbmcoJ2hleCcpO1xufTtcbnZhciB0b0xvdmVsYWNlID0gZnVuY3Rpb24gdG9Mb3ZlbGFjZShhZGEpIHtcbiAgcmV0dXJuIGFkYSAqIDEwMDAwMDA7XG59O1xudmFyIGZyb21GbG9hdCA9IGZ1bmN0aW9uIGZyb21GbG9hdChfZmxvYXQpIHtcbiAgdmFyIHBhcnRzID0gX2Zsb2F0LnNwbGl0KCcuJyk7XG5cbiAgdmFyIG51bWVyYXRvciA9IFwiXCIgKyBwYXJzZUludChwYXJ0c1sxXSwgMTApO1xuICB2YXIgZGVub21pbmF0b3IgPSAnMScgKyAnMCcucmVwZWF0KHBhcnRzWzFdLmxlbmd0aCk7XG4gIHJldHVybiB7XG4gICAgbnVtZXJhdG9yOiBudW1lcmF0b3IsXG4gICAgZGVub21pbmF0b3I6IGRlbm9taW5hdG9yXG4gIH07XG59O1xudmFyIEhleFRvQXNjaWkgPSBmdW5jdGlvbiBIZXhUb0FzY2lpKHN0cmluZykge1xuICByZXR1cm4gZnJvbUhleChzdHJpbmcpLnRvU3RyaW5nKCdhc2NpaScpO1xufTtcbnZhciBhc3NldHNUb1ZhbHVlID0gZnVuY3Rpb24gYXNzZXRzVG9WYWx1ZShhc3NldHMpIHtcbiAgdmFyIG11bHRpQXNzZXQgPSBjc2wuTXVsdGlBc3NldFtcIm5ld1wiXSgpO1xuICB2YXIgbG92ZWxhY2UgPSBhc3NldHNbJ2xvdmVsYWNlJ107XG4gIHZhciB1bml0cyA9IE9iamVjdC5rZXlzKGFzc2V0cyk7XG4gIHZhciBwb2xpY2llcyA9IEFycmF5LmZyb20obmV3IFNldCh1bml0cy5maWx0ZXIoZnVuY3Rpb24gKHVuaXQpIHtcbiAgICByZXR1cm4gdW5pdCAhPT0gJ2xvdmVsYWNlJztcbiAgfSkubWFwKGZ1bmN0aW9uICh1bml0KSB7XG4gICAgcmV0dXJuIHVuaXQuc2xpY2UoMCwgNTYpO1xuICB9KSkpO1xuICBwb2xpY2llcy5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICB2YXIgcG9saWN5VW5pdHMgPSB1bml0cy5maWx0ZXIoZnVuY3Rpb24gKHVuaXQpIHtcbiAgICAgIHJldHVybiB1bml0LnNsaWNlKDAsIDU2KSA9PT0gcG9saWN5O1xuICAgIH0pO1xuICAgIHZhciBhc3NldHNWYWx1ZSA9IGNzbC5Bc3NldHNbXCJuZXdcIl0oKTtcbiAgICBwb2xpY3lVbml0cy5mb3JFYWNoKGZ1bmN0aW9uICh1bml0KSB7XG4gICAgICBhc3NldHNWYWx1ZS5pbnNlcnQoY3NsLkFzc2V0TmFtZVtcIm5ld1wiXShmcm9tSGV4KHVuaXQuc2xpY2UoNTYpKSksIGNzbC5CaWdOdW0uZnJvbV9zdHIoYXNzZXRzW3VuaXRdLnRvU3RyaW5nKCkpKTtcbiAgICB9KTtcbiAgICBtdWx0aUFzc2V0Lmluc2VydChjc2wuU2NyaXB0SGFzaC5mcm9tX2J5dGVzKGZyb21IZXgocG9saWN5KSksIGFzc2V0c1ZhbHVlKTtcbiAgfSk7XG4gIHZhciB2YWx1ZSA9IGNzbC5WYWx1ZVtcIm5ld1wiXShjc2wuQmlnTnVtLmZyb21fc3RyKGxvdmVsYWNlID8gbG92ZWxhY2UudG9TdHJpbmcoKSA6ICcwJykpO1xuICBpZiAodW5pdHMubGVuZ3RoID4gMSB8fCAhbG92ZWxhY2UpIHZhbHVlLnNldF9tdWx0aWFzc2V0KG11bHRpQXNzZXQpO1xuICByZXR1cm4gdmFsdWU7XG59O1xudmFyIFN0cmluZ1RvQWRkcmVzcyA9IGZ1bmN0aW9uIFN0cmluZ1RvQWRkcmVzcyhzdHJpbmcpIHtcbiAgcmV0dXJuIGNzbC5BZGRyZXNzLmZyb21fYmVjaDMyKHN0cmluZyk7XG59O1xudmFyIHZhbHVlVG9Bc3NldHMgPSBmdW5jdGlvbiB2YWx1ZVRvQXNzZXRzKHZhbHVlKSB7XG4gIHZhciBhc3NldHMgPSBbXTtcbiAgYXNzZXRzLnB1c2goe1xuICAgIHVuaXQ6ICdsb3ZlbGFjZScsXG4gICAgcXVhbnRpdHk6IHZhbHVlLmNvaW4oKS50b19zdHIoKVxuICB9KTtcblxuICBpZiAodmFsdWUubXVsdGlhc3NldCgpKSB7XG4gICAgdmFyIG11bHRpQXNzZXRzID0gdmFsdWUubXVsdGlhc3NldCgpLmtleXMoKTtcblxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXVsdGlBc3NldHMubGVuKCk7IGorKykge1xuICAgICAgdmFyIHBvbGljeSA9IG11bHRpQXNzZXRzLmdldChqKTtcbiAgICAgIHZhciBwb2xpY3lBc3NldHMgPSB2YWx1ZS5tdWx0aWFzc2V0KCkuZ2V0KHBvbGljeSk7XG4gICAgICB2YXIgYXNzZXROYW1lcyA9IHBvbGljeUFzc2V0cy5rZXlzKCk7XG5cbiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgYXNzZXROYW1lcy5sZW4oKTsgaysrKSB7XG4gICAgICAgIHZhciBwb2xpY3lBc3NldCA9IGFzc2V0TmFtZXMuZ2V0KGspO1xuICAgICAgICB2YXIgcXVhbnRpdHkgPSBwb2xpY3lBc3NldHMuZ2V0KHBvbGljeUFzc2V0KTtcbiAgICAgICAgdmFyIGFzc2V0ID0gdG9IZXgocG9saWN5LnRvX2J5dGVzKCkpICsgdG9IZXgocG9saWN5QXNzZXQubmFtZSgpKTtcbiAgICAgICAgYXNzZXRzLnB1c2goe1xuICAgICAgICAgIHVuaXQ6IGFzc2V0LFxuICAgICAgICAgIHF1YW50aXR5OiBxdWFudGl0eS50b19zdHIoKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gYXNzZXRzO1xufTtcbnZhciBnZXRBZGRyZXNzS2V5SGFzaEhleCA9IGZ1bmN0aW9uIGdldEFkZHJlc3NLZXlIYXNoSGV4KGFkZHJlc3MpIHtcbiAgdmFyIF9jc2wkQmFzZUFkZHJlc3MkZnJvbSwgX2NzbCRCYXNlQWRkcmVzcyRmcm9tMjtcblxuICB2YXIgYWRkciA9IChfY3NsJEJhc2VBZGRyZXNzJGZyb20gPSBjc2wuQmFzZUFkZHJlc3MuZnJvbV9hZGRyZXNzKGNzbC5BZGRyZXNzLmZyb21fYmVjaDMyKGFkZHJlc3MpKSkgPT0gbnVsbCA/IHZvaWQgMCA6IChfY3NsJEJhc2VBZGRyZXNzJGZyb20yID0gX2NzbCRCYXNlQWRkcmVzcyRmcm9tLnBheW1lbnRfY3JlZCgpLnRvX2tleWhhc2goKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jc2wkQmFzZUFkZHJlc3MkZnJvbTIudG9fYnl0ZXMoKTtcbiAgaWYgKGFkZHIpIHJldHVybiB0b0hleChhZGRyKTtcbiAgcmV0dXJuIG51bGw7XG59O1xudmFyIGdldEFkZHJlc3NLZXlIYXNoID0gZnVuY3Rpb24gZ2V0QWRkcmVzc0tleUhhc2goYWRkcmVzcykge1xuICB2YXIgX2NzbCRCYXNlQWRkcmVzcyRmcm9tMztcblxuICByZXR1cm4gKF9jc2wkQmFzZUFkZHJlc3MkZnJvbTMgPSBjc2wuQmFzZUFkZHJlc3MuZnJvbV9hZGRyZXNzKGNzbC5BZGRyZXNzLmZyb21fYmVjaDMyKGFkZHJlc3MpKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jc2wkQmFzZUFkZHJlc3MkZnJvbTMucGF5bWVudF9jcmVkKCkudG9fa2V5aGFzaCgpO1xufTtcbnZhciBwbHV0dXNEYXRhVG9IZXggPSBmdW5jdGlvbiBwbHV0dXNEYXRhVG9IZXgoZGF0dW0pIHtcbiAgcmV0dXJuIHRvSGV4KGNzbC5oYXNoX3BsdXR1c19kYXRhKGRhdHVtKS50b19ieXRlcygpKTtcbn07XG5cbnZhciBNSU5fQURBX1JFUVVJUkVEX1dJVEhfQVNTRVRTID0gMjAwMDAwMDtcbnZhciBJUEZTX1BST1ZJREVSID0gJ2h0dHBzOi8vaW5mdXJhLWlwZnMuaW8vaXBmcy8nO1xudmFyIE1ha2VUeEVycm9yID0ge1xuICBOb3RFbm91Z2hMb3ZlbGFjZUlucHV0OiAnTm90IGVub3VnaCBsb3ZlbGFjZSB0byBjb21wbGV0ZSB0aGlzIHRyYW5zYWN0aW9uLicsXG4gIE5vdEVub3VnaEFzc2V0c0lucHV0OiAnTm90IGVub3VnaCBhc3NldHMgaW4gdGhlIGlucHV0cyB0byBjb21wbGV0ZSB0aGlzIHRyYW5zYWN0aW9uLicsXG4gIElucHV0Tm90RXF1YWxPdXRwdXQ6ICdJbnB1dCBub3QgZXF1YWwgdG8gb3V0cHV0JyxcbiAgTG92ZWxhY2VUb29MaXR0bGU6ICdMb3ZlbGFjZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAxMDAwMDAwJyxcbiAgTm9SZWNpcGllbnRzQWRkcmVzczogJ01pc3NpbmcgcmVjaXBpZW50IGFkZHJlc3MnXG59O1xuXG52YXIgY29udmVydE1ldGFkYXRhUHJvcFRvU3RyaW5nID0gZnVuY3Rpb24gY29udmVydE1ldGFkYXRhUHJvcFRvU3RyaW5nKHNyYykge1xuICBpZiAodHlwZW9mIHNyYyA9PT0gJ3N0cmluZycpIHJldHVybiBzcmM7ZWxzZSBpZiAoQXJyYXkuaXNBcnJheShzcmMpKSByZXR1cm4gc3JjLmpvaW4oJycpO1xuICByZXR1cm4gbnVsbDtcbn07XG52YXIgbGlua1RvU3JjID0gZnVuY3Rpb24gbGlua1RvU3JjKGxpbmssIGJhc2U2NCkge1xuICBpZiAoYmFzZTY0ID09PSB2b2lkIDApIHtcbiAgICBiYXNlNjQgPSBmYWxzZTtcbiAgfVxuXG4gIHZhciBiYXNlNjRyZWdleCA9IC9eKFswLTlhLXpBLVorL117NH0pKigoWzAtOWEtekEtWisvXXsyfT09KXwoWzAtOWEtekEtWisvXXszfT0pKT8kLztcbiAgaWYgKGxpbmsuc3RhcnRzV2l0aCgnaHR0cHM6Ly8nKSkgcmV0dXJuIGxpbms7ZWxzZSBpZiAobGluay5zdGFydHNXaXRoKCdpcGZzOi8vJykpIHJldHVybiBcIlwiICsgSVBGU19QUk9WSURFUiArIGxpbmsuc3BsaXQoJ2lwZnM6Ly8nKVsxXS5zcGxpdCgnaXBmcy8nKS5zbGljZSgtMSlbMF07IC8vIElQRlNfUFJPVklERVIgK1xuICAvLyAnLycgK1xuICAvLyBsaW5rLnNwbGl0KCdpcGZzOi8vJylbMV0uc3BsaXQoJ2lwZnMvJykuc2xpY2UoLTEpWzBdXG4gIGVsc2UgaWYgKGxpbmsuc3RhcnRzV2l0aCgnUW0nKSAmJiBsaW5rLmxlbmd0aCA9PT0gNDYgfHwgbGluay5zdGFydHNXaXRoKCdiYWYnKSAmJiBsaW5rLmxlbmd0aCA9PT0gNTkpIHtcbiAgICAvLyByZXR1cm4gSVBGU19QUk9WSURFUiArICcvJyArIGxpbms7XG4gICAgcmV0dXJuIFwiXCIgKyBJUEZTX1BST1ZJREVSICsgbGluaztcbiAgfSBlbHNlIGlmIChiYXNlNjQgJiYgYmFzZTY0cmVnZXgudGVzdChsaW5rKSkgcmV0dXJuICdkYXRhOmltYWdlL3BuZztiYXNlNjQsJyArIGxpbms7ZWxzZSBpZiAobGluay5zdGFydHNXaXRoKCdkYXRhOmltYWdlJykpIHJldHVybiBsaW5rO1xuICByZXR1cm4gbnVsbDtcbn07XG5cbnZhciBXYWxsZXQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBXYWxsZXQoX3JlZikge1xuICAgIHZhciBibG9ja2Zyb3N0ID0gX3JlZi5ibG9ja2Zyb3N0O1xuXG4gICAgdGhpcy5faW5pdCgpO1xuXG4gICAgdGhpcy5fYmxvY2tmcm9zdCA9IGJsb2NrZnJvc3Q7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gV2FsbGV0LnByb3RvdHlwZTtcblxuICBfcHJvdG8uX2luaXQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfaW5pdDIgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkge1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZSk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gX2luaXQoKSB7XG4gICAgICByZXR1cm4gX2luaXQyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIF9pbml0O1xuICB9KCk7XG5cbiAgX3Byb3RvLl9zaG93RGVwcmVjaWF0aW5nID0gZnVuY3Rpb24gX3Nob3dEZXByZWNpYXRpbmcoKSB7XG4gICAgY29uc29sZS5sb2coXCJEZXByZWNpYXRpbmcuXCIpO1xuICB9XG4gIC8qKlxyXG4gICAqIEVuYWJsZSBhbmQgY29ubmVjdCB3YWxsZXRcclxuICAgKlxyXG4gICAqIEBleGFtcGxlXHJcbiAgICogYGBgdHNcclxuICAgKiBsZXQgY29ubmVjdGVkID0gYXdhaXQgTWVzaC5lbmFibGVXYWxsZXQoeyB3YWxsZXROYW1lOiAnY2N2YXVsdCcgfSk7XHJcbiAgICogYGBgXHJcbiAgICpcclxuICAgKiBAcGFyYW0gd2FsbGV0TmFtZSAtIEF2YWlsYWJsZSB3YWxsZXRzIGFyZSBgY2N2YXVsdGAsIGBnZXJvd2FsbGV0YCBhbmQgYG5hbWlgXHJcbiAgICogQHJldHVybnMgLSBUcnVlIGlmIHdhbGxldCBpcyBjb25uZWN0ZWRcclxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5lbmFibGUgPVxuICAvKiNfX1BVUkVfXyovXG4gIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX2VuYWJsZSA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKF9yZWYyKSB7XG4gICAgICB2YXIgd2FsbGV0TmFtZSwgX3dpbmRvdyRjYXJkYW5vLCBfd2luZG93JGNhcmRhbm8kY2N2YXUsIGluc3RhbmNlLCBfd2luZG93JGNhcmRhbm8yLCBfd2luZG93JGNhcmRhbm8yJGdlcm8sIF9pbnN0YW5jZSwgX3dpbmRvdyRjYXJkYW5vMywgX3dpbmRvdyRjYXJkYW5vMyRuYW1pLCBfaW5zdGFuY2UyO1xuXG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICB3YWxsZXROYW1lID0gX3JlZjIud2FsbGV0TmFtZTtcblxuICAgICAgICAgICAgICB0aGlzLl9zaG93RGVwcmVjaWF0aW5nKCk7XG5cbiAgICAgICAgICAgICAgaWYgKCEod2FsbGV0TmFtZSA9PT0gJ2NjdmF1bHQnKSkge1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7XG4gICAgICAgICAgICAgIHJldHVybiAoX3dpbmRvdyRjYXJkYW5vID0gd2luZG93LmNhcmRhbm8pID09IG51bGwgPyB2b2lkIDAgOiAoX3dpbmRvdyRjYXJkYW5vJGNjdmF1ID0gX3dpbmRvdyRjYXJkYW5vLmNjdmF1bHQpID09IG51bGwgPyB2b2lkIDAgOiBfd2luZG93JGNhcmRhbm8kY2N2YXUuZW5hYmxlKCk7XG5cbiAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgaW5zdGFuY2UgPSBfY29udGV4dDIuc2VudDtcblxuICAgICAgICAgICAgICBpZiAoIWluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA5O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGhpcy5fcHJvdmlkZXIgPSBpbnN0YW5jZTtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyNztcbiAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgIGlmICghKHdhbGxldE5hbWUgPT09ICdnZXJvd2FsbGV0JykpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNDtcbiAgICAgICAgICAgICAgcmV0dXJuIChfd2luZG93JGNhcmRhbm8yID0gd2luZG93LmNhcmRhbm8pID09IG51bGwgPyB2b2lkIDAgOiAoX3dpbmRvdyRjYXJkYW5vMiRnZXJvID0gX3dpbmRvdyRjYXJkYW5vMi5nZXJvd2FsbGV0KSA9PSBudWxsID8gdm9pZCAwIDogX3dpbmRvdyRjYXJkYW5vMiRnZXJvLmVuYWJsZSgpO1xuXG4gICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICBfaW5zdGFuY2UgPSBfY29udGV4dDIuc2VudDtcblxuICAgICAgICAgICAgICBpZiAoIV9pbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0aGlzLl9wcm92aWRlciA9IF9pbnN0YW5jZTtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGNhc2UgMTg6XG4gICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjc7XG4gICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgICBpZiAoISh3YWxsZXROYW1lID09PSAnbmFtaScgfHwgd2FsbGV0TmFtZSA9PT0gbnVsbCkpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI3O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyMztcbiAgICAgICAgICAgICAgcmV0dXJuIChfd2luZG93JGNhcmRhbm8zID0gd2luZG93LmNhcmRhbm8pID09IG51bGwgPyB2b2lkIDAgOiAoX3dpbmRvdyRjYXJkYW5vMyRuYW1pID0gX3dpbmRvdyRjYXJkYW5vMy5uYW1pKSA9PSBudWxsID8gdm9pZCAwIDogX3dpbmRvdyRjYXJkYW5vMyRuYW1pLmVuYWJsZSgpO1xuXG4gICAgICAgICAgICBjYXNlIDIzOlxuICAgICAgICAgICAgICBfaW5zdGFuY2UyID0gX2NvbnRleHQyLnNlbnQ7XG5cbiAgICAgICAgICAgICAgaWYgKCFfaW5zdGFuY2UyKSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyNztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHRoaXMuX3Byb3ZpZGVyID0gX2luc3RhbmNlMjtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGNhc2UgMjc6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIGZhbHNlKTtcblxuICAgICAgICAgICAgY2FzZSAyODpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZW5hYmxlKF94KSB7XG4gICAgICByZXR1cm4gX2VuYWJsZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBlbmFibGU7XG4gIH0oKTtcblxuICBfcHJvdG8uaXNFbmFibGVkID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2lzRW5hYmxlZCA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkge1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoXCJyZXR1cm5cIiwgdGhpcy5fcHJvdmlkZXIgIT09IHVuZGVmaW5lZCk7XG5cbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMywgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gaXNFbmFibGVkKCkge1xuICAgICAgcmV0dXJuIF9pc0VuYWJsZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaXNFbmFibGVkO1xuICB9KClcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgbmV0d29yayBpZCBvZiB0aGUgY3VycmVudGx5IGNvbm5lY3RlZCBhY2NvdW50LiAwIGlzIHRlc3RuZXQgYW5kIDEgaXMgbWFpbm5ldCBidXQgb3RoZXIgbmV0d29ya3MgY2FuIHBvc3NpYmx5IGJlIHJldHVybmVkIGJ5IHdhbGxldHMuIFRob3NlIG90aGVyIG5ldHdvcmsgSUQgdmFsdWVzIGFyZSBub3QgZ292ZXJuZWQgYnkgdGhpcyBkb2N1bWVudC5cclxuICAgKiBAcmV0dXJucyAwIGlzIHRlc3RuZXQgYW5kIDEgaXMgbWFpbm5ldFxyXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLmdldE5ldHdvcmtJZCA9XG4gIC8qI19fUFVSRV9fKi9cbiAgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0TmV0d29ya0lkID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDI7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcm92aWRlci5nZXROZXR3b3JrSWQoKTtcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdChcInJldHVyblwiLCBfY29udGV4dDQuc2VudCk7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlNCwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZ2V0TmV0d29ya0lkKCkge1xuICAgICAgcmV0dXJuIF9nZXROZXR3b3JrSWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0TmV0d29ya0lkO1xuICB9KClcbiAgLyoqXHJcbiAgICogcmV0dXJuIGEgbGlzdCBvZiBhbGwgVVRYT3MgKHVuc3BlbnQgdHJhbnNhY3Rpb24gb3V0cHV0cykgY29udHJvbGxlZCBieSB0aGUgd2FsbGV0XHJcbiAgICogQHJldHVybnMgbGlzdCBvZiBhbGwgVVRYT3NcclxuICAgKi9cbiAgLy8gYXN5bmMgZ2V0VXR4b3Mob3B0aW9ucz86IHsgcmV0dXJuQXNzZXRzPzogYm9vbGVhbiB9KTogUHJvbWlzZTxhbnk+IHtcbiAgLy8gICBsZXQgdXR4b3MgPSBhd2FpdCB0aGlzLl9wcm92aWRlci5nZXRVdHhvcygpO1xuICAvLyAgIGlmIChvcHRpb25zPy5yZXR1cm5Bc3NldHMgJiYgb3B0aW9ucy5yZXR1cm5Bc3NldHMpIHtcbiAgLy8gICAgIGlmICh1dHhvcyA9PT0gdW5kZWZpbmVkKSB7XG4gIC8vICAgICAgIHRocm93ICdObyB1dHhvcyc7XG4gIC8vICAgICB9XG4gIC8vICAgICBsZXQgdXR4b3NBc3NldHM6IHt9W10gPSBbXTtcbiAgLy8gICAgIC8vIFRPRE8sIGxldHMgZ2V0IFVUWE9zIGxpa2UgdGhpcyBhcyBkZWZhdWx0IGh0dHBzOi8vZG9jcy5ibG9ja2Zyb3N0LmlvLyN0YWcvQ2FyZGFuby1BZGRyZXNzZXMvcGF0aHMvfjFhZGRyZXNzZXN+MXthZGRyZXNzfX4xdXR4b3MvZ2V0XG4gIC8vICAgICB1dHhvcy5tYXAoKHUpID0+IHtcbiAgLy8gICAgICAgbGV0IHRoaXNVdHhvOiB7XG4gIC8vICAgICAgICAgY2Jvcjogc3RyaW5nOyAvLyBUT0RPIG5hbWUgYGNib3JgIG9rP1xuICAvLyAgICAgICAgIGFzc2V0czogeyBbYXNzZXRJZDogc3RyaW5nXTogbnVtYmVyIH07XG4gIC8vICAgICAgICAgcGF5bWVudEFkZHI6IHN0cmluZztcbiAgLy8gICAgICAgICB0eEhhc2g6IHN0cmluZzsgLy8gVE9ETyB0byBnZXQ/XG4gIC8vICAgICAgICAgb3V0cHV0SW5kZXg6IG51bWJlcjsgLy8gVE9ETyB0byBnZXQ/XG4gIC8vICAgICAgICAgZGF0YUhhc2g/O1xuICAvLyAgICAgICB9ID0ge1xuICAvLyAgICAgICAgIGNib3I6IHUsXG4gIC8vICAgICAgICAgYXNzZXRzOiB7fSxcbiAgLy8gICAgICAgICBwYXltZW50QWRkcjogJycsXG4gIC8vICAgICAgICAgdHhIYXNoOiAnJyxcbiAgLy8gICAgICAgICBvdXRwdXRJbmRleDogMCxcbiAgLy8gICAgICAgfTtcbiAgLy8gICAgICAgY29uc3QgdXR4byA9IGNzbC5UcmFuc2FjdGlvblVuc3BlbnRPdXRwdXQuZnJvbV9ieXRlcyhcbiAgLy8gICAgICAgICBCdWZmZXIuZnJvbSh1LCAnaGV4JylcbiAgLy8gICAgICAgKTtcbiAgLy8gICAgICAgdGhpc1V0eG8ucGF5bWVudEFkZHIgPSB1dHhvLm91dHB1dCgpLmFkZHJlc3MoKS50b19iZWNoMzIoKTtcbiAgLy8gICAgICAgdmFsdWVUb0Fzc2V0cyh1dHhvLm91dHB1dCgpLmFtb3VudCgpKS5mb3JFYWNoKChubm4pID0+IHtcbiAgLy8gICAgICAgICBjb25zdCB1bml0ID0gbm5uLnVuaXQ7XG4gIC8vICAgICAgICAgY29uc3QgX3BvbGljeSA9IHVuaXQuc2xpY2UoMCwgNTYpO1xuICAvLyAgICAgICAgIGNvbnN0IF9uYW1lID0gSGV4VG9Bc2NpaSh1bml0LnNsaWNlKDU2KSk7XG4gIC8vICAgICAgICAgY29uc3QgYXNzZXRJZCA9XG4gIC8vICAgICAgICAgICBfcG9saWN5ID09ICdsb3ZlbGFjZScgPyAnbG92ZWxhY2UnIDogYCR7X3BvbGljeX0uJHtfbmFtZX1gO1xuICAvLyAgICAgICAgIHRoaXNVdHhvLmFzc2V0c1thc3NldElkXSA9IHBhcnNlSW50KG5ubi5xdWFudGl0eSk7XG4gIC8vICAgICAgIH0pO1xuICAvLyAgICAgICB1dHhvc0Fzc2V0cy5wdXNoKHRoaXNVdHhvKTtcbiAgLy8gICAgIH0pO1xuICAvLyAgICAgcmV0dXJuIHV0eG9zQXNzZXRzO1xuICAvLyAgIH1cbiAgLy8gICByZXR1cm4gdXR4b3M7XG4gIC8vIH1cbiAgO1xuXG4gIF9wcm90by5nZXRVdHhvcyA9XG4gIC8qI19fUFVSRV9fKi9cbiAgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0VXR4b3MgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHtcbiAgICAgIHZhciB1dHhvcywgdXR4b3NBc3NldHM7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcm92aWRlci5nZXRVdHhvcygpO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgIHV0eG9zID0gX2NvbnRleHQ1LnNlbnQ7XG5cbiAgICAgICAgICAgICAgaWYgKCEodXR4b3MgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0aHJvdyAnTm8gdXR4b3MnO1xuXG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgIHV0eG9zQXNzZXRzID0gW107IC8vIFRPRE8sIGxldHMgZ2V0IFVUWE9zIGxpa2UgdGhpcyBhcyBkZWZhdWx0IGh0dHBzOi8vZG9jcy5ibG9ja2Zyb3N0LmlvLyN0YWcvQ2FyZGFuby1BZGRyZXNzZXMvcGF0aHMvfjFhZGRyZXNzZXN+MXthZGRyZXNzfX4xdXR4b3MvZ2V0XG5cbiAgICAgICAgICAgICAgdXR4b3MubWFwKGZ1bmN0aW9uICh1KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNVdHhvID0ge1xuICAgICAgICAgICAgICAgICAgY2JvcjogdSxcbiAgICAgICAgICAgICAgICAgIGFzc2V0czoge30sXG4gICAgICAgICAgICAgICAgICBhZGRyZXNzOiAnJyxcbiAgICAgICAgICAgICAgICAgIHR4SGFzaDogJycsXG4gICAgICAgICAgICAgICAgICBvdXRwdXRJbmRleDogMFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHV0eG8gPSBjc2wuVHJhbnNhY3Rpb25VbnNwZW50T3V0cHV0LmZyb21fYnl0ZXMoQnVmZmVyLmZyb20odSwgJ2hleCcpKTtcbiAgICAgICAgICAgICAgICB0aGlzVXR4by5hZGRyZXNzID0gdXR4by5vdXRwdXQoKS5hZGRyZXNzKCkudG9fYmVjaDMyKCk7IC8vIHRoaXNVdHhvLnR4SGFzaCA9IHV0eG8ub3V0cHV0KCkuZGF0YV9oYXNoKClcbiAgICAgICAgICAgICAgICAvLyAgID8gdG9IZXgodXR4by5vdXRwdXQoKS5kYXRhX2hhc2goKSEudG9fYnl0ZXMoKSlcbiAgICAgICAgICAgICAgICAvLyAgIDogJyc7XG5cbiAgICAgICAgICAgICAgICB2YWx1ZVRvQXNzZXRzKHV0eG8ub3V0cHV0KCkuYW1vdW50KCkpLmZvckVhY2goZnVuY3Rpb24gKG5ubikge1xuICAgICAgICAgICAgICAgICAgdmFyIHVuaXQgPSBubm4udW5pdDtcblxuICAgICAgICAgICAgICAgICAgdmFyIF9wb2xpY3kgPSB1bml0LnNsaWNlKDAsIDU2KTtcblxuICAgICAgICAgICAgICAgICAgdmFyIF9uYW1lID0gSGV4VG9Bc2NpaSh1bml0LnNsaWNlKDU2KSk7XG5cbiAgICAgICAgICAgICAgICAgIHZhciBhc3NldElkID0gX3BvbGljeSA9PSAnbG92ZWxhY2UnID8gJ2xvdmVsYWNlJyA6IF9wb2xpY3kgKyBcIi5cIiArIF9uYW1lO1xuICAgICAgICAgICAgICAgICAgdGhpc1V0eG8uYXNzZXRzW2Fzc2V0SWRdID0gcGFyc2VJbnQobm5uLnF1YW50aXR5KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB1dHhvc0Fzc2V0cy5wdXNoKHRoaXNVdHhvKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KFwicmV0dXJuXCIsIHV0eG9zQXNzZXRzKTtcblxuICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU1LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBnZXRVdHhvcygpIHtcbiAgICAgIHJldHVybiBfZ2V0VXR4b3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0VXR4b3M7XG4gIH0oKTtcblxuICBfcHJvdG8uZ2V0QmFsYW5jZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRCYWxhbmNlID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0Nikge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcm92aWRlci5nZXRCYWxhbmNlKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoXCJyZXR1cm5cIiwgX2NvbnRleHQ2LnNlbnQpO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTYsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldEJhbGFuY2UoKSB7XG4gICAgICByZXR1cm4gX2dldEJhbGFuY2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0QmFsYW5jZTtcbiAgfSgpXG4gIC8qKlxyXG4gICAqIFJldHVybnMgYSBsaXN0IG9mIGFsbCB1c2VkIChpbmNsdWRlZCBpbiBzb21lIG9uLWNoYWluIHRyYW5zYWN0aW9uKSBhZGRyZXNzZXMgY29udHJvbGxlZCBieSB0aGUgd2FsbGV0LlxyXG4gICAqIEByZXR1cm5zIGxpc3Qgb2YgYmVjaDMyIGFkZHJlc3Nlc1xyXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLmdldFVzZWRBZGRyZXNzZXMgPVxuICAvKiNfX1BVUkVfXyovXG4gIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX2dldFVzZWRBZGRyZXNzZXMgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHtcbiAgICAgIHZhciB1c2VkQWRkcmVzc2VzO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvdmlkZXIuZ2V0VXNlZEFkZHJlc3NlcygpO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgIHVzZWRBZGRyZXNzZXMgPSBfY29udGV4dDcuc2VudDtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoXCJyZXR1cm5cIiwgdXNlZEFkZHJlc3Nlcy5tYXAoZnVuY3Rpb24gKGFkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3NsLkFkZHJlc3MuZnJvbV9ieXRlcyhmcm9tSGV4KGFkZHJlc3MpKS50b19iZWNoMzIoKTtcbiAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTcsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldFVzZWRBZGRyZXNzZXMoKSB7XG4gICAgICByZXR1cm4gX2dldFVzZWRBZGRyZXNzZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0VXNlZEFkZHJlc3NlcztcbiAgfSgpO1xuXG4gIF9wcm90by5nZXRVbnVzZWRBZGRyZXNzZXMgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0VW51c2VkQWRkcmVzc2VzID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoKSB7XG4gICAgICB2YXIgdW51c2VkQWRkcmVzc2VzO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvdmlkZXIuZ2V0VW51c2VkQWRkcmVzc2VzKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgdW51c2VkQWRkcmVzc2VzID0gX2NvbnRleHQ4LnNlbnQ7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KFwicmV0dXJuXCIsIHVudXNlZEFkZHJlc3Nlcy5tYXAoZnVuY3Rpb24gKGFkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3NsLkFkZHJlc3MuZnJvbV9ieXRlcyhmcm9tSGV4KGFkZHJlc3MpKS50b19iZWNoMzIoKTtcbiAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTgsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldFVudXNlZEFkZHJlc3NlcygpIHtcbiAgICAgIHJldHVybiBfZ2V0VW51c2VkQWRkcmVzc2VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldFVudXNlZEFkZHJlc3NlcztcbiAgfSgpO1xuXG4gIF9wcm90by5nZXRDaGFuZ2VBZGRyZXNzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2dldENoYW5nZUFkZHJlc3MgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHtcbiAgICAgIHZhciBjaGFuZ2VBZGRyZXNzO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvdmlkZXIuZ2V0Q2hhbmdlQWRkcmVzcygpO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgIGNoYW5nZUFkZHJlc3MgPSBfY29udGV4dDkuc2VudDtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoXCJyZXR1cm5cIiwgY3NsLkFkZHJlc3MuZnJvbV9ieXRlcyhmcm9tSGV4KGNoYW5nZUFkZHJlc3MpKS50b19iZWNoMzIoKSk7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlOSwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZ2V0Q2hhbmdlQWRkcmVzcygpIHtcbiAgICAgIHJldHVybiBfZ2V0Q2hhbmdlQWRkcmVzcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBnZXRDaGFuZ2VBZGRyZXNzO1xuICB9KCk7XG5cbiAgX3Byb3RvLmdldENvbGxhdGVyYWwgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0Q29sbGF0ZXJhbCA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMCgpIHtcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvdmlkZXIuZ2V0Q29sbGF0ZXJhbCgpO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdChcInJldHVyblwiLCBfY29udGV4dDEwLnNlbnQpO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUxMCwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZ2V0Q29sbGF0ZXJhbCgpIHtcbiAgICAgIHJldHVybiBfZ2V0Q29sbGF0ZXJhbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBnZXRDb2xsYXRlcmFsO1xuICB9KClcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgcmV3YXJkIGFkZHJlc3NlcyBvd25lZCBieSB0aGUgd2FsbGV0LiBUaGlzIGNhbiByZXR1cm4gbXVsdGlwbGUgYWRkcmVzc2VzIGUuZy4gQ0lQLTAwMTguXHJcbiAgICogQHJldHVybnMgbGlzdCBvZiByZXdhcmQgYWRkcmVzc2VzXHJcbiAgICovXG4gIDtcblxuICBfcHJvdG8uZ2V0UmV3YXJkQWRkcmVzc2VzID1cbiAgLyojX19QVVJFX18qL1xuICBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRSZXdhcmRBZGRyZXNzZXMgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoKSB7XG4gICAgICB2YXIgdW51c2VkQWRkcmVzc2VzO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDI7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcm92aWRlci5nZXRSZXdhcmRBZGRyZXNzZXMoKTtcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICB1bnVzZWRBZGRyZXNzZXMgPSBfY29udGV4dDExLnNlbnQ7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdChcInJldHVyblwiLCB1bnVzZWRBZGRyZXNzZXMubWFwKGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNzbC5BZGRyZXNzLmZyb21fYnl0ZXMoZnJvbUhleChhZGRyZXNzKSkudG9fYmVjaDMyKCk7XG4gICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTEsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldFJld2FyZEFkZHJlc3NlcygpIHtcbiAgICAgIHJldHVybiBfZ2V0UmV3YXJkQWRkcmVzc2VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldFJld2FyZEFkZHJlc3NlcztcbiAgfSgpXG4gIC8qKlxyXG4gICAqIFJlcXVlc3RzIHRoYXQgYSB1c2VyIHNpZ24gdGhlIHVuc2lnbmVkIHBvcnRpb25zIG9mIHRoZSBzdXBwbGllZCB0cmFuc2FjdGlvbi4gVGhlIHdhbGxldCBzaG91bGQgYXNrIHRoZSB1c2VyIGZvciBwZXJtaXNzaW9uLCBhbmQgaWYgZ2l2ZW4sIHRyeSB0byBzaWduIHRoZSBzdXBwbGllZCBib2R5IGFuZCByZXR1cm4gYSBzaWduZWQgdHJhbnNhY3Rpb24uXHJcbiAgICogQHBhcmFtIHR4IC0gVHJhbnNhY3Rpb24gaW4gQ0JPUlxyXG4gICAqIEBwYXJhbSBwYXJ0aWFsU2lnbiAtIFRydWUgaWYgcGFydGlhbCBzaWduIGZvciBtdWx0aS1zaWduYXR1cmVcclxuICAgKiBAcmV0dXJucyBzaWduYXR1cmVcclxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5zaWduVHggPVxuICAvKiNfX1BVUkVfXyovXG4gIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX3NpZ25UeCA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMihfcmVmMykge1xuICAgICAgdmFyIHR4LCBfcmVmMyRwYXJ0aWFsU2lnbiwgcGFydGlhbFNpZ247XG5cbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTIucHJldiA9IF9jb250ZXh0MTIubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICB0eCA9IF9yZWYzLnR4LCBfcmVmMyRwYXJ0aWFsU2lnbiA9IF9yZWYzLnBhcnRpYWxTaWduLCBwYXJ0aWFsU2lnbiA9IF9yZWYzJHBhcnRpYWxTaWduID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYzJHBhcnRpYWxTaWduO1xuICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAzO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvdmlkZXIuc2lnblR4KHR4LCBwYXJ0aWFsU2lnbik7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuYWJydXB0KFwicmV0dXJuXCIsIF9jb250ZXh0MTIuc2VudCk7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTEyLCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBzaWduVHgoX3gyKSB7XG4gICAgICByZXR1cm4gX3NpZ25UeC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBzaWduVHg7XG4gIH0oKVxuICAvKipcclxuICAgKiBUaGlzIGVuZHBvaW50IHV0aWxpemVzIHRoZSBDSVAtMDAwOCBzaWduaW5nIHNwZWMgZm9yIHN0YW5kYXJkaXphdGlvbi9zYWZldHkgcmVhc29ucy4gSXQgYWxsb3dzIHRoZSBkQXBwIHRvIHJlcXVlc3QgdGhlIHVzZXIgdG8gc2lnbiBhIHBheWxvYWQgY29uZm9ybWluZyB0byBzYWlkIHNwZWMuXHJcbiAgICogQHBhcmFtIHBheWxvYWQgLSBOb25jZSBzdHJpbmdcclxuICAgKiBAcmV0dXJucyBzaWduYXR1cmVcclxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5zaWduRGF0YSA9XG4gIC8qI19fUFVSRV9fKi9cbiAgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfc2lnbkRhdGEgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTMoX3JlZjQpIHtcbiAgICAgIHZhciBwYXlsb2FkLCByZXdhcmRBZGRyZXNzLCBjb3NlU2lnbjFIZXg7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgcGF5bG9hZCA9IF9yZWY0LnBheWxvYWQ7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDM7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJld2FyZEFkZHJlc3NlcygpO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIHJld2FyZEFkZHJlc3MgPSBfY29udGV4dDEzLnNlbnQ7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDY7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcm92aWRlci5zaWduRGF0YShyZXdhcmRBZGRyZXNzWzBdLCBwYXlsb2FkKTtcblxuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICBjb3NlU2lnbjFIZXggPSBfY29udGV4dDEzLnNlbnQ7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLmFicnVwdChcInJldHVyblwiLCBjb3NlU2lnbjFIZXgpO1xuXG4gICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUxMywgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gc2lnbkRhdGEoX3gzKSB7XG4gICAgICByZXR1cm4gX3NpZ25EYXRhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNpZ25EYXRhO1xuICB9KCk7XG5cbiAgX3Byb3RvLnN1Ym1pdFR4ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX3N1Ym1pdFR4ID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE0KF9yZWY1KSB7XG4gICAgICB2YXIgdHg7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDE0LnByZXYgPSBfY29udGV4dDE0Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgdHggPSBfcmVmNS50eDtcbiAgICAgICAgICAgICAgX2NvbnRleHQxNC5uZXh0ID0gMztcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Byb3ZpZGVyLnN1Ym1pdFR4KHR4KTtcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5hYnJ1cHQoXCJyZXR1cm5cIiwgX2NvbnRleHQxNC5zZW50KTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTQsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFR4KF94NCkge1xuICAgICAgcmV0dXJuIF9zdWJtaXRUeC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWJtaXRUeDtcbiAgfSgpXG4gIC8qKlxyXG4gICAqIFRoZXNlIGFyZSBoZWxwZXIgZnVuY3Rpb25zXHJcbiAgICovXG5cbiAgLyoqXHJcbiAgICogR2V0IGEgbGlzdCB3YWxsZXRzIGluc3RhbGxlZCBvbiB0aGlzIGJyb3dzZVxyXG4gICAqIEByZXR1cm5zIGEgbGlzdCBvZiBhdmFpbGFibGUgd2FsbGV0c1xyXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLmdldEF2YWlsYWJsZVdhbGxldHMgPVxuICAvKiNfX1BVUkVfXyovXG4gIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX2dldEF2YWlsYWJsZVdhbGxldHMgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTUoKSB7XG4gICAgICB2YXIgYXZhaWxhYmxlV2FsbGV0cztcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTUkKF9jb250ZXh0MTUpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTUucHJldiA9IF9jb250ZXh0MTUubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBhdmFpbGFibGVXYWxsZXRzID0gW107XG5cbiAgICAgICAgICAgICAgaWYgKCEod2luZG93LmNhcmRhbm8gPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDE1Lm5leHQgPSAzO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuYWJydXB0KFwicmV0dXJuXCIsIGF2YWlsYWJsZVdhbGxldHMpO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIGlmICh3aW5kb3cuY2FyZGFuby5jY3ZhdWx0KSB7XG4gICAgICAgICAgICAgICAgYXZhaWxhYmxlV2FsbGV0cy5wdXNoKCdjY3ZhdWx0Jyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAod2luZG93LmNhcmRhbm8uZ2Vyb3dhbGxldCkge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZVdhbGxldHMucHVzaCgnZ2Vyb3dhbGxldCcpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKHdpbmRvdy5jYXJkYW5vLm5hbWkpIHtcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVXYWxsZXRzLnB1c2goJ25hbWknKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE1LmFicnVwdChcInJldHVyblwiLCBhdmFpbGFibGVXYWxsZXRzKTtcblxuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNS5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTUpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldEF2YWlsYWJsZVdhbGxldHMoKSB7XG4gICAgICByZXR1cm4gX2dldEF2YWlsYWJsZVdhbGxldHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0QXZhaWxhYmxlV2FsbGV0cztcbiAgfSgpXG4gIC8qKlxyXG4gICAqIFJldHVybiB0aGUgZmlyc3QgdXNlZCBhZGRyZXNzXHJcbiAgICogQHJldHVybnMgZmlyc3QgYWRkcmVzcyBpbiBzdHJpbmdcclxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5nZXRXYWxsZXRBZGRyZXNzID1cbiAgLyojX19QVVJFX18qL1xuICBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRXYWxsZXRBZGRyZXNzID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE2KCkge1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNiQoX2NvbnRleHQxNikge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNi5wcmV2ID0gX2NvbnRleHQxNi5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0MTYubmV4dCA9IDI7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFVzZWRBZGRyZXNzZXMoKTtcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNi5hYnJ1cHQoXCJyZXR1cm5cIiwgX2NvbnRleHQxNi5zZW50WzBdKTtcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNi5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTYsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldFdhbGxldEFkZHJlc3MoKSB7XG4gICAgICByZXR1cm4gX2dldFdhbGxldEFkZHJlc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0V2FsbGV0QWRkcmVzcztcbiAgfSgpXG4gIC8qKlxyXG4gICAqIFJldHVybiBsb3ZlbGFjZSBhbW91bnRcclxuICAgKiBUT0RPOiB3aHkgZ2V0IGB1bmRlcmZsb3dgIGVycm9yP1xyXG4gICAqIEByZXR1cm5zIGxvdmVsYW5jZVxyXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLmdldExvdmVsYWNlID1cbiAgLyojX19QVVJFX18qL1xuICBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRMb3ZlbGFjZSA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNygpIHtcbiAgICAgIHZhciBsb3ZlbGFjZSwgdXR4b3MsIGlucHV0cztcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTckKF9jb250ZXh0MTcpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTcucHJldiA9IF9jb250ZXh0MTcubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBsb3ZlbGFjZSA9IDA7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTcubmV4dCA9IDM7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFV0eG9zKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgdXR4b3MgPSBfY29udGV4dDE3LnNlbnQ7XG5cbiAgICAgICAgICAgICAgaWYgKHV0eG9zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAvLyAvLyB2MVxuICAgICAgICAgICAgICAgIC8vIGNvbnN0IHBhcnNlZFV0eG9zID0gdXR4b3MubWFwKCh1dHhvKSA9PlxuICAgICAgICAgICAgICAgIC8vICAgY3NsLlRyYW5zYWN0aW9uVW5zcGVudE91dHB1dC5mcm9tX2J5dGVzKGZyb21IZXgodXR4by5jYm9yKSlcbiAgICAgICAgICAgICAgICAvLyApO1xuICAgICAgICAgICAgICAgIC8vIGxldCBjb3VudGVkVmFsdWUgPSBjc2wuVmFsdWUubmV3KFxuICAgICAgICAgICAgICAgIC8vICAgY3NsLkJpZ051bS5mcm9tX3N0cignMCcpXG4gICAgICAgICAgICAgICAgLy8gKTtcbiAgICAgICAgICAgICAgICAvLyBwYXJzZWRVdHhvcy5mb3JFYWNoKFxuICAgICAgICAgICAgICAgIC8vICAgKGVsZW1lbnQ6IHtcbiAgICAgICAgICAgICAgICAvLyAgICAgb3V0cHV0OiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgKCk6IGFueTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICBuZXcgKCk6IGFueTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICBhbW91bnQ6IHsgKCk6IFZhbHVlOyBuZXcgKCk6IGFueSB9O1xuICAgICAgICAgICAgICAgIC8vICAgICB9O1xuICAgICAgICAgICAgICAgIC8vICAgfSkgPT4ge1xuICAgICAgICAgICAgICAgIC8vICAgICBjb3VudGVkVmFsdWUgPSBjb3VudGVkVmFsdWUuY2hlY2tlZF9hZGQoZWxlbWVudC5vdXRwdXQoKS5hbW91bnQoKSk7XG4gICAgICAgICAgICAgICAgLy8gICB9XG4gICAgICAgICAgICAgICAgLy8gKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zdCBtaW5BZGEgPSBjc2wubWluX2FkYV9yZXF1aXJlZChcbiAgICAgICAgICAgICAgICAvLyAgIGNvdW50ZWRWYWx1ZSxcbiAgICAgICAgICAgICAgICAvLyAgIGZhbHNlLFxuICAgICAgICAgICAgICAgIC8vICAgY3NsLkJpZ051bS5mcm9tX3N0cihNSU5fQURBX1JFUVVJUkVELnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgLy8gKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zdCBhdmFpbGFibGVBZGEgPSBjb3VudGVkVmFsdWUuY29pbigpLmNoZWNrZWRfc3ViKG1pbkFkYSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc3QgbG92ZWxhY2UgPSBwYXJzZUludChhdmFpbGFibGVBZGEudG9fc3RyKCkpO1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiBsb3ZlbGFjZTtcbiAgICAgICAgICAgICAgICAvLyAvLyB2MlxuICAgICAgICAgICAgICAgIGlucHV0cyA9IHV0eG9zLm1hcChmdW5jdGlvbiAodXR4bykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGNzbC5UcmFuc2FjdGlvblVuc3BlbnRPdXRwdXQuZnJvbV9ieXRlcyhCdWZmZXIuZnJvbSh1dHhvLmNib3IsICdoZXgnKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKG5uKSB7XG4gICAgICAgICAgICAgICAgICB2YWx1ZVRvQXNzZXRzKG5uLm91dHB1dCgpLmFtb3VudCgpKS5mb3JFYWNoKGZ1bmN0aW9uIChubm4pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ubi51bml0ID09PSAnbG92ZWxhY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbG92ZWxhY2UgKz0gcGFyc2VJbnQobm5uLnF1YW50aXR5LCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTcuYWJydXB0KFwicmV0dXJuXCIsIGxvdmVsYWNlKTtcblxuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNy5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTcsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldExvdmVsYWNlKCkge1xuICAgICAgcmV0dXJuIF9nZXRMb3ZlbGFjZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBnZXRMb3ZlbGFjZTtcbiAgfSgpXG4gIC8qKlxyXG4gICAqIEdldCBhIGxpc3Qgb2YgYXNzZXRzIGluIGNvbm5lY3RlZCB3YWxsZXRcclxuICAgKiBOb3RlOiBpbmNsdWRlT25jaGFpbiByZXF1aXJlcyBgTWVzaC5ibG9ja2Zyb3N0LmluaXRgXHJcbiAgICogQHBhcmFtIHBvbGljeUlkIChvcHRpb25hbCkgaWYgcHJvdmlkZWQgd2lsbCBmaWx0ZXIgb25seSBhc3NldHMgaW4gdGhpcyBwb2xpY3lcclxuICAgKiBAcGFyYW0gaW5jbHVkZU9uY2hhaW4gKG9wdGlvbmFsKSBpZiBwcm92aWRlZCB3aWxsIGdldCBvbi1jaGFpbiBtZXRhZGF0YVxyXG4gICAqIEBwYXJhbSBsaW1pdCAob3B0aW9uYWwpIGlmIHByb3ZpZGVkIHdpbGwgbGltaXQgdGhlIG51bWJlciBvZiAocmFuZG9tKSBhc3NldHMgcmV0dXJuZWRcclxuICAgKiBAcmV0dXJucyBhc3NldHMgLSBMaXN0IG9mIGFzc2V0XHJcbiAgICovXG4gIDtcblxuICBfcHJvdG8uZ2V0QXNzZXRzID1cbiAgLyojX19QVVJFX18qL1xuICBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRBc3NldHMgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTkob3B0aW9ucykge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdmFyIHZhbHVlQ0JPUiwgdmFsdWUsIGFzc2V0cywgX3ZhbHVlJG11bHRpYXNzZXQsIG11bHRpQXNzZXRzLCBqLCBfdmFsdWUkbXVsdGlhc3NldDIsIHBvbGljeSwgcG9saWN5QXNzZXRzLCBhc3NldE5hbWVzLCBrLCBwb2xpY3lBc3NldCwgcXVhbnRpdHksIGFzc2V0LCBfcG9saWN5LCBfbmFtZSwgZmlsdGVyZWRBc3NldHM7XG5cbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTkkKF9jb250ZXh0MTkpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTkucHJldiA9IF9jb250ZXh0MTkubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRCYWxhbmNlKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgdmFsdWVDQk9SID0gX2NvbnRleHQxOS5zZW50O1xuICAgICAgICAgICAgICB2YWx1ZSA9IGNzbC5WYWx1ZS5mcm9tX2J5dGVzKGZyb21IZXgodmFsdWVDQk9SKSk7XG4gICAgICAgICAgICAgIGFzc2V0cyA9IFtdO1xuXG4gICAgICAgICAgICAgIGlmICh2YWx1ZS5tdWx0aWFzc2V0KCkpIHtcbiAgICAgICAgICAgICAgICBtdWx0aUFzc2V0cyA9IChfdmFsdWUkbXVsdGlhc3NldCA9IHZhbHVlLm11bHRpYXNzZXQoKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF92YWx1ZSRtdWx0aWFzc2V0LmtleXMoKTtcblxuICAgICAgICAgICAgICAgIGlmIChtdWx0aUFzc2V0cykge1xuICAgICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IG11bHRpQXNzZXRzLmxlbigpOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5ID0gbXVsdGlBc3NldHMuZ2V0KGopO1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lBc3NldHMgPSAoX3ZhbHVlJG11bHRpYXNzZXQyID0gdmFsdWUubXVsdGlhc3NldCgpKSA9PSBudWxsID8gdm9pZCAwIDogX3ZhbHVlJG11bHRpYXNzZXQyLmdldChwb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICBhc3NldE5hbWVzID0gcG9saWN5QXNzZXRzID09IG51bGwgPyB2b2lkIDAgOiBwb2xpY3lBc3NldHMua2V5cygpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3lBc3NldHMgJiYgYXNzZXROYW1lcykge1xuICAgICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBhc3NldE5hbWVzLmxlbigpOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeUFzc2V0ID0gYXNzZXROYW1lcy5nZXQoayk7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eSA9IHBvbGljeUFzc2V0cy5nZXQocG9saWN5QXNzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQgPSB0b0hleChwb2xpY3kudG9fYnl0ZXMoKSkgKyB0b0hleChwb2xpY3lBc3NldC5uYW1lKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3BvbGljeSA9IGFzc2V0LnNsaWNlKDAsIDU2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lID0gYXNzZXQuc2xpY2UoNTYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBhc3NldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IHBhcnNlSW50KHF1YW50aXR5LnRvX3N0cigpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5OiBfcG9saWN5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBIZXhUb0FzY2lpKF9uYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IC8vIGlmIGBwb2xpY3lJZGAgaXMgcHJvdmlkZWQsIHJldHVybiBhc3NldHMgaW4gdGhpcyBwb2xpY3kgSURcblxuXG4gICAgICAgICAgICAgIGlmIChvcHRpb25zICE9IG51bGwgJiYgb3B0aW9ucy5wb2xpY3lJZCAmJiBvcHRpb25zLnBvbGljeUlkICYmIChvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLnBvbGljeUlkLmxlbmd0aCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgZmlsdGVyZWRBc3NldHMgPSBhc3NldHMuZmlsdGVyKGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLnVuaXQuaW5jbHVkZXMob3B0aW9ucy5wb2xpY3lJZCk7XG4gICAgICAgICAgICAgICAgfSkubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBhc3NldHMgPSBbXS5jb25jYXQoZmlsdGVyZWRBc3NldHMpO1xuICAgICAgICAgICAgICB9IC8vIGlmIGBsaW1pdGAgcHJvdmlkZWQsIHBpY2sgdGhlIGZpcnN0IGBsaW1pdGAgbnVtYmVyIG9mIGFzc2V0c1xuXG5cbiAgICAgICAgICAgICAgaWYgKG9wdGlvbnMgIT0gbnVsbCAmJiBvcHRpb25zLmxpbWl0ICYmIG9wdGlvbnMubGltaXQgPiAwKSB7XG4gICAgICAgICAgICAgICAgYXNzZXRzID0gYXNzZXRzLnNsaWNlKDAsIG9wdGlvbnMubGltaXQpO1xuICAgICAgICAgICAgICB9IC8vIGlmIGJsb2NrZnJvc3QgaXMgbG9hZGVkIGFuZCBgaW5jbHVkZU9uY2hhaW5gLCBwdWxsIG9uLWNoYWluIGluZm9cblxuXG4gICAgICAgICAgICAgIGlmICghKHRoaXMuX2Jsb2NrZnJvc3QuaXNMb2FkZWQoKSAmJiBvcHRpb25zICE9IG51bGwgJiYgb3B0aW9ucy5pbmNsdWRlT25jaGFpbikpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSAxMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIF9jb250ZXh0MTkubmV4dCA9IDExO1xuICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoYXNzZXRzLm1hcCggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3JlZjYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxOChhc3NldCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxOCQoX2NvbnRleHQxOCkge1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxOC5wcmV2ID0gX2NvbnRleHQxOC5uZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTgubmV4dCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5fYmxvY2tmcm9zdC5hc3NldFNwZWNpZmljQXNzZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0OiBhc3NldC51bml0XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0Lm9uY2hhaW4gPSBfY29udGV4dDE4LnNlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0LmltYWdlID0gYXNzZXQub25jaGFpbi5vbmNoYWluX21ldGFkYXRhICYmIGFzc2V0Lm9uY2hhaW4ub25jaGFpbl9tZXRhZGF0YS5pbWFnZSAmJiBsaW5rVG9TcmMoY29udmVydE1ldGFkYXRhUHJvcFRvU3RyaW5nKGFzc2V0Lm9uY2hhaW4ub25jaGFpbl9tZXRhZGF0YS5pbWFnZSkpIHx8ICcnO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE4LnN0b3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxOCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDYpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmNi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH0oKSkpO1xuXG4gICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5hYnJ1cHQoXCJyZXR1cm5cIiwgYXNzZXRzKTtcblxuICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTE5LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBnZXRBc3NldHMoX3g1KSB7XG4gICAgICByZXR1cm4gX2dldEFzc2V0cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBnZXRBc3NldHM7XG4gIH0oKTtcblxuICBfcHJvdG8uc3VibWl0VHJhbnNhY3Rpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfc3VibWl0VHJhbnNhY3Rpb24gPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMjAoX3JlZjcpIHtcbiAgICAgIHZhciB0eCwgd2l0bmVzc2VzLCBfcmVmNyRtZXRhZGF0YSwgbWV0YWRhdGEsIHRyYW5zYWN0aW9uLCB0eFdpdG5lc3NlcywgdHhWa2V5cywgdHhTY3JpcHRzLCB0b3RhbFZrZXlzLCB0b3RhbFNjcmlwdHMsIF9pdGVyYXRvciwgX3N0ZXAsIHdpdG5lc3MsIGFkZFdpdG5lc3NlcywgYWRkVmtleXMsIF9pMiwgaSwgX2ksIHRvdGFsV2l0bmVzc2VzLCBhdXgsIGdlbmVyYWxNZXRhZGF0YSwgc2lnbmVkVHgsIHR4SGFzaDtcblxuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMCQoX2NvbnRleHQyMCkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyMC5wcmV2ID0gX2NvbnRleHQyMC5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIHR4ID0gX3JlZjcudHgsIHdpdG5lc3NlcyA9IF9yZWY3LndpdG5lc3NlcywgX3JlZjckbWV0YWRhdGEgPSBfcmVmNy5tZXRhZGF0YSwgbWV0YWRhdGEgPSBfcmVmNyRtZXRhZGF0YSA9PT0gdm9pZCAwID8gdW5kZWZpbmVkIDogX3JlZjckbWV0YWRhdGE7XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uID0gY3NsLlRyYW5zYWN0aW9uLmZyb21fYnl0ZXMoQnVmZmVyLmZyb20odHgsICdoZXgnKSk7XG4gICAgICAgICAgICAgIHR4V2l0bmVzc2VzID0gdHJhbnNhY3Rpb24ud2l0bmVzc19zZXQoKTtcbiAgICAgICAgICAgICAgdHhWa2V5cyA9IHR4V2l0bmVzc2VzLnZrZXlzKCk7XG4gICAgICAgICAgICAgIHR4U2NyaXB0cyA9IHR4V2l0bmVzc2VzLm5hdGl2ZV9zY3JpcHRzKCk7XG4gICAgICAgICAgICAgIHRvdGFsVmtleXMgPSBjc2wuVmtleXdpdG5lc3Nlc1tcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICB0b3RhbFNjcmlwdHMgPSBjc2wuTmF0aXZlU2NyaXB0c1tcIm5ld1wiXSgpO1xuXG4gICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXJMb29zZSh3aXRuZXNzZXMpOyAhKF9zdGVwID0gX2l0ZXJhdG9yKCkpLmRvbmU7KSB7XG4gICAgICAgICAgICAgICAgd2l0bmVzcyA9IF9zdGVwLnZhbHVlO1xuICAgICAgICAgICAgICAgIGFkZFdpdG5lc3NlcyA9IGNzbC5UcmFuc2FjdGlvbldpdG5lc3NTZXQuZnJvbV9ieXRlcyhCdWZmZXIuZnJvbSh3aXRuZXNzLCAnaGV4JykpO1xuICAgICAgICAgICAgICAgIGFkZFZrZXlzID0gYWRkV2l0bmVzc2VzLnZrZXlzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYWRkVmtleXMpIHtcbiAgICAgICAgICAgICAgICAgIGZvciAoX2kyID0gMDsgX2kyIDwgYWRkVmtleXMubGVuKCk7IF9pMisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsVmtleXMuYWRkKGFkZFZrZXlzLmdldChfaTIpKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAodHhWa2V5cykge1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB0eFZrZXlzLmxlbigpOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgIHRvdGFsVmtleXMuYWRkKHR4VmtleXMuZ2V0KGkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAodHhTY3JpcHRzKSB7XG4gICAgICAgICAgICAgICAgZm9yIChfaSA9IDA7IF9pIDwgdHhTY3JpcHRzLmxlbigpOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICB0b3RhbFNjcmlwdHMuYWRkKHR4U2NyaXB0cy5nZXQoX2kpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0b3RhbFdpdG5lc3NlcyA9IGNzbC5UcmFuc2FjdGlvbldpdG5lc3NTZXRbXCJuZXdcIl0oKTtcbiAgICAgICAgICAgICAgdG90YWxXaXRuZXNzZXMuc2V0X3ZrZXlzKHRvdGFsVmtleXMpO1xuICAgICAgICAgICAgICB0b3RhbFdpdG5lc3Nlcy5zZXRfbmF0aXZlX3NjcmlwdHModG90YWxTY3JpcHRzKTtcblxuICAgICAgICAgICAgICBpZiAobWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICBhdXggPSBjc2wuQXV4aWxpYXJ5RGF0YVtcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICAgIGdlbmVyYWxNZXRhZGF0YSA9IGNzbC5HZW5lcmFsVHJhbnNhY3Rpb25NZXRhZGF0YVtcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKG1ldGFkYXRhKS5tYXAoZnVuY3Rpb24gKF9yZWY4KSB7XG4gICAgICAgICAgICAgICAgICB2YXIgTWV0YWRhdGFMYWJlbCA9IF9yZWY4WzBdLFxuICAgICAgICAgICAgICAgICAgICAgIE1ldGFkYXRhID0gX3JlZjhbMV07XG4gICAgICAgICAgICAgICAgICBnZW5lcmFsTWV0YWRhdGEuaW5zZXJ0KGNzbC5CaWdOdW0uZnJvbV9zdHIoTWV0YWRhdGFMYWJlbCksIGNzbC5lbmNvZGVfanNvbl9zdHJfdG9fbWV0YWRhdHVtKEpTT04uc3RyaW5naWZ5KE1ldGFkYXRhKSwgMCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGF1eC5zZXRfbWV0YWRhdGEoZ2VuZXJhbE1ldGFkYXRhKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhdXggPSB0cmFuc2FjdGlvbi5hdXhpbGlhcnlfZGF0YSgpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2NvbnRleHQyMC5wcmV2ID0gMTQ7XG4gICAgICAgICAgICAgIF9jb250ZXh0MjAubmV4dCA9IDE3O1xuICAgICAgICAgICAgICByZXR1cm4gY3NsLlRyYW5zYWN0aW9uW1wibmV3XCJdKHRyYW5zYWN0aW9uLmJvZHkoKSwgdG90YWxXaXRuZXNzZXMsIGF1eCk7XG5cbiAgICAgICAgICAgIGNhc2UgMTc6XG4gICAgICAgICAgICAgIHNpZ25lZFR4ID0gX2NvbnRleHQyMC5zZW50O1xuICAgICAgICAgICAgICBfY29udGV4dDIwLm5leHQgPSAyMDtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3VibWl0VHgoe1xuICAgICAgICAgICAgICAgIHR4OiB0b0hleChzaWduZWRUeC50b19ieXRlcygpKVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSAyMDpcbiAgICAgICAgICAgICAgdHhIYXNoID0gX2NvbnRleHQyMC5zZW50O1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMC5hYnJ1cHQoXCJyZXR1cm5cIiwgdHhIYXNoKTtcblxuICAgICAgICAgICAgY2FzZSAyNDpcbiAgICAgICAgICAgICAgX2NvbnRleHQyMC5wcmV2ID0gMjQ7XG4gICAgICAgICAgICAgIF9jb250ZXh0MjAudDAgPSBfY29udGV4dDIwW1wiY2F0Y2hcIl0oMTQpO1xuICAgICAgICAgICAgICB0aHJvdyBfY29udGV4dDIwLnQwO1xuXG4gICAgICAgICAgICBjYXNlIDI3OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMC5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMjAsIHRoaXMsIFtbMTQsIDI0XV0pO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFRyYW5zYWN0aW9uKF94Nykge1xuICAgICAgcmV0dXJuIF9zdWJtaXRUcmFuc2FjdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWJtaXRUcmFuc2FjdGlvbjtcbiAgfSgpO1xuXG4gIHJldHVybiBXYWxsZXQ7XG59KCk7XG5cbnZhciBUcmFuc2FjdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFRyYW5zYWN0aW9uKF9yZWYpIHtcbiAgICB2YXIgd2FsbGV0ID0gX3JlZi53YWxsZXQ7XG5cbiAgICB0aGlzLl9jcmVhdGVUeE91dHB1dCA9IGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgdmFyIGFkZHJlc3MgPSBfcmVmMi5hZGRyZXNzLFxuICAgICAgICAgIHZhbHVlID0gX3JlZjIudmFsdWUsXG4gICAgICAgICAgZGF0dW0gPSBfcmVmMi5kYXR1bTtcbiAgICAgIHZhciBvdXRwdXQ7XG5cbiAgICAgIGlmIChkYXR1bSkge1xuICAgICAgICBvdXRwdXQgPSBjc2wuVHJhbnNhY3Rpb25PdXRwdXRCdWlsZGVyW1wibmV3XCJdKCkud2l0aF9hZGRyZXNzKGFkZHJlc3MpLndpdGhfcGx1dHVzX2RhdGEoZGF0dW0pLndpdGhfZGF0YV9oYXNoKGNzbC5oYXNoX3BsdXR1c19kYXRhKGRhdHVtKSkubmV4dCgpLndpdGhfdmFsdWUodmFsdWUpLmJ1aWxkKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvdXRwdXQgPSBjc2wuVHJhbnNhY3Rpb25PdXRwdXRCdWlsZGVyW1wibmV3XCJdKCkud2l0aF9hZGRyZXNzKGFkZHJlc3MpLm5leHQoKS53aXRoX3ZhbHVlKHZhbHVlKS5idWlsZCgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH07XG5cbiAgICB0aGlzLmNyZWF0ZVR4VW5zcGVudE91dHB1dCA9IGZ1bmN0aW9uIChhZGRyZXNzLCB1dHhvKSB7XG4gICAgICB2YXIgYW1vdW50ID0ge307XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdXR4by5hbW91bnQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHRoaXNBc3NldCA9IHV0eG8uYW1vdW50W2ldO1xuICAgICAgICBhbW91bnRbdGhpc0Fzc2V0LnVuaXRdID0gdGhpc0Fzc2V0LnF1YW50aXR5O1xuICAgICAgfVxuXG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gY3NsLlRyYW5zYWN0aW9uVW5zcGVudE91dHB1dFtcIm5ld1wiXShjc2wuVHJhbnNhY3Rpb25JbnB1dFtcIm5ld1wiXShjc2wuVHJhbnNhY3Rpb25IYXNoLmZyb21fYnl0ZXMoZnJvbUhleCh1dHhvLnR4X2hhc2gpKSwgdXR4by5vdXRwdXRfaW5kZXgpLCBjc2wuVHJhbnNhY3Rpb25PdXRwdXRbXCJuZXdcIl0oYWRkcmVzcywgYXNzZXRzVG9WYWx1ZShhbW91bnQpKSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiVW5leHBlY3RlZCBlcnJvciBpbiBjcmVhdGVUeFVuc3BlbnRPdXRwdXQuIFtNZXNzYWdlOiBcIiArIGVycm9yICsgXCJdXCIpO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy53YWxsZXQgPSB3YWxsZXQ7XG4gICAgdGhpcy5fYmxvY2tmcm9zdCA9IG5ldyBCbG9ja2Zyb3N0KCk7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gVHJhbnNhY3Rpb24ucHJvdG90eXBlO1xuXG4gIF9wcm90by5fZ2V0VHhCdWlsZGVyQ29uZmlnID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2dldFR4QnVpbGRlckNvbmZpZzIgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkge1xuICAgICAgdmFyIF9mcm9tRmxvYXQsIHByaWNlX21lbV9udW1lcmF0b3IsIHByaWNlX21lbV9kZW5vbWluYXRvciwgX2Zyb21GbG9hdDIsIHByaWNlX3N0ZXBfbnVtZXJhdG9yLCBwcmljZV9zdGVwX2Rlbm9taW5hdG9yLCB0eEJ1aWxkZXJDb25maWc7XG5cbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9ibG9ja2Zyb3N0LmVwb2Noc0xhdGVzdEVwb2NoUHJvdG9jb2xQYXJhbWV0ZXJzKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgdGhpcy5wcm90b2NvbFBhcmFtZXRlcnMgPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgICAgICBfZnJvbUZsb2F0ID0gZnJvbUZsb2F0KHRoaXMucHJvdG9jb2xQYXJhbWV0ZXJzLnByaWNlX21lbS50b1N0cmluZygpKSwgcHJpY2VfbWVtX251bWVyYXRvciA9IF9mcm9tRmxvYXQubnVtZXJhdG9yLCBwcmljZV9tZW1fZGVub21pbmF0b3IgPSBfZnJvbUZsb2F0LmRlbm9taW5hdG9yO1xuICAgICAgICAgICAgICBfZnJvbUZsb2F0MiA9IGZyb21GbG9hdCh0aGlzLnByb3RvY29sUGFyYW1ldGVycy5wcmljZV9zdGVwLnRvU3RyaW5nKCkpLCBwcmljZV9zdGVwX251bWVyYXRvciA9IF9mcm9tRmxvYXQyLm51bWVyYXRvciwgcHJpY2Vfc3RlcF9kZW5vbWluYXRvciA9IF9mcm9tRmxvYXQyLmRlbm9taW5hdG9yO1xuICAgICAgICAgICAgICB0eEJ1aWxkZXJDb25maWcgPSBjc2wuVHJhbnNhY3Rpb25CdWlsZGVyQ29uZmlnQnVpbGRlcltcIm5ld1wiXSgpLmNvaW5zX3Blcl91dHhvX2J5dGUoY3NsLkJpZ051bS5mcm9tX3N0cih0aGlzLnByb3RvY29sUGFyYW1ldGVycy5jb2luc19wZXJfdXR4b193b3JkKSkuZmVlX2FsZ28oY3NsLkxpbmVhckZlZVtcIm5ld1wiXShjc2wuQmlnTnVtLmZyb21fc3RyKHRoaXMucHJvdG9jb2xQYXJhbWV0ZXJzLm1pbl9mZWVfYS50b1N0cmluZygpKSwgY3NsLkJpZ051bS5mcm9tX3N0cih0aGlzLnByb3RvY29sUGFyYW1ldGVycy5taW5fZmVlX2IudG9TdHJpbmcoKSkpKS5rZXlfZGVwb3NpdChjc2wuQmlnTnVtLmZyb21fc3RyKHRoaXMucHJvdG9jb2xQYXJhbWV0ZXJzLmtleV9kZXBvc2l0KSkucG9vbF9kZXBvc2l0KGNzbC5CaWdOdW0uZnJvbV9zdHIodGhpcy5wcm90b2NvbFBhcmFtZXRlcnMucG9vbF9kZXBvc2l0KSkubWF4X3R4X3NpemUodGhpcy5wcm90b2NvbFBhcmFtZXRlcnMubWF4X3R4X3NpemUpLm1heF92YWx1ZV9zaXplKHBhcnNlSW50KHRoaXMucHJvdG9jb2xQYXJhbWV0ZXJzLm1heF92YWxfc2l6ZSkpLmV4X3VuaXRfcHJpY2VzKGNzbC5FeFVuaXRQcmljZXNbXCJuZXdcIl0oY3NsLlVuaXRJbnRlcnZhbFtcIm5ld1wiXShjc2wuQmlnTnVtLmZyb21fc3RyKHByaWNlX21lbV9udW1lcmF0b3IpLCBjc2wuQmlnTnVtLmZyb21fc3RyKHByaWNlX21lbV9kZW5vbWluYXRvcikpLCBjc2wuVW5pdEludGVydmFsW1wibmV3XCJdKGNzbC5CaWdOdW0uZnJvbV9zdHIocHJpY2Vfc3RlcF9udW1lcmF0b3IpLCBjc2wuQmlnTnVtLmZyb21fc3RyKHByaWNlX3N0ZXBfZGVub21pbmF0b3IpKSkpLmJ1aWxkKCk7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgdHhCdWlsZGVyQ29uZmlnKTtcblxuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gX2dldFR4QnVpbGRlckNvbmZpZygpIHtcbiAgICAgIHJldHVybiBfZ2V0VHhCdWlsZGVyQ29uZmlnMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBfZ2V0VHhCdWlsZGVyQ29uZmlnO1xuICB9KCk7XG5cbiAgX3Byb3RvLl9idWlsZFRyYW5zYWN0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2J1aWxkVHJhbnNhY3Rpb24yID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoX3JlZjMpIHtcbiAgICAgIHZhciB0eEJ1aWxkZXIsIHR4Qm9keSwgd2l0bmVzc2VzLCB0cmFuc2FjdGlvbiwgdHJhbnNhY3Rpb25CeXRlcywgdHJhbnNhY3Rpb25IZXg7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICB0eEJ1aWxkZXIgPSBfcmVmMy50eEJ1aWxkZXI7XG4gICAgICAgICAgICAgIHR4Qm9keSA9IHR4QnVpbGRlci5idWlsZCgpO1xuICAgICAgICAgICAgICB3aXRuZXNzZXMgPSBjc2wuVHJhbnNhY3Rpb25XaXRuZXNzU2V0W1wibmV3XCJdKCk7XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uID0gY3NsLlRyYW5zYWN0aW9uW1wibmV3XCJdKHR4Qm9keSwgd2l0bmVzc2VzKTtcbiAgICAgICAgICAgICAgdHJhbnNhY3Rpb25CeXRlcyA9IHRyYW5zYWN0aW9uLnRvX2J5dGVzKCk7XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uSGV4ID0gdG9IZXgodHJhbnNhY3Rpb25CeXRlcyk7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIHRyYW5zYWN0aW9uSGV4KTtcblxuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUyKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBfYnVpbGRUcmFuc2FjdGlvbihfeCkge1xuICAgICAgcmV0dXJuIF9idWlsZFRyYW5zYWN0aW9uMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBfYnVpbGRUcmFuc2FjdGlvbjtcbiAgfSgpO1xuXG4gIF9wcm90by5fYWRkQ2hhbmdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2FkZENoYW5nZTIgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhfcmVmNCkge1xuICAgICAgdmFyIHR4QnVpbGRlciwgY2hhbmdlQWRkcmVzcztcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIHR4QnVpbGRlciA9IF9yZWY0LnR4QnVpbGRlciwgY2hhbmdlQWRkcmVzcyA9IF9yZWY0LmNoYW5nZUFkZHJlc3M7XG5cbiAgICAgICAgICAgICAgaWYgKCEoY2hhbmdlQWRkcmVzcyA9PSB1bmRlZmluZWQpKSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA0O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy53YWxsZXQuZ2V0V2FsbGV0QWRkcmVzcygpO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgIGNoYW5nZUFkZHJlc3MgPSBfY29udGV4dDMuc2VudDtcblxuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICB0eEJ1aWxkZXIuYWRkX2NoYW5nZV9pZl9uZWVkZWQoU3RyaW5nVG9BZGRyZXNzKGNoYW5nZUFkZHJlc3MpKTtcblxuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUzLCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBfYWRkQ2hhbmdlKF94Mikge1xuICAgICAgcmV0dXJuIF9hZGRDaGFuZ2UyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIF9hZGRDaGFuZ2U7XG4gIH0oKTtcblxuICBfcHJvdG8uX2FkZE1ldGFkYXRhID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2FkZE1ldGFkYXRhMiA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KF9yZWY1KSB7XG4gICAgICB2YXIgdHhCdWlsZGVyLCBtZXRhZGF0YSwgYXV4RGF0YSwgZ2VuZXJhbE1ldGFkYXRhO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgdHhCdWlsZGVyID0gX3JlZjUudHhCdWlsZGVyLCBtZXRhZGF0YSA9IF9yZWY1Lm1ldGFkYXRhO1xuICAgICAgICAgICAgICBhdXhEYXRhID0gY3NsLkF1eGlsaWFyeURhdGFbXCJuZXdcIl0oKTtcbiAgICAgICAgICAgICAgZ2VuZXJhbE1ldGFkYXRhID0gY3NsLkdlbmVyYWxUcmFuc2FjdGlvbk1ldGFkYXRhW1wibmV3XCJdKCk7XG4gICAgICAgICAgICAgIGdlbmVyYWxNZXRhZGF0YS5pbnNlcnQoY3NsLkJpZ051bS5mcm9tX3N0cignMTAwJyksIGNzbC5lbmNvZGVfanNvbl9zdHJfdG9fbWV0YWRhdHVtKEpTT04uc3RyaW5naWZ5KG1ldGFkYXRhKSwgMSkpO1xuICAgICAgICAgICAgICBhdXhEYXRhLnNldF9tZXRhZGF0YShnZW5lcmFsTWV0YWRhdGEpO1xuICAgICAgICAgICAgICB0eEJ1aWxkZXIuc2V0X2F1eGlsaWFyeV9kYXRhKGF1eERhdGEpO1xuXG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTQpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIF9hZGRNZXRhZGF0YShfeDMpIHtcbiAgICAgIHJldHVybiBfYWRkTWV0YWRhdGEyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIF9hZGRNZXRhZGF0YTtcbiAgfSgpIC8vIGhlbHBlciBmdW5jdGlvbiB0byBzb3J0IHRoZSAybmQgaXRlbSBpbiBhcnJheVxuICA7XG5cbiAgX3Byb3RvLl9zb3J0RGVzY2VuZGluZ0FycmF5ID0gZnVuY3Rpb24gX3NvcnREZXNjZW5kaW5nQXJyYXkoYXJyYXkpIHtcbiAgICBhcnJheS5zb3J0KGZ1bmN0aW9uIChpLCBqKSB7XG4gICAgICByZXR1cm4galsxXSAtIGlbMV07XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLl9zZWxlY3RVdHhvc0ZvckxvdmVsYWNlID0gZnVuY3Rpb24gX3NlbGVjdFV0eG9zRm9yTG92ZWxhY2UoX3JlZjYpIHtcbiAgICB2YXIgdXR4b3NDb250YWluTG92ZWxhY2VBcnJheSA9IF9yZWY2LnV0eG9zQ29udGFpbkxvdmVsYWNlQXJyYXksXG4gICAgICAgIHJlbWFpbmluZ0xvdmVsYWNlID0gX3JlZjYucmVtYWluaW5nTG92ZWxhY2U7XG4gICAgdmFyIGNob3NlblV0eG9DYm9yU3RyaW5nTGlzdCA9IFtdO1xuXG4gICAgdGhpcy5fc29ydERlc2NlbmRpbmdBcnJheSh1dHhvc0NvbnRhaW5Mb3ZlbGFjZUFycmF5KTtcblxuICAgIGZvciAodmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2UodXR4b3NDb250YWluTG92ZWxhY2VBcnJheSksIF9zdGVwOyAhKF9zdGVwID0gX2l0ZXJhdG9yKCkpLmRvbmU7KSB7XG4gICAgICB2YXIgdSA9IF9zdGVwLnZhbHVlO1xuICAgICAgdmFyIGNib3IgPSB1WzBdO1xuICAgICAgdmFyIGFtb3VudExvdmVsYWNlID0gdVsxXTtcbiAgICAgIGNob3NlblV0eG9DYm9yU3RyaW5nTGlzdC5wdXNoKGNib3IpO1xuICAgICAgcmVtYWluaW5nTG92ZWxhY2UgLT0gYW1vdW50TG92ZWxhY2U7XG5cbiAgICAgIGlmIChyZW1haW5pbmdMb3ZlbGFjZSA8IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNob3NlblV0eG9DYm9yU3RyaW5nTGlzdDogY2hvc2VuVXR4b0Nib3JTdHJpbmdMaXN0LFxuICAgICAgcmVtYWluaW5nTG92ZWxhY2U6IHJlbWFpbmluZ0xvdmVsYWNlXG4gICAgfTtcbiAgfVxuICAvKipcclxuICAgKiB0b2RvczpcclxuICAgKiBnZXQgZW5vdWdoIGxvdmVsYWNlIGZvciBmZWVzLCBpbnN0ZWFkIG9mIGhhcmRjb2RlZFxyXG4gICAqIGdldCBlbm91Z2ggbG92ZWxhY2UgZm9yIGF0dGFjaGVkIGFzc2V0cywgaW5zdGVhZCBvZiBoYXJkY29kZWRcclxuICAgKiBpbXByb3ZlOiBsZXRzIHRyeSB0byBmaW5kIHRoZSBsYXJnZXN0IGxvdmVsYWNlL2Fzc2V0IHV0eG8ganVzdCBlbm91Z2ggdG8gZnVsZmlsbCB0eCwgaW5zdGVhZCBvZiBwaWNraW5nIHRoZSBsYXJnZXN0XHJcbiAgICovXG4gIDtcblxuICBfcHJvdG8uc2VsZWN0VXR4b0lucHV0cyA9XG4gIC8qI19fUFVSRV9fKi9cbiAgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfc2VsZWN0VXR4b0lucHV0cyA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KF9yZWY3KSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB2YXIgb3V0cHV0cywgX2RlYnVnLCBjaG9zZW5VdHhvQ2JvclN0cmluZ0xpc3QsIHJlbWFpbmluZ0xvdmVsYWNlLCByZW1haW5pbmdBc3NldHMsIHV0eG9EaWN0QnlDYm9yS2V5cywgdXR4b3MsIF9pdGVyYXRvcjIsIF9zdGVwMiwgb3V0cHV0LCBfYXNzZXRJZDIsIF9pdGVyYXRvcjMsIF9zdGVwMywgdXR4bywgX2xvb3AsIGFzc2V0SWQsIF9hc3NldElkLCB1dHhvc0NvbnRhaW5Mb3ZlbGFjZSwgc2VsZWN0ZWRMb3ZlbGFjZVV0eG9zLCBfdXR4b3NDb250YWluTG92ZWxhY2U7XG5cbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIG91dHB1dHMgPSBfcmVmNy5vdXRwdXRzO1xuICAgICAgICAgICAgICBfZGVidWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgY2hvc2VuVXR4b0Nib3JTdHJpbmdMaXN0ID0gW107IC8vIHRvIHJldHVybiBhbmQgdG8gc3RvcCByZXBlYXRlZCB1dHhvIHNlbGVjdGVkXG5cbiAgICAgICAgICAgICAgcmVtYWluaW5nTG92ZWxhY2UgPSAwOyAvLyB0byB0cmFjayBsb3ZlbGFjZVxuXG4gICAgICAgICAgICAgIHJlbWFpbmluZ0Fzc2V0cyA9IHt9OyAvLyB0byB0cmFjayBhc3NldHNcblxuICAgICAgICAgICAgICB1dHhvRGljdEJ5Q2JvcktleXMgPSB7fTsgLy8gZm9yIHF1aWNrIGxvb2sgdXBcblxuICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgKiAxLiBwcmVwYXJlXHJcbiAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA4O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy53YWxsZXQuZ2V0VXR4b3MoKTtcblxuICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICB1dHhvcyA9IF9jb250ZXh0NS5zZW50O1xuXG4gICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2Uob3V0cHV0cyk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMigpKS5kb25lOykge1xuICAgICAgICAgICAgICAgIG91dHB1dCA9IF9zdGVwMi52YWx1ZTtcblxuICAgICAgICAgICAgICAgIGZvciAoX2Fzc2V0SWQyIGluIG91dHB1dC5hc3NldHMpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChfYXNzZXRJZDIgPT09ICdsb3ZlbGFjZScpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nTG92ZWxhY2UgKz0gb3V0cHV0LmFzc2V0c1tfYXNzZXRJZDJdO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2Fzc2V0SWQyIGluIHJlbWFpbmluZ0Fzc2V0cykpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdBc3NldHNbX2Fzc2V0SWQyXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdBc3NldHNbX2Fzc2V0SWQyXSArPSBvdXRwdXQuYXNzZXRzW19hc3NldElkMl07XG4gICAgICAgICAgICAgICAgICAgIHJlbWFpbmluZ0xvdmVsYWNlICs9IHRvTG92ZWxhY2UoMik7IC8vIHRvZG86IGF0dGFjaGVkIEFEQSBmb3IgYXNzZXRzIGlzIGhhcmRjb2RlZFxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2UodXR4b3MpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMoKSkuZG9uZTspIHtcbiAgICAgICAgICAgICAgICB1dHhvID0gX3N0ZXAzLnZhbHVlO1xuICAgICAgICAgICAgICAgIHV0eG9EaWN0QnlDYm9yS2V5c1t1dHhvLmNib3JdID0gdXR4bztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJlbWFpbmluZ0xvdmVsYWNlICs9IHRvTG92ZWxhY2UoMSk7IC8vIHRvZG86IGhhcmRjb2RlZCBmb3IgZmVlc1xuXG4gICAgICAgICAgICAgIGlmIChfZGVidWcpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXR4b3MnLCB1dHhvcyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Fzc2V0cyByZXF1aXJlbWVudHMnLCByZW1haW5pbmdMb3ZlbGFjZSwgcmVtYWluaW5nQXNzZXRzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgKiAyLiBhZGQgYXNzZXRzIFVUWE9zXHJcbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgIC8vIDJhLiBmb3IgZWFjaCBhc3NldHMgaW4gcmVtYWluaW5nQXNzZXRzLCBsZXRzIGxvb2sgZm9yIHRoZWlyIHV0eG9zXG5cblxuICAgICAgICAgICAgICBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGFzc2V0SWQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVtYWluaW5nQXNzZXRzW2Fzc2V0SWRdID4gMCkge1xuICAgICAgICAgICAgICAgICAgdmFyIHV0eG9zQ29udGFpbkFzc2V0ID0gdXR4b3MuZmlsdGVyKGZ1bmN0aW9uICh1dHhvKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhY2hvc2VuVXR4b0Nib3JTdHJpbmdMaXN0LmluY2x1ZGVzKHV0eG8uY2JvcikgJiYgYXNzZXRJZCBpbiB1dHhvLmFzc2V0cztcbiAgICAgICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbiAodXR4bykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3V0eG8uY2JvciwgdXR4by5hc3NldHNbYXNzZXRJZF0sIHV0eG9dO1xuICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgIF90aGlzLl9zb3J0RGVzY2VuZGluZ0FycmF5KHV0eG9zQ29udGFpbkFzc2V0KTtcblxuICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yNCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2UodXR4b3NDb250YWluQXNzZXQpLCBfc3RlcDQ7ICEoX3N0ZXA0ID0gX2l0ZXJhdG9yNCgpKS5kb25lOykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdSA9IF9zdGVwNC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNib3IgPSB1WzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcXVhbnRpdHkgPSB1WzFdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3V0eG8gPSB1WzJdO1xuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdBc3NldHNbYXNzZXRJZF0gLT0gcXVhbnRpdHk7XG4gICAgICAgICAgICAgICAgICAgIGNob3NlblV0eG9DYm9yU3RyaW5nTGlzdC5wdXNoKGNib3IpO1xuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdMb3ZlbGFjZSAtPSBfdXR4by5hc3NldHMubG92ZWxhY2U7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbWFpbmluZ0Fzc2V0c1thc3NldElkXSA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgZm9yIChhc3NldElkIGluIHJlbWFpbmluZ0Fzc2V0cykge1xuICAgICAgICAgICAgICAgIF9sb29wKGFzc2V0SWQpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKF9kZWJ1Zykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tJyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FmdGVyIGFzc2V0cyBzZWxlY3Rpb24nLCB1dHhvcy5maWx0ZXIoZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBjaG9zZW5VdHhvQ2JvclN0cmluZ0xpc3QuaW5jbHVkZXModXR4by5jYm9yKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Fzc2V0cyByZW1haW5pbmcnLCByZW1haW5pbmdMb3ZlbGFjZSwgcmVtYWluaW5nQXNzZXRzKTtcbiAgICAgICAgICAgICAgfSAvLyAyYi4gaWYgbm90IGVub3VnaCB0byBmdWxmaWxsIHJlbWFpbmluZ0Fzc2V0cywgdGhyb3cgZXJyb3JcblxuXG4gICAgICAgICAgICAgIF9jb250ZXh0NS50MCA9IF9yZWdlbmVyYXRvclJ1bnRpbWUoKS5rZXlzKHJlbWFpbmluZ0Fzc2V0cyk7XG5cbiAgICAgICAgICAgIGNhc2UgMTc6XG4gICAgICAgICAgICAgIGlmICgoX2NvbnRleHQ1LnQxID0gX2NvbnRleHQ1LnQwKCkpLmRvbmUpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDIzO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2Fzc2V0SWQgPSBfY29udGV4dDUudDEudmFsdWU7XG5cbiAgICAgICAgICAgICAgaWYgKCEocmVtYWluaW5nQXNzZXRzW19hc3NldElkXSA+IDApKSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAyMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHRocm93IE1ha2VUeEVycm9yLk5vdEVub3VnaEFzc2V0c0lucHV0O1xuXG4gICAgICAgICAgICBjYXNlIDIxOlxuICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDE3O1xuICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAyMzpcbiAgICAgICAgICAgICAgaWYgKCEocmVtYWluaW5nTG92ZWxhY2UgPiAwKSkge1xuICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMzI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyAzYS4gbGV0cyB0cnkgdG8gZmluZCB1dHhvcyB0aGF0IGhhcyBvbmx5IGxvdmVsYWNlXG4gICAgICAgICAgICAgIHV0eG9zQ29udGFpbkxvdmVsYWNlID0gdXR4b3MuZmlsdGVyKGZ1bmN0aW9uICh1dHhvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICFjaG9zZW5VdHhvQ2JvclN0cmluZ0xpc3QuaW5jbHVkZXModXR4by5jYm9yKSAmJiBPYmplY3Qua2V5cyh1dHhvLmFzc2V0cykubGVuZ3RoID09PSAxO1xuICAgICAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW3V0eG8uY2JvciwgdXR4by5hc3NldHMubG92ZWxhY2VdO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgc2VsZWN0ZWRMb3ZlbGFjZVV0eG9zID0gdGhpcy5fc2VsZWN0VXR4b3NGb3JMb3ZlbGFjZSh7XG4gICAgICAgICAgICAgICAgdXR4b3NDb250YWluTG92ZWxhY2VBcnJheTogdXR4b3NDb250YWluTG92ZWxhY2UsXG4gICAgICAgICAgICAgICAgcmVtYWluaW5nTG92ZWxhY2U6IHJlbWFpbmluZ0xvdmVsYWNlXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGlmIChfZGVidWcpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLScpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhZnRlciBsb3ZlbGFjZSBzZWxlY3Rpb24gc3RlcCAxJywgdXR4b3MuZmlsdGVyKGZ1bmN0aW9uICh1dHhvKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRMb3ZlbGFjZVV0eG9zLmNob3NlblV0eG9DYm9yU3RyaW5nTGlzdC5pbmNsdWRlcyh1dHhvLmNib3IpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnYXNzZXRzIHJlbWFpbmluZycsIHNlbGVjdGVkTG92ZWxhY2VVdHhvcy5yZW1haW5pbmdMb3ZlbGFjZSk7XG4gICAgICAgICAgICAgIH0gLy8gM2IuIGlmIGNhbnQgZmluZCBhbnkgb3IgY2FudCBmaW5kIGVub3VnaCBsb3ZlbGFjZSwgbGV0cyBpbmNsdWRlIHV0eG9zIHRoYXQgYWxzbyBoYXMgYXNzZXRzXG5cblxuICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRMb3ZlbGFjZVV0eG9zLnJlbWFpbmluZ0xvdmVsYWNlID4gMCkge1xuICAgICAgICAgICAgICAgIF91dHhvc0NvbnRhaW5Mb3ZlbGFjZSA9IHV0eG9zLmZpbHRlcihmdW5jdGlvbiAodXR4bykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuICFjaG9zZW5VdHhvQ2JvclN0cmluZ0xpc3QuaW5jbHVkZXModXR4by5jYm9yKTtcbiAgICAgICAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBbdXR4by5jYm9yLCB1dHhvLmFzc2V0cy5sb3ZlbGFjZV07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRMb3ZlbGFjZVV0eG9zID0gdGhpcy5fc2VsZWN0VXR4b3NGb3JMb3ZlbGFjZSh7XG4gICAgICAgICAgICAgICAgICB1dHhvc0NvbnRhaW5Mb3ZlbGFjZUFycmF5OiBfdXR4b3NDb250YWluTG92ZWxhY2UsXG4gICAgICAgICAgICAgICAgICByZW1haW5pbmdMb3ZlbGFjZTogcmVtYWluaW5nTG92ZWxhY2VcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmIChfZGVidWcpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tJyk7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnYWZ0ZXIgbG92ZWxhY2Ugc2VsZWN0aW9uIHN0ZXAgMicsIHV0eG9zLmZpbHRlcihmdW5jdGlvbiAodXR4bykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRMb3ZlbGFjZVV0eG9zLmNob3NlblV0eG9DYm9yU3RyaW5nTGlzdC5pbmNsdWRlcyh1dHhvLmNib3IpO1xuICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Fzc2V0cyByZW1haW5pbmcnLCBzZWxlY3RlZExvdmVsYWNlVXR4b3MucmVtYWluaW5nTG92ZWxhY2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSAvLyAzYy4gaWYgc3RpbGwgbm90IGVub3VnaCBsb3ZlbGFjZSB0byBmdWxmaWxsIHR4LCB0aHJvdyBlcnJvclxuXG5cbiAgICAgICAgICAgICAgaWYgKCEoc2VsZWN0ZWRMb3ZlbGFjZVV0eG9zLnJlbWFpbmluZ0xvdmVsYWNlID4gMCkpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDMwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGhyb3cgTWFrZVR4RXJyb3IuTm90RW5vdWdoTG92ZWxhY2VJbnB1dDtcblxuICAgICAgICAgICAgY2FzZSAzMDpcbiAgICAgICAgICAgICAgLy8gM2QuIGlmIGFsbCBpcyB3ZWxsIHdpdGggbG92ZWxhY2VcbiAgICAgICAgICAgICAgY2hvc2VuVXR4b0Nib3JTdHJpbmdMaXN0LnB1c2guYXBwbHkoY2hvc2VuVXR4b0Nib3JTdHJpbmdMaXN0LCBzZWxlY3RlZExvdmVsYWNlVXR4b3MuY2hvc2VuVXR4b0Nib3JTdHJpbmdMaXN0KTtcbiAgICAgICAgICAgICAgcmVtYWluaW5nTG92ZWxhY2UgPSBzZWxlY3RlZExvdmVsYWNlVXR4b3MucmVtYWluaW5nTG92ZWxhY2U7XG5cbiAgICAgICAgICAgIGNhc2UgMzI6XG4gICAgICAgICAgICAgIGlmIChfZGVidWcpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLScpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmaW5hbCB1dHhvcyBzZWxlY3Rpb24nLCB1dHhvcy5maWx0ZXIoZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBjaG9zZW5VdHhvQ2JvclN0cmluZ0xpc3QuaW5jbHVkZXModXR4by5jYm9yKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Fzc2V0cyByZW1haW5pbmcnLCByZW1haW5pbmdMb3ZlbGFjZSwgcmVtYWluaW5nQXNzZXRzKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KFwicmV0dXJuXCIsIGNob3NlblV0eG9DYm9yU3RyaW5nTGlzdCk7XG5cbiAgICAgICAgICAgIGNhc2UgMzQ6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIHNlbGVjdFV0eG9JbnB1dHMoX3g0KSB7XG4gICAgICByZXR1cm4gX3NlbGVjdFV0eG9JbnB1dHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2VsZWN0VXR4b0lucHV0cztcbiAgfSgpO1xuXG4gIF9wcm90by5fYWRkSW5wdXRVdHhvID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2FkZElucHV0VXR4bzIgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNihfcmVmOCkge1xuICAgICAgdmFyIGlucHV0cywgb3V0cHV0cywgdHhJbnB1dHNCdWlsZGVyLCB1dHhvcztcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIGlucHV0cyA9IF9yZWY4LmlucHV0cywgb3V0cHV0cyA9IF9yZWY4Lm91dHB1dHM7XG5cbiAgICAgICAgICAgICAgaWYgKCEoaW5wdXRzLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDQ7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdFV0eG9JbnB1dHMoe1xuICAgICAgICAgICAgICAgIG91dHB1dHM6IG91dHB1dHNcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgaW5wdXRzID0gX2NvbnRleHQ2LnNlbnQ7XG5cbiAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgLy8gZW5kIFZlcnNpb24gM1xuXG4gICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAqIGZyb20gdGhlIGlucHV0cywgY3JlYXRlIFR4SW5wdXRzQnVpbGRlclxyXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICB0eElucHV0c0J1aWxkZXIgPSBjc2wuVHhJbnB1dHNCdWlsZGVyW1wibmV3XCJdKCk7XG4gICAgICAgICAgICAgIHV0eG9zID0gaW5wdXRzLm1hcChmdW5jdGlvbiAodXR4bykge1xuICAgICAgICAgICAgICAgIHJldHVybiBjc2wuVHJhbnNhY3Rpb25VbnNwZW50T3V0cHV0LmZyb21fYnl0ZXMoQnVmZmVyLmZyb20odXR4bywgJ2hleCcpKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHV0eG9zLmZvckVhY2goZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgICAgICAgICAgICB0eElucHV0c0J1aWxkZXIuYWRkX2lucHV0KHV0eG8ub3V0cHV0KCkuYWRkcmVzcygpLCB1dHhvLmlucHV0KCksIHV0eG8ub3V0cHV0KCkuYW1vdW50KCkpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoXCJyZXR1cm5cIiwgdHhJbnB1dHNCdWlsZGVyKTtcblxuICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU2LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBfYWRkSW5wdXRVdHhvKF94NSkge1xuICAgICAgcmV0dXJuIF9hZGRJbnB1dFV0eG8yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIF9hZGRJbnB1dFV0eG87XG4gIH0oKTtcblxuICBfcHJvdG8uX2FkZFBsdXR1cyA9IGZ1bmN0aW9uIF9hZGRQbHV0dXMoX3JlZjkpIHtcbiAgICBfb2JqZWN0RGVzdHJ1Y3R1cmluZ0VtcHR5KF9yZWY5KTtcbiAgfTtcblxuICBfcHJvdG8uX21ha2VNdWx0aUFzc2V0ID0gZnVuY3Rpb24gX21ha2VNdWx0aUFzc2V0KGFzc2V0cykge1xuICAgIHZhciBBc3NldHNNYXAgPSB7fTtcblxuICAgIGZvciAodmFyIF9pdGVyYXRvcjUgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlckxvb3NlKGFzc2V0cyksIF9zdGVwNTsgIShfc3RlcDUgPSBfaXRlcmF0b3I1KCkpLmRvbmU7KSB7XG4gICAgICB2YXIgX2Fzc2V0ID0gX3N0ZXA1LnZhbHVlO1xuICAgICAgdmFyIHVuaXQgPSBfYXNzZXQudW5pdCxcbiAgICAgICAgICBxdWFudGl0eSA9IF9hc3NldC5xdWFudGl0eTtcblxuICAgICAgdmFyIF91bml0JHNwbGl0ID0gdW5pdC5zcGxpdCgnLicpLFxuICAgICAgICAgIF9wb2xpY3kgPSBfdW5pdCRzcGxpdFswXSxcbiAgICAgICAgICBhc3NldE5hbWUgPSBfdW5pdCRzcGxpdFsxXTtcblxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KEFzc2V0c01hcFtfcG9saWN5XSkpIHtcbiAgICAgICAgQXNzZXRzTWFwW19wb2xpY3ldID0gW107XG4gICAgICB9XG5cbiAgICAgIEFzc2V0c01hcFtfcG9saWN5XS5wdXNoKHtcbiAgICAgICAgdW5pdDogQnVmZmVyLmZyb20oYXNzZXROYW1lLCAnYXNjaWknKS50b1N0cmluZygnaGV4JyksXG4gICAgICAgIHF1YW50aXR5OiBxdWFudGl0eVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyIG11bHRpQXNzZXQgPSBjc2wuTXVsdGlBc3NldFtcIm5ld1wiXSgpO1xuXG4gICAgZm9yICh2YXIgcG9saWN5IGluIEFzc2V0c01hcCkge1xuICAgICAgdmFyIFNjcmlwdEhhc2ggPSBjc2wuU2NyaXB0SGFzaC5mcm9tX2J5dGVzKEJ1ZmZlci5mcm9tKHBvbGljeSwgJ2hleCcpKTtcbiAgICAgIHZhciBBc3NldHMgPSBjc2wuQXNzZXRzW1wibmV3XCJdKCk7XG4gICAgICB2YXIgX2Fzc2V0cyA9IEFzc2V0c01hcFtwb2xpY3ldO1xuXG4gICAgICBmb3IgKHZhciBfaXRlcmF0b3I2ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXJMb29zZShfYXNzZXRzKSwgX3N0ZXA2OyAhKF9zdGVwNiA9IF9pdGVyYXRvcjYoKSkuZG9uZTspIHtcbiAgICAgICAgdmFyIGFzc2V0ID0gX3N0ZXA2LnZhbHVlO1xuICAgICAgICB2YXIgQXNzZXROYW1lID0gY3NsLkFzc2V0TmFtZVtcIm5ld1wiXShCdWZmZXIuZnJvbShhc3NldC51bml0LCAnaGV4JykpO1xuICAgICAgICB2YXIgQmlnTnVtID0gY3NsLkJpZ051bS5mcm9tX3N0cihhc3NldC5xdWFudGl0eS50b1N0cmluZygpKTtcbiAgICAgICAgQXNzZXRzLmluc2VydChBc3NldE5hbWUsIEJpZ051bSk7XG4gICAgICB9XG5cbiAgICAgIG11bHRpQXNzZXQuaW5zZXJ0KFNjcmlwdEhhc2gsIEFzc2V0cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG11bHRpQXNzZXQ7XG4gIH07XG5cbiAgX3Byb3RvLl9hZGRPdXRwdXRzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2FkZE91dHB1dHMyID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoX3JlZjEwKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdmFyIHR4QnVpbGRlciwgb3V0cHV0cywgb3duZXJBZGRyZXNzQmVjaDMyLCBkYXR1bUFzc2V0c0xpc3QsIHR4T3V0cHV0cywgaTtcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIHR4QnVpbGRlciA9IF9yZWYxMC50eEJ1aWxkZXIsIG91dHB1dHMgPSBfcmVmMTAub3V0cHV0cywgb3duZXJBZGRyZXNzQmVjaDMyID0gX3JlZjEwLm93bmVyQWRkcmVzc0JlY2gzMiwgZGF0dW1Bc3NldHNMaXN0ID0gX3JlZjEwLmRhdHVtQXNzZXRzTGlzdDtcbiAgICAgICAgICAgICAgdHhPdXRwdXRzID0gY3NsLlRyYW5zYWN0aW9uT3V0cHV0c1tcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICBvdXRwdXRzLm1hcChmdW5jdGlvbiAob3V0cHV0KSB7XG4gICAgICAgICAgICAgICAgaWYgKG91dHB1dC5hZGRyZXNzID09PSB1bmRlZmluZWQgfHwgb3V0cHV0LmFkZHJlc3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBNYWtlVHhFcnJvci5Ob1JlY2lwaWVudHNBZGRyZXNzO1xuICAgICAgICAgICAgICAgIH0gLy8gYWRkIGxvdmVsYWNlXG5cblxuICAgICAgICAgICAgICAgIHZhciBhbW91bnRMb3ZlbGFjZSA9IG91dHB1dC5hc3NldHMubG92ZWxhY2UgJiYgb3V0cHV0LmFzc2V0cy5sb3ZlbGFjZSA+IE1JTl9BREFfUkVRVUlSRURfV0lUSF9BU1NFVFMgPyBvdXRwdXQuYXNzZXRzLmxvdmVsYWNlIDogTUlOX0FEQV9SRVFVSVJFRF9XSVRIX0FTU0VUUzsgLy8gVE9ETywgY2Fubm90IGhhcmRjb2RlIDJBREEuIGlmIHRvbyBtYW55IGFzc2V0cywgMiBBREEgaXMgbm90IGVub3VnaFxuXG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dFZhbHVlID0gY3NsLlZhbHVlW1wibmV3XCJdKGNzbC5CaWdOdW0uZnJvbV9zdHIoYW1vdW50TG92ZWxhY2UudG9TdHJpbmcoKSkpOyAvLyBpZiBoYXZlIG5hdGl2ZSB0b2tlbnNcblxuICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhvdXRwdXQuYXNzZXRzKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGFzc2V0cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMob3V0cHV0LmFzc2V0cykubWFwKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjExID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNyhhc3NldElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NldElkICE9PSAnbG92ZWxhY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBhc3NldElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBvdXRwdXQuYXNzZXRzW2Fzc2V0SWRdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTcpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDcpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjExLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICB9KCkpO1xuXG4gICAgICAgICAgICAgICAgICB2YXIgbXVsdGlBc3NldCA9IF90aGlzMi5fbWFrZU11bHRpQXNzZXQoYXNzZXRzKTtcblxuICAgICAgICAgICAgICAgICAgb3V0cHV0VmFsdWUuc2V0X211bHRpYXNzZXQobXVsdGlBc3NldCk7XG4gICAgICAgICAgICAgICAgfSAvLyBsZXQgZGF0dW1IYXNoOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGRhdHVtID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmIChkYXR1bUFzc2V0c0xpc3QpIHtcbiAgICAgICAgICAgICAgICAgIGRhdHVtID0gX3RoaXMyLmNyZWF0ZURhdHVtKHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXJBZGRyZXNzQmVjaDMyOiBvd25lckFkZHJlc3NCZWNoMzIsXG4gICAgICAgICAgICAgICAgICAgIGFzc2V0czogZGF0dW1Bc3NldHNMaXN0XG4gICAgICAgICAgICAgICAgICB9KTsgLy8gZGF0dW1IYXNoID0gcGx1dHVzRGF0YVRvSGV4KGRhdHVtKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdGhpc091dHB1dCA9IF90aGlzMi5fY3JlYXRlVHhPdXRwdXQoe1xuICAgICAgICAgICAgICAgICAgYWRkcmVzczogU3RyaW5nVG9BZGRyZXNzKG91dHB1dC5hZGRyZXNzKSxcbiAgICAgICAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgIGRhdHVtOiBkYXR1bVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdHhPdXRwdXRzLmFkZCggLy8gY3NsLlRyYW5zYWN0aW9uT3V0cHV0Lm5ldyhTdHJpbmdUb0FkZHJlc3Mob3V0cHV0LmFkZHJlc3MpLCBvdXRwdXRWYWx1ZSlcbiAgICAgICAgICAgICAgICB0aGlzT3V0cHV0KTtcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHR4T3V0cHV0cy5sZW4oKTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdHhCdWlsZGVyLmFkZF9vdXRwdXQodHhPdXRwdXRzLmdldChpKSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU4KTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBfYWRkT3V0cHV0cyhfeDYpIHtcbiAgICAgIHJldHVybiBfYWRkT3V0cHV0czIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gX2FkZE91dHB1dHM7XG4gIH0oKTtcblxuICBfcHJvdG8uYnVpbGQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfYnVpbGQgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOShfcmVmMTIpIHtcbiAgICAgIHZhciBfcmVmMTIkaW5wdXRzLCBpbnB1dHMsIG91dHB1dHMsIHR0bCwgY2hhbmdlQWRkcmVzcywgbWV0YWRhdGEsIHBsdXR1c1NjcmlwdHMsIF9yZWYxMiRoYXNEYXR1bSwgaGFzRGF0dW0sIGJsb2NrZnJvc3RBcGlLZXksIG5ldHdvcmssIHR4QnVpbGRlciwgdHhJbnB1dHNCdWlsZGVyLCBkYXR1bUFzc2V0c0xpc3QsIF9pdGVyYXRvcjcsIF9zdGVwNywgb3V0cHV0LCB0cmFuc2FjdGlvbkhleDtcblxuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX3JlZjEyJGlucHV0cyA9IF9yZWYxMi5pbnB1dHMsIGlucHV0cyA9IF9yZWYxMiRpbnB1dHMgPT09IHZvaWQgMCA/IFtdIDogX3JlZjEyJGlucHV0cywgb3V0cHV0cyA9IF9yZWYxMi5vdXRwdXRzLCB0dGwgPSBfcmVmMTIudHRsLCBjaGFuZ2VBZGRyZXNzID0gX3JlZjEyLmNoYW5nZUFkZHJlc3MsIG1ldGFkYXRhID0gX3JlZjEyLm1ldGFkYXRhLCBwbHV0dXNTY3JpcHRzID0gX3JlZjEyLnBsdXR1c1NjcmlwdHMsIF9yZWYxMiRoYXNEYXR1bSA9IF9yZWYxMi5oYXNEYXR1bSwgaGFzRGF0dW0gPSBfcmVmMTIkaGFzRGF0dW0gPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjEyJGhhc0RhdHVtLCBibG9ja2Zyb3N0QXBpS2V5ID0gX3JlZjEyLmJsb2NrZnJvc3RBcGlLZXksIG5ldHdvcmsgPSBfcmVmMTIubmV0d29yaztcbiAgICAgICAgICAgICAgLy8gc3RhcnQ6IGluaXRcbiAgICAgICAgICAgICAgdGhpcy5fYmxvY2tmcm9zdCA9IG5ldyBCbG9ja2Zyb3N0KCk7XG4gICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNDtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Jsb2NrZnJvc3QuaW5pdCh7XG4gICAgICAgICAgICAgICAgYmxvY2tmcm9zdEFwaUtleTogYmxvY2tmcm9zdEFwaUtleSxcbiAgICAgICAgICAgICAgICBuZXR3b3JrOiBuZXR3b3JrXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgIF9jb250ZXh0OS50MCA9IGNzbC5UcmFuc2FjdGlvbkJ1aWxkZXI7XG4gICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNztcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFR4QnVpbGRlckNvbmZpZygpO1xuXG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgIF9jb250ZXh0OS50MSA9IF9jb250ZXh0OS5zZW50O1xuICAgICAgICAgICAgICB0eEJ1aWxkZXIgPSBfY29udGV4dDkudDBbXCJuZXdcIl0uY2FsbChfY29udGV4dDkudDAsIF9jb250ZXh0OS50MSk7XG5cbiAgICAgICAgICAgICAgLy8gZW5kOiBpbml0XG4gICAgICAgICAgICAgIGlmICh0dGwpIHtcbiAgICAgICAgICAgICAgICB0eEJ1aWxkZXIuc2V0X3R0bCh0dGwpO1xuICAgICAgICAgICAgICB9IC8vIGFkZCBpbnB1dHNcblxuXG4gICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hZGRJbnB1dFV0eG8oe1xuICAgICAgICAgICAgICAgIGlucHV0czogaW5wdXRzLFxuICAgICAgICAgICAgICAgIG91dHB1dHM6IG91dHB1dHNcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgIHR4SW5wdXRzQnVpbGRlciA9IF9jb250ZXh0OS5zZW50O1xuICAgICAgICAgICAgICAvLyBpZiBkYXR1bVxuICAgICAgICAgICAgICBkYXR1bUFzc2V0c0xpc3QgPSBudWxsO1xuXG4gICAgICAgICAgICAgIGlmIChoYXNEYXR1bSkge1xuICAgICAgICAgICAgICAgIGRhdHVtQXNzZXRzTGlzdCA9IFtdO1xuXG4gICAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3I3ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXJMb29zZShvdXRwdXRzKTsgIShfc3RlcDcgPSBfaXRlcmF0b3I3KCkpLmRvbmU7KSB7XG4gICAgICAgICAgICAgICAgICBvdXRwdXQgPSBfc3RlcDcudmFsdWU7XG4gICAgICAgICAgICAgICAgICBkYXR1bUFzc2V0c0xpc3QgPSBbXS5jb25jYXQoT2JqZWN0LmtleXMob3V0cHV0LmFzc2V0cykpO1xuICAgICAgICAgICAgICAgICAgZGF0dW1Bc3NldHNMaXN0ID0gZGF0dW1Bc3NldHNMaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsICE9ICdsb3ZlbGFjZSc7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZGF0dW1Bc3NldHNMaXN0JywgZGF0dW1Bc3NldHNMaXN0KTsgLy8gW1wiZHM4ZGg5czhkaHMuUGl4ZWxcIl1cbiAgICAgICAgICAgICAgfSAvLyBhZGQgb3V0cHV0c1xuXG5cbiAgICAgICAgICAgICAgX2NvbnRleHQ5LnQyID0gdGhpcztcbiAgICAgICAgICAgICAgX2NvbnRleHQ5LnQzID0gdHhCdWlsZGVyO1xuICAgICAgICAgICAgICBfY29udGV4dDkudDQgPSBvdXRwdXRzO1xuICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDIwO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy53YWxsZXQuZ2V0V2FsbGV0QWRkcmVzcygpO1xuXG4gICAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgICBfY29udGV4dDkudDUgPSBfY29udGV4dDkuc2VudDtcbiAgICAgICAgICAgICAgX2NvbnRleHQ5LnQ2ID0gZGF0dW1Bc3NldHNMaXN0O1xuICAgICAgICAgICAgICBfY29udGV4dDkudDcgPSB7XG4gICAgICAgICAgICAgICAgdHhCdWlsZGVyOiBfY29udGV4dDkudDMsXG4gICAgICAgICAgICAgICAgb3V0cHV0czogX2NvbnRleHQ5LnQ0LFxuICAgICAgICAgICAgICAgIG93bmVyQWRkcmVzc0JlY2gzMjogX2NvbnRleHQ5LnQ1LFxuICAgICAgICAgICAgICAgIGRhdHVtQXNzZXRzTGlzdDogX2NvbnRleHQ5LnQ2XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjU7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkudDIuX2FkZE91dHB1dHMuY2FsbChfY29udGV4dDkudDIsIF9jb250ZXh0OS50Nyk7XG5cbiAgICAgICAgICAgIGNhc2UgMjU6XG5cblxuICAgICAgICAgICAgICBpZiAoIW1ldGFkYXRhKSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAyOTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjk7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hZGRNZXRhZGF0YSh7XG4gICAgICAgICAgICAgICAgdHhCdWlsZGVyOiB0eEJ1aWxkZXIsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IG1ldGFkYXRhXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDI5OlxuICAgICAgICAgICAgICBpZiAoIXBsdXR1c1NjcmlwdHMpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDMyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAzMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FkZFBsdXR1cyh7fSk7XG5cbiAgICAgICAgICAgIGNhc2UgMzI6XG4gICAgICAgICAgICAgIHR4QnVpbGRlci5zZXRfaW5wdXRzKHR4SW5wdXRzQnVpbGRlcik7IC8vIGFkZCBjaGFuZ2VcblxuICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDM1O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYWRkQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICB0eEJ1aWxkZXI6IHR4QnVpbGRlcixcbiAgICAgICAgICAgICAgICBjaGFuZ2VBZGRyZXNzOiBjaGFuZ2VBZGRyZXNzXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDM1OlxuICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDM3O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYnVpbGRUcmFuc2FjdGlvbih7XG4gICAgICAgICAgICAgICAgdHhCdWlsZGVyOiB0eEJ1aWxkZXJcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uSGV4ID0gX2NvbnRleHQ5LnNlbnQ7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KFwicmV0dXJuXCIsIHRyYW5zYWN0aW9uSGV4KTtcblxuICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlOSwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gYnVpbGQoX3g4KSB7XG4gICAgICByZXR1cm4gX2J1aWxkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1aWxkO1xuICB9KClcbiAgLyoqXHJcbiAgICogZm9yIHNtYXJ0IGNvbnRyYWN0XHJcbiAgICogdGhpcyBpcyBmb3IgZGV2dCBvbmx5LCB3aWxsIG5lZWQgdG8gcmVmYWN0b3IgZXZlcnl0aGluZyBldmVudHVhbGx5XHJcbiAgICovXG4gIDtcblxuICBfcHJvdG8uZmluYWxpemVUeCA9XG4gIC8qI19fUFVSRV9fKi9cbiAgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZmluYWxpemVUeCA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMChfcmVmMTMpIHtcbiAgICAgIHZhciB0eEJ1aWxkZXIsIGNoYW5nZUFkZHJlc3M7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgdHhCdWlsZGVyID0gX3JlZjEzLnR4QnVpbGRlciwgY2hhbmdlQWRkcmVzcyA9IF9yZWYxMy5jaGFuZ2VBZGRyZXNzO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0eEJ1aWxkZXIsIGNoYW5nZUFkZHJlc3MpO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUxMCk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZmluYWxpemVUeChfeDkpIHtcbiAgICAgIHJldHVybiBfZmluYWxpemVUeC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBmaW5hbGl6ZVR4O1xuICB9KCk7XG5cbiAgX3Byb3RvLmNyZWF0ZURhdHVtID0gZnVuY3Rpb24gY3JlYXRlRGF0dW0oX3JlZjE0KSB7XG4gICAgdmFyIG93bmVyQWRkcmVzc0JlY2gzMiA9IF9yZWYxNC5vd25lckFkZHJlc3NCZWNoMzIsXG4gICAgICAgIGFzc2V0cyA9IF9yZWYxNC5hc3NldHM7XG4gICAgdmFyIGZpZWxkcyA9IGNzbC5QbHV0dXNMaXN0W1wibmV3XCJdKCk7XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3I4ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXJMb29zZShhc3NldHMpLCBfc3RlcDg7ICEoX3N0ZXA4ID0gX2l0ZXJhdG9yOCgpKS5kb25lOykge1xuICAgICAgdmFyIGFzc2V0ID0gX3N0ZXA4LnZhbHVlO1xuICAgICAgdmFyIGFzc2V0RGV0YWlscyA9IGNzbC5QbHV0dXNMaXN0W1wibmV3XCJdKCk7XG5cbiAgICAgIHZhciBfYXNzZXQkc3BsaXQgPSBhc3NldC5zcGxpdCgnLicpLFxuICAgICAgICAgIHBvbGljeSA9IF9hc3NldCRzcGxpdFswXSxcbiAgICAgICAgICBhc3NldE5hbWUgPSBfYXNzZXQkc3BsaXRbMV07XG5cbiAgICAgIGFzc2V0RGV0YWlscy5hZGQoY3NsLlBsdXR1c0RhdGEubmV3X2J5dGVzKGZyb21IZXgocG9saWN5KSkpO1xuICAgICAgYXNzZXREZXRhaWxzLmFkZChjc2wuUGx1dHVzRGF0YS5uZXdfYnl0ZXMoZnJvbUhleCh0b0hleChhc3NldE5hbWUpKSkpO1xuICAgICAgZmllbGRzLmFkZChjc2wuUGx1dHVzRGF0YS5uZXdfY29uc3RyX3BsdXR1c19kYXRhKGNzbC5Db25zdHJQbHV0dXNEYXRhW1wibmV3XCJdKGNzbC5CaWdOdW0uZnJvbV9zdHIoJzAnKSwgYXNzZXREZXRhaWxzKSkpO1xuICAgIH1cblxuICAgIHZhciBvd25lciA9IGdldEFkZHJlc3NLZXlIYXNoSGV4KG93bmVyQWRkcmVzc0JlY2gzMik7XG5cbiAgICBpZiAob3duZXIpIHtcbiAgICAgIGZpZWxkcy5hZGQoY3NsLlBsdXR1c0RhdGEubmV3X2J5dGVzKGZyb21IZXgob3duZXIpKSk7XG4gICAgfVxuXG4gICAgdmFyIGRhdHVtID0gY3NsLlBsdXR1c0RhdGEubmV3X2NvbnN0cl9wbHV0dXNfZGF0YShjc2wuQ29uc3RyUGx1dHVzRGF0YVtcIm5ld1wiXShjc2wuQmlnTnVtLmZyb21fc3RyKCcwJyksIGZpZWxkcykpO1xuICAgIHJldHVybiBkYXR1bTtcbiAgfTtcblxuICBfcHJvdG8uX2FkZElucHV0VXR4b1NDID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2FkZElucHV0VXR4b1NDMiA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMShfcmVmMTUpIHtcbiAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICB2YXIgc2NyaXB0QWRkcmVzcywgYXNzZXQsIHV0eG9zRnJvbUJGLCB1dHhvcywgdHhJbnB1dHNCdWlsZGVyO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIHNjcmlwdEFkZHJlc3MgPSBfcmVmMTUuc2NyaXB0QWRkcmVzcywgYXNzZXQgPSBfcmVmMTUuYXNzZXQ7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDM7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9ibG9ja2Zyb3N0LmFkZHJlc3Nlc0FkZHJlc3NVdHhvc0Fzc2V0KHtcbiAgICAgICAgICAgICAgICBhZGRyZXNzOiBzY3JpcHRBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFzc2V0OiBhc3NldFxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICB1dHhvc0Zyb21CRiA9IF9jb250ZXh0MTEuc2VudDtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3V0eG9zRnJvbUJGJywgdXR4b3NGcm9tQkYpO1xuICAgICAgICAgICAgICB1dHhvcyA9IHV0eG9zRnJvbUJGLmZpbHRlcihmdW5jdGlvbiAodXR4bykge1xuICAgICAgICAgICAgICAgIHJldHVybiB1dHhvLmRhdGFfaGFzaCAhPT0gbnVsbDtcbiAgICAgICAgICAgICAgfSkubWFwKGZ1bmN0aW9uICh1dHhvQkYpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHhvdXRwdXQgPSBfdGhpczMuY3JlYXRlVHhVbnNwZW50T3V0cHV0KFN0cmluZ1RvQWRkcmVzcyhzY3JpcHRBZGRyZXNzKSwgdXR4b0JGKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0eG91dHB1dDtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHR4SW5wdXRzQnVpbGRlciA9IGNzbC5UeElucHV0c0J1aWxkZXJbXCJuZXdcIl0oKTsgLy8gdXR4b3MuZm9yRWFjaCgodXR4bzogYW55KSA9PiB7XG4gICAgICAgICAgICAgIC8vICAgdHhJbnB1dHNCdWlsZGVyLmFkZF9pbnB1dChcbiAgICAgICAgICAgICAgLy8gICAgIHV0eG8ub3V0cHV0KCkuYWRkcmVzcygpLFxuICAgICAgICAgICAgICAvLyAgICAgdXR4by5pbnB1dCgpLFxuICAgICAgICAgICAgICAvLyAgICAgdXR4by5vdXRwdXQoKS5hbW91bnQoKVxuICAgICAgICAgICAgICAvLyAgICk7XG4gICAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICAgIHR4SW5wdXRzQnVpbGRlci5hZGRfaW5wdXQodXR4b3NbMF0ub3V0cHV0KCkuYWRkcmVzcygpLCB1dHhvc1swXS5pbnB1dCgpLCB1dHhvc1swXS5vdXRwdXQoKS5hbW91bnQoKSk7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdChcInJldHVyblwiLCB7XG4gICAgICAgICAgICAgICAgdHhJbnB1dHNCdWlsZGVyOiB0eElucHV0c0J1aWxkZXIsXG4gICAgICAgICAgICAgICAgdXR4b3NlbGVjdGVkOiB1dHhvc1swXVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTEsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIF9hZGRJbnB1dFV0eG9TQyhfeDEwKSB7XG4gICAgICByZXR1cm4gX2FkZElucHV0VXR4b1NDMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBfYWRkSW5wdXRVdHhvU0M7XG4gIH0oKSAvLyB0aGlzIGlzIGZvciBkZXZ0IG9ubHksIHdpbGwgbmVlZCB0byByZWZhY3RvciBldmVyeXRoaW5nIGV2ZW50dWFsbHlcbiAgO1xuXG4gIF9wcm90by5idWlsZFNDID1cbiAgLyojX19QVVJFX18qL1xuICBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9idWlsZFNDID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKF9yZWYxNikge1xuICAgICAgdmFyIG93bmVyQWRkcmVzcywgc2NyaXB0QWRkcmVzcywgYXNzZXRzLCBibG9ja2Zyb3N0QXBpS2V5LCBuZXR3b3JrLCB0eEJ1aWxkZXIsIGRhdHVtLCBkYXR1bUhhc2gsIG91dHB1dHMsIGFzc2V0LCBfYXNzZXQkc3BsaXQyLCBwb2xpY3ksIGFzc2V0TmFtZSwgX3lpZWxkJHRoaXMkX2FkZElucHV0LCB0eElucHV0c0J1aWxkZXIsIHV0eG9zZWxlY3RlZCwgc2NyaXB0V2l0bmVzcywgdHJhbnNhY3Rpb25IZXg7XG5cbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTIucHJldiA9IF9jb250ZXh0MTIubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBvd25lckFkZHJlc3MgPSBfcmVmMTYub3duZXJBZGRyZXNzLCBzY3JpcHRBZGRyZXNzID0gX3JlZjE2LnNjcmlwdEFkZHJlc3MsIGFzc2V0cyA9IF9yZWYxNi5hc3NldHMsIGJsb2NrZnJvc3RBcGlLZXkgPSBfcmVmMTYuYmxvY2tmcm9zdEFwaUtleSwgbmV0d29yayA9IF9yZWYxNi5uZXR3b3JrO1xuICAgICAgICAgICAgICAvLyBzdGFydDogaW5pdFxuICAgICAgICAgICAgICB0aGlzLl9ibG9ja2Zyb3N0ID0gbmV3IEJsb2NrZnJvc3QoKTtcbiAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gNDtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Jsb2NrZnJvc3QuaW5pdCh7XG4gICAgICAgICAgICAgICAgYmxvY2tmcm9zdEFwaUtleTogYmxvY2tmcm9zdEFwaUtleSxcbiAgICAgICAgICAgICAgICBuZXR3b3JrOiBuZXR3b3JrXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgIF9jb250ZXh0MTIudDAgPSBjc2wuVHJhbnNhY3Rpb25CdWlsZGVyO1xuICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSA3O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VHhCdWlsZGVyQ29uZmlnKCk7XG5cbiAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgX2NvbnRleHQxMi50MSA9IF9jb250ZXh0MTIuc2VudDtcbiAgICAgICAgICAgICAgdHhCdWlsZGVyID0gX2NvbnRleHQxMi50MFtcIm5ld1wiXS5jYWxsKF9jb250ZXh0MTIudDAsIF9jb250ZXh0MTIudDEpO1xuICAgICAgICAgICAgICAvLyBlbmQ6IGluaXRcbiAgICAgICAgICAgICAgLy8gcHJlcGFyZSBkYXR1bVxuICAgICAgICAgICAgICBkYXR1bSA9IHRoaXMuY3JlYXRlRGF0dW0oe1xuICAgICAgICAgICAgICAgIG93bmVyQWRkcmVzc0JlY2gzMjogb3duZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFzc2V0czogYXNzZXRzXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBkYXR1bUhhc2ggPSBwbHV0dXNEYXRhVG9IZXgoZGF0dW0pO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZGF0dW1IYXNoJywgZGF0dW1IYXNoKTsgLy8gb3V0cHV0c1xuXG4gICAgICAgICAgICAgIG91dHB1dHMgPSBbe1xuICAgICAgICAgICAgICAgIGFkZHJlc3M6IG93bmVyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBhc3NldHM6IHt9LFxuICAgICAgICAgICAgICAgIGRhdHVtOiBkYXR1bVxuICAgICAgICAgICAgICB9XTtcbiAgICAgICAgICAgICAgYXNzZXQgPSBudWxsO1xuICAgICAgICAgICAgICBhc3NldHMubWFwKGZ1bmN0aW9uIChhc3NldElkKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0c1swXS5hc3NldHNbYXNzZXRJZF0gPSAxO1xuICAgICAgICAgICAgICAgIGFzc2V0ID0gYXNzZXRJZDtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIG91dHB1dHNbMF0uYXNzZXRzWydsb3ZlbGFjZSddID0gMzAwMDAwMDtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coNDQsICdvdXRwdXRzJywgb3V0cHV0cyk7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDE5O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYWRkT3V0cHV0cyh7XG4gICAgICAgICAgICAgICAgdHhCdWlsZGVyOiB0eEJ1aWxkZXIsXG4gICAgICAgICAgICAgICAgb3V0cHV0czogb3V0cHV0c1xuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICAgICAgLy8gaW5wdXRzXG4gICAgICAgICAgICAgIF9hc3NldCRzcGxpdDIgPSBhc3NldC5zcGxpdCgnLicpLCBwb2xpY3kgPSBfYXNzZXQkc3BsaXQyWzBdLCBhc3NldE5hbWUgPSBfYXNzZXQkc3BsaXQyWzFdO1xuICAgICAgICAgICAgICBhc3NldCA9IFwiXCIgKyBwb2xpY3kgKyB0b0hleChhc3NldE5hbWUpO1xuICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAyMztcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FkZElucHV0VXR4b1NDKHtcbiAgICAgICAgICAgICAgICBzY3JpcHRBZGRyZXNzOiBzY3JpcHRBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFzc2V0OiBhc3NldFxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSAyMzpcbiAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkX2FkZElucHV0ID0gX2NvbnRleHQxMi5zZW50O1xuICAgICAgICAgICAgICB0eElucHV0c0J1aWxkZXIgPSBfeWllbGQkdGhpcyRfYWRkSW5wdXQudHhJbnB1dHNCdWlsZGVyO1xuICAgICAgICAgICAgICB1dHhvc2VsZWN0ZWQgPSBfeWllbGQkdGhpcyRfYWRkSW5wdXQudXR4b3NlbGVjdGVkO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygyMik7XG4gICAgICAgICAgICAgIHNjcmlwdFdpdG5lc3MgPSB0aGlzLmdldFBsdXR1c1dpdG5lc3MoY3NsLlBsdXR1c1NjcmlwdFtcIm5ld1wiXShmcm9tSGV4KCc0ZTRkMDEwMDAwMzMyMjIyMjAwNTEyMDAxMjAwMTEnKSksIGRhdHVtLCB0aGlzLnVubG9jaywgdXR4b3NlbGVjdGVkKTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coMzMpO1xuICAgICAgICAgICAgICB0eElucHV0c0J1aWxkZXIuYWRkX3BsdXR1c19zY3JpcHRfaW5wdXQoc2NyaXB0V2l0bmVzcywgdXR4b3NlbGVjdGVkLmlucHV0KCksIHV0eG9zZWxlY3RlZC5vdXRwdXQoKS5hbW91bnQoKSk7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKDQ0KTtcbiAgICAgICAgICAgICAgdHhCdWlsZGVyLnNldF9pbnB1dHModHhJbnB1dHNCdWlsZGVyKTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coNDQpOyAvLyBoZXJlIHRvIGZpbmFsaXplVHhcblxuICAgICAgICAgICAgICB0eEJ1aWxkZXIuY2FsY19zY3JpcHRfZGF0YV9oYXNoKGNzbC5UeEJ1aWxkZXJDb25zdGFudHMucGx1dHVzX3Zhc2lsX2Nvc3RfbW9kZWxzKCkpO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyg1NSk7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDM3O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYWRkQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICB0eEJ1aWxkZXI6IHR4QnVpbGRlcixcbiAgICAgICAgICAgICAgICBjaGFuZ2VBZGRyZXNzOiBvd25lckFkZHJlc3NcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKDY2KTtcbiAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gNDA7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9idWlsZFRyYW5zYWN0aW9uKHtcbiAgICAgICAgICAgICAgICB0eEJ1aWxkZXI6IHR4QnVpbGRlclxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgdHJhbnNhY3Rpb25IZXggPSBfY29udGV4dDEyLnNlbnQ7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKDc3KTtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuYWJydXB0KFwicmV0dXJuXCIsIHRyYW5zYWN0aW9uSGV4KTtcblxuICAgICAgICAgICAgY2FzZSA0MzpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTEyLCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBidWlsZFNDKF94MTEpIHtcbiAgICAgIHJldHVybiBfYnVpbGRTQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBidWlsZFNDO1xuICB9KCk7XG5cbiAgX3Byb3RvLnVubG9jayA9IGZ1bmN0aW9uIHVubG9jayhpbmRleCkge1xuICAgIHZhciBkYXRhID0gY3NsLlBsdXR1c0RhdGEubmV3X2NvbnN0cl9wbHV0dXNfZGF0YShjc2wuQ29uc3RyUGx1dHVzRGF0YVtcIm5ld1wiXShjc2wuQmlnTnVtLmZyb21fc3RyKCcwJyksIGNzbC5QbHV0dXNMaXN0W1wibmV3XCJdKCkpKTtcbiAgICB2YXIgcmVkZWVtZXIgPSBjc2wuUmVkZWVtZXJbXCJuZXdcIl0oY3NsLlJlZGVlbWVyVGFnLm5ld19zcGVuZCgpLCBjc2wuQmlnTnVtLmZyb21fc3RyKGluZGV4KSwgZGF0YSwgY3NsLkV4VW5pdHNbXCJuZXdcIl0oY3NsLkJpZ051bS5mcm9tX3N0cignNzAwMDAwMCcpLCBjc2wuQmlnTnVtLmZyb21fc3RyKCczMDAwMDAwMDAwJykpKTtcbiAgICByZXR1cm4gcmVkZWVtZXI7XG4gIH07XG5cbiAgX3Byb3RvLnNldENvbGxhdGVyYWwgPSBmdW5jdGlvbiBzZXRDb2xsYXRlcmFsKHR4QnVpbGRlciwgdXR4b3MpIHtcbiAgICB2YXIgaW5wdXRCdWlsZGVyID0gY3NsLlR4SW5wdXRzQnVpbGRlcltcIm5ld1wiXSgpO1xuICAgIHV0eG9zLmZvckVhY2goZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgIGlucHV0QnVpbGRlci5hZGRfaW5wdXQodXR4by5vdXRwdXQoKS5hZGRyZXNzKCksIHV0eG8uaW5wdXQoKSwgdXR4by5vdXRwdXQoKS5hbW91bnQoKSk7XG4gICAgfSk7XG4gICAgdHhCdWlsZGVyLnNldF9jb2xsYXRlcmFsKGlucHV0QnVpbGRlcik7XG4gIH07XG5cbiAgX3Byb3RvLmdldFBsdXR1c1dpdG5lc3MgPSBmdW5jdGlvbiBnZXRQbHV0dXNXaXRuZXNzKHNjcmlwdCwgZGF0dW0sIHJlZGVlbWVyLCB1dHhvKSB7XG4gICAgcmV0dXJuIGNzbC5QbHV0dXNXaXRuZXNzW1wibmV3XCJdKHNjcmlwdCwgZGF0dW0sIHJlZGVlbWVyKHV0eG8uaW5wdXQoKS5pbmRleCgpLnRvU3RyaW5nKCkpKTtcbiAgfTtcblxuICBfcHJvdG8uZ2V0UmVxdWlyZWRTaWduZXJzID0gZnVuY3Rpb24gZ2V0UmVxdWlyZWRTaWduZXJzKHV0eG9zLCBzY3JpcHRJbnB1dCwgY29sbGF0ZXJhbCkge1xuICAgIHZhciBpbnB1dHMgPSBbXS5jb25jYXQodXR4b3MsIGNvbGxhdGVyYWwpO1xuICAgIHZhciBhZGRyZXNzZXMgPSBuZXcgU2V0KCk7XG4gICAgaW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgIGFkZHJlc3Nlcy5hZGQodXR4by5vdXRwdXQoKS5hZGRyZXNzKCkudG9fYmVjaDMyKCkpO1xuICAgIH0pO1xuICAgIGFkZHJlc3Nlc1tcImRlbGV0ZVwiXShzY3JpcHRJbnB1dC5vdXRwdXQoKS5hZGRyZXNzKCkudG9fYmVjaDMyKCkpO1xuICAgIHZhciByZXF1aXJlZFNpZ25lcnMgPSBjc2wuRWQyNTUxOUtleUhhc2hlc1tcIm5ld1wiXSgpO1xuICAgIGFkZHJlc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICB2YXIga2V5SGFzaCA9IGdldEFkZHJlc3NLZXlIYXNoKGFkZHJlc3MpO1xuXG4gICAgICBpZiAoa2V5SGFzaCkge1xuICAgICAgICByZXF1aXJlZFNpZ25lcnMuYWRkKGtleUhhc2gpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXF1aXJlZFNpZ25lcnM7XG4gIH07XG5cbiAgX3Byb3RvLmdldENvbGxhdGVyYWwgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0Q29sbGF0ZXJhbCA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMygpIHtcbiAgICAgIHZhciBjb2xsYXRVdHhvcywgY29sbGF0ZXJhbCwgX2l0ZXJhdG9yOSwgX3N0ZXA5LCB4LCB1dHhvO1xuXG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgY29sbGF0VXR4b3MgPSBbXTtcbiAgICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gMztcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMud2FsbGV0LmdldENvbGxhdGVyYWwoKTtcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICBjb2xsYXRlcmFsID0gX2NvbnRleHQxMy5zZW50O1xuXG4gICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yOSA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2UoY29sbGF0ZXJhbCk7ICEoX3N0ZXA5ID0gX2l0ZXJhdG9yOSgpKS5kb25lOykge1xuICAgICAgICAgICAgICAgIHggPSBfc3RlcDkudmFsdWU7XG4gICAgICAgICAgICAgICAgdXR4byA9IGNzbC5UcmFuc2FjdGlvblVuc3BlbnRPdXRwdXQuZnJvbV9ieXRlcyhCdWZmZXIuZnJvbSh4LCAnaGV4JykpO1xuICAgICAgICAgICAgICAgIGNvbGxhdFV0eG9zLnB1c2godXR4byk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5hYnJ1cHQoXCJyZXR1cm5cIiwgY29sbGF0VXR4b3MpO1xuXG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUxMywgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZ2V0Q29sbGF0ZXJhbCgpIHtcbiAgICAgIHJldHVybiBfZ2V0Q29sbGF0ZXJhbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBnZXRDb2xsYXRlcmFsO1xuICB9KCk7XG5cbiAgX3Byb3RvLmJ1aWxkU0N2MiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9idWlsZFNDdiA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNChfcmVmMTcpIHtcbiAgICAgIHZhciBvd25lckFkZHJlc3MsIHNjcmlwdEFkZHJlc3MsIGJsb2NrZnJvc3RBcGlLZXksIG5ldHdvcmssIHR4QnVpbGRlciwgc2NyaXB0QWRkcmVzc09iaiwgc2hlbGxleUNoYW5nZUFkZHJlc3MsIGFzc2V0TmFtZSwgYXNzZXROYW1lSGV4LCBhc3NldEFtb3VudFRvU2VuZCwgYXNzZXRQb2xpY3lJZEhleCwgdHJhbnNhY3Rpb25JZExvY2tlZCwgbG92ZWxhY2VMb2NrZWQsIHBsdXR1c1NjcmlwdENib3JIZXgsIHRyYW5zYWN0aW9uSW5keExvY2tlZCwgbWFudWFsRmVlLCBtdWx0aUFzc2V0LCBhc3NldHMsIHNjcmlwdHMsIHR4T3V0cHV0QnVpbGRlciwgd2FsbGV0VXR4b3MsIHV0eG9zLCB0cmFuc2FjdGlvblVuc3BlbnRPdXRwdXRzLCB0eEJvZHksIGNvbGxhdGVyYWwsIGlucHV0cywgZGF0dW0sIGRhdHVtSGFzaCwgZGF0dW1zLCByZWRlZW1lcnMsIGRhdGEsIHJlZGVlbWVyLCB0cmFuc2FjdGlvbldpdG5lc3NTZXQsIGNvc3RfbW9kZWxfdmFscywgY29zdE1vZGVsLCBjb3N0TW9kZWxzLCBzY3JpcHREYXRhSGFzaCwgYmFzZUFkZHJlc3MsIHJlcXVpcmVkU2lnbmVycywgdHJhbnNhY3Rpb24sIHRyYW5zYWN0aW9uQnl0ZXMsIHRyYW5zYWN0aW9uSGV4O1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNCQoX2NvbnRleHQxNCkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNC5wcmV2ID0gX2NvbnRleHQxNC5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIG93bmVyQWRkcmVzcyA9IF9yZWYxNy5vd25lckFkZHJlc3MsIHNjcmlwdEFkZHJlc3MgPSBfcmVmMTcuc2NyaXB0QWRkcmVzcywgYmxvY2tmcm9zdEFwaUtleSA9IF9yZWYxNy5ibG9ja2Zyb3N0QXBpS2V5LCBuZXR3b3JrID0gX3JlZjE3Lm5ldHdvcms7XG4gICAgICAgICAgICAgIC8vIHN0YXJ0OiBpbml0XG4gICAgICAgICAgICAgIHRoaXMuX2Jsb2NrZnJvc3QgPSBuZXcgQmxvY2tmcm9zdCgpO1xuICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSA0O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmxvY2tmcm9zdC5pbml0KHtcbiAgICAgICAgICAgICAgICBibG9ja2Zyb3N0QXBpS2V5OiBibG9ja2Zyb3N0QXBpS2V5LFxuICAgICAgICAgICAgICAgIG5ldHdvcms6IG5ldHdvcmtcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgX2NvbnRleHQxNC50MCA9IGNzbC5UcmFuc2FjdGlvbkJ1aWxkZXI7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDc7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRUeEJ1aWxkZXJDb25maWcoKTtcblxuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICBfY29udGV4dDE0LnQxID0gX2NvbnRleHQxNC5zZW50O1xuICAgICAgICAgICAgICB0eEJ1aWxkZXIgPSBfY29udGV4dDE0LnQwW1wibmV3XCJdLmNhbGwoX2NvbnRleHQxNC50MCwgX2NvbnRleHQxNC50MSk7XG4gICAgICAgICAgICAgIC8vIGVuZDogaW5pdFxuICAgICAgICAgICAgICBzY3JpcHRBZGRyZXNzT2JqID0gU3RyaW5nVG9BZGRyZXNzKHNjcmlwdEFkZHJlc3MpO1xuICAgICAgICAgICAgICBzaGVsbGV5Q2hhbmdlQWRkcmVzcyA9IFN0cmluZ1RvQWRkcmVzcyhvd25lckFkZHJlc3MpO1xuICAgICAgICAgICAgICBhc3NldE5hbWUgPSAnU09DSUVUWSc7XG4gICAgICAgICAgICAgIGFzc2V0TmFtZUhleCA9IHRvSGV4KGFzc2V0TmFtZSk7XG4gICAgICAgICAgICAgIGFzc2V0QW1vdW50VG9TZW5kID0gMTtcbiAgICAgICAgICAgICAgYXNzZXRQb2xpY3lJZEhleCA9ICdmNTdmMTQ1ZmI4ZGQ4MzczZGFmZjdjZjU1Y2VhMTgxNjY5ZTk5YzRiNzMzMjg1MzFlYmQ0NDE5YSc7XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uSWRMb2NrZWQgPSAnM2MwZmM0Nzc0ZTUyOTQzMmIyZWFhNjU0NzIwMjMxYWQ2YzZkOTJhZTJhNGE3YWIyNTQ0YTkzZGNmYTNjODU2MSc7XG4gICAgICAgICAgICAgIGxvdmVsYWNlTG9ja2VkID0gMzAwMDAwMDtcbiAgICAgICAgICAgICAgcGx1dHVzU2NyaXB0Q2JvckhleCA9ICc0ZTRkMDEwMDAwMzMyMjIyMjAwNTEyMDAxMjAwMTEnO1xuICAgICAgICAgICAgICB0cmFuc2FjdGlvbkluZHhMb2NrZWQgPSAwO1xuICAgICAgICAgICAgICBtYW51YWxGZWUgPSA5MDAwMDA7XG4gICAgICAgICAgICAgIG11bHRpQXNzZXQgPSBjc2wuTXVsdGlBc3NldFtcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICBhc3NldHMgPSBjc2wuQXNzZXRzW1wibmV3XCJdKCk7XG4gICAgICAgICAgICAgIGFzc2V0cy5pbnNlcnQoY3NsLkFzc2V0TmFtZVtcIm5ld1wiXShCdWZmZXIuZnJvbShhc3NldE5hbWVIZXgsICdoZXgnKSksIC8vIEFzc2V0IE5hbWVcbiAgICAgICAgICAgICAgY3NsLkJpZ051bS5mcm9tX3N0cihhc3NldEFtb3VudFRvU2VuZC50b1N0cmluZygpKSAvLyBIb3cgbXVjaCB0byBzZW5kXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIG11bHRpQXNzZXQuaW5zZXJ0KGNzbC5TY3JpcHRIYXNoLmZyb21fYnl0ZXMoQnVmZmVyLmZyb20oYXNzZXRQb2xpY3lJZEhleCwgJ2hleCcpKSwgLy8gUG9saWN5SURcbiAgICAgICAgICAgICAgYXNzZXRzKTtcbiAgICAgICAgICAgICAgdHhCdWlsZGVyLmFkZF9pbnB1dChzY3JpcHRBZGRyZXNzT2JqLCBjc2wuVHJhbnNhY3Rpb25JbnB1dFtcIm5ld1wiXShjc2wuVHJhbnNhY3Rpb25IYXNoLmZyb21fYnl0ZXMoQnVmZmVyLmZyb20odHJhbnNhY3Rpb25JZExvY2tlZCwgJ2hleCcpKSwgdHJhbnNhY3Rpb25JbmR4TG9ja2VkKSwgY3NsLlZhbHVlLm5ld19mcm9tX2Fzc2V0cyhtdWx0aUFzc2V0KSk7IC8vIGhvdyBtdWNoIGxvdmVsYWNlIGlzIGF0IHRoYXQgVVRYT1xuXG4gICAgICAgICAgICAgIHR4QnVpbGRlci5zZXRfZmVlKGNzbC5CaWdOdW0uZnJvbV9zdHIoTnVtYmVyKG1hbnVhbEZlZSkudG9TdHJpbmcoKSkpO1xuICAgICAgICAgICAgICBzY3JpcHRzID0gY3NsLlBsdXR1c1NjcmlwdHNbXCJuZXdcIl0oKTtcbiAgICAgICAgICAgICAgc2NyaXB0cy5hZGQoY3NsLlBsdXR1c1NjcmlwdC5mcm9tX2J5dGVzKEJ1ZmZlci5mcm9tKHBsdXR1c1NjcmlwdENib3JIZXgsICdoZXgnKSkpOyAvL2Zyb20gY2JvciBvZiBwbHV0dXMgc2NyaXB0XG4gICAgICAgICAgICAgIC8vIEFkZCBvdXRwdXRzXG5cbiAgICAgICAgICAgICAgdHhPdXRwdXRCdWlsZGVyID0gY3NsLlRyYW5zYWN0aW9uT3V0cHV0QnVpbGRlcltcIm5ld1wiXSgpLndpdGhfYWRkcmVzcyhzaGVsbGV5Q2hhbmdlQWRkcmVzcykubmV4dCgpLndpdGhfY29pbl9hbmRfYXNzZXQoY3NsLkJpZ051bS5mcm9tX3N0cihsb3ZlbGFjZUxvY2tlZC50b1N0cmluZygpKSwgbXVsdGlBc3NldCkuYnVpbGQoKTtcbiAgICAgICAgICAgICAgdHhCdWlsZGVyLmFkZF9vdXRwdXQodHhPdXRwdXRCdWlsZGVyKTsgLy8gYWRkIHV0eG9zIGZyb20gdXNlclxuXG4gICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDMyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy53YWxsZXQuZ2V0VXR4b3MoKTtcblxuICAgICAgICAgICAgY2FzZSAzMjpcbiAgICAgICAgICAgICAgd2FsbGV0VXR4b3MgPSBfY29udGV4dDE0LnNlbnQ7XG4gICAgICAgICAgICAgIHV0eG9zID0gd2FsbGV0VXR4b3MubWFwKGZ1bmN0aW9uICh1dHhvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNzbC5UcmFuc2FjdGlvblVuc3BlbnRPdXRwdXQuZnJvbV9ieXRlcyhCdWZmZXIuZnJvbSh1dHhvLmNib3IsICdoZXgnKSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB0cmFuc2FjdGlvblVuc3BlbnRPdXRwdXRzID0gY3NsLlRyYW5zYWN0aW9uVW5zcGVudE91dHB1dHNbXCJuZXdcIl0oKTtcbiAgICAgICAgICAgICAgdXR4b3MuZm9yRWFjaChmdW5jdGlvbiAodXR4bykge1xuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVW5zcGVudE91dHB1dHMuYWRkKHV0eG8pO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgdHhCdWlsZGVyLmFkZF9pbnB1dHNfZnJvbSh0cmFuc2FjdGlvblVuc3BlbnRPdXRwdXRzLCBjc2wuQ29pblNlbGVjdGlvblN0cmF0ZWd5Q0lQMi5MYXJnZXN0Rmlyc3RNdWx0aUFzc2V0KTsgLy90eEJ1aWxkZXIuYWRkX2NoYW5nZV9pZl9uZWVkZWQoc2hlbGxleUNoYW5nZUFkZHJlc3MpO1xuICAgICAgICAgICAgICAvLyBvbmNlIHRoZSB0cmFuc2FjdGlvbiBpcyByZWFkeSwgd2UgYnVpbGQgaXQgdG8gZ2V0IHRoZSB0eCBib2R5IHdpdGhvdXQgd2l0bmVzc2VzXG5cbiAgICAgICAgICAgICAgdHhCb2R5ID0gdHhCdWlsZGVyLmJ1aWxkKCk7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDQwO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2xsYXRlcmFsKCk7XG5cbiAgICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICAgIGNvbGxhdGVyYWwgPSBfY29udGV4dDE0LnNlbnQ7XG4gICAgICAgICAgICAgIGlucHV0cyA9IGNzbC5UcmFuc2FjdGlvbklucHV0c1tcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICBjb2xsYXRlcmFsLmZvckVhY2goZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgICAgICAgICAgICBpbnB1dHMuYWRkKHV0eG8uaW5wdXQoKSk7XG4gICAgICAgICAgICAgIH0pOyAvLyBtYWtlIGRhdHVtXG5cbiAgICAgICAgICAgICAgZGF0dW0gPSB0aGlzLmNyZWF0ZURhdHVtKHtcbiAgICAgICAgICAgICAgICBvd25lckFkZHJlc3NCZWNoMzI6IG93bmVyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBhc3NldHM6IFthc3NldFBvbGljeUlkSGV4ICsgXCIuXCIgKyBhc3NldE5hbWVdXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBkYXR1bUhhc2ggPSBwbHV0dXNEYXRhVG9IZXgoZGF0dW0pO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZGF0dW1IYXNoJywgZGF0dW1IYXNoKTtcbiAgICAgICAgICAgICAgZGF0dW1zID0gY3NsLlBsdXR1c0xpc3RbXCJuZXdcIl0oKTsgLy8gZGF0dW1zLmFkZChQbHV0dXNEYXRhLmZyb21fYnl0ZXMoQnVmZmVyLmZyb20odGhpcy5zdGF0ZS5kYXR1bVN0ciwgXCJ1dGY4XCIpKSlcblxuICAgICAgICAgICAgICBkYXR1bXMuYWRkKGRhdHVtKTtcbiAgICAgICAgICAgICAgcmVkZWVtZXJzID0gY3NsLlJlZGVlbWVyc1tcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICBkYXRhID0gY3NsLlBsdXR1c0RhdGEubmV3X2NvbnN0cl9wbHV0dXNfZGF0YShjc2wuQ29uc3RyUGx1dHVzRGF0YVtcIm5ld1wiXShjc2wuQmlnTnVtLmZyb21fc3RyKCcwJyksIGNzbC5QbHV0dXNMaXN0W1wibmV3XCJdKCkpKTtcbiAgICAgICAgICAgICAgcmVkZWVtZXIgPSBjc2wuUmVkZWVtZXJbXCJuZXdcIl0oY3NsLlJlZGVlbWVyVGFnLm5ld19zcGVuZCgpLCBjc2wuQmlnTnVtLmZyb21fc3RyKCcwJyksIGRhdGEsIGNzbC5FeFVuaXRzW1wibmV3XCJdKGNzbC5CaWdOdW0uZnJvbV9zdHIoJzcwMDAwMDAnKSwgY3NsLkJpZ051bS5mcm9tX3N0cignMzAwMDAwMDAwMCcpKSk7XG4gICAgICAgICAgICAgIHJlZGVlbWVycy5hZGQocmVkZWVtZXIpOyAvLyBUeCB3aXRuZXNzXG5cbiAgICAgICAgICAgICAgdHJhbnNhY3Rpb25XaXRuZXNzU2V0ID0gY3NsLlRyYW5zYWN0aW9uV2l0bmVzc1NldFtcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICB0cmFuc2FjdGlvbldpdG5lc3NTZXQuc2V0X3BsdXR1c19zY3JpcHRzKHNjcmlwdHMpO1xuICAgICAgICAgICAgICB0cmFuc2FjdGlvbldpdG5lc3NTZXQuc2V0X3BsdXR1c19kYXRhKGRhdHVtcyk7XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uV2l0bmVzc1NldC5zZXRfcmVkZWVtZXJzKHJlZGVlbWVycyk7IC8vIFByZSBWYXNpbCBoYXJkIGZvcmsgY29zdCBtb2RlbFxuICAgICAgICAgICAgICAvLyBjb25zdCBjb3N0X21vZGVsX3ZhbHMgPSBbMTk3MjA5LCAwLCAxLCAxLCAzOTYyMzEsIDYyMSwgMCwgMSwgMTUwMDAwLCAxMDAwLCAwLCAxLCAxNTAwMDAsIDMyLCAyNDc3NzM2LCAyOTE3NSwgNCwgMjk3NzMsIDEwMCwgMjk3NzMsIDEwMCwgMjk3NzMsIDEwMCwgMjk3NzMsIDEwMCwgMjk3NzMsIDEwMCwgMjk3NzMsIDEwMCwgMTAwLCAxMDAsIDI5NzczLCAxMDAsIDE1MDAwMCwgMzIsIDE1MDAwMCwgMzIsIDE1MDAwMCwgMzIsIDE1MDAwMCwgMTAwMCwgMCwgMSwgMTUwMDAwLCAzMiwgMTUwMDAwLCAxMDAwLCAwLCA4LCAxNDgwMDAsIDQyNTUwNywgMTE4LCAwLCAxLCAxLCAxNTAwMDAsIDEwMDAsIDAsIDgsIDE1MDAwMCwgMTEyNTM2LCAyNDcsIDEsIDE1MDAwMCwgMTAwMDAsIDEsIDEzNjU0MiwgMTMyNiwgMSwgMTAwMCwgMTUwMDAwLCAxMDAwLCAxLCAxNTAwMDAsIDMyLCAxNTAwMDAsIDMyLCAxNTAwMDAsIDMyLCAxLCAxLCAxNTAwMDAsIDEsIDE1MDAwMCwgNCwgMTAzNTk5LCAyNDgsIDEsIDEwMzU5OSwgMjQ4LCAxLCAxNDUyNzYsIDEzNjYsIDEsIDE3OTY5MCwgNDk3LCAxLCAxNTAwMDAsIDMyLCAxNTAwMDAsIDMyLCAxNTAwMDAsIDMyLCAxNTAwMDAsIDMyLCAxNTAwMDAsIDMyLCAxNTAwMDAsIDMyLCAxNDgwMDAsIDQyNTUwNywgMTE4LCAwLCAxLCAxLCA2MTUxNiwgMTEyMTgsIDAsIDEsIDE1MDAwMCwgMzIsIDE0ODAwMCwgNDI1NTA3LCAxMTgsIDAsIDEsIDEsIDE0ODAwMCwgNDI1NTA3LCAxMTgsIDAsIDEsIDEsIDI0Nzc3MzYsIDI5MTc1LCA0LCAwLCA4MjM2MywgNCwgMTUwMDAwLCA1MDAwLCAwLCAxLCAxNTAwMDAsIDMyLCAxOTcyMDksIDAsIDEsIDEsIDE1MDAwMCwgMzIsIDE1MDAwMCwgMzIsIDE1MDAwMCwgMzIsIDE1MDAwMCwgMzIsIDE1MDAwMCwgMzIsIDE1MDAwMCwgMzIsIDE1MDAwMCwgMzIsIDMzNDU4MzEsIDEsIDFdO1xuXG4gICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICAgIFBvc3QgVmFzaWwgaGFyZCBmb3JrIGNvc3QgbW9kZWxcclxuICAgICAgICAgICAgICAgICAgSWYgeW91IG5lZWQgdG8gbWFrZSB0aGlzIGNvZGUgd29yayBvbiB0aGUgTWFpbm5uZXQsIGJlZm9yZSBWYXNpbCBoYXJkLWZvcmtcclxuICAgICAgICAgICAgICAgICAgVGhlbiB5b3UgbmVlZCB0byBjb21tZW50IHRoaXMgc2VjdGlvbiBiZWxvdyBhbmQgdW5jb21tZW50IHRoZSBjb3N0IG1vZGVsIGFib3ZlXHJcbiAgICAgICAgICAgICAgICAgIE90aGVyd2lzZSBpdCB3aWxsIGdpdmUgZXJyb3JzIHdoZW4gcmVkZWVtaW5nIGZyb20gU2NyaXB0c1xyXG4gICAgICAgICAgICAgICAgICBTZW5kaW5nIGFzc2V0cyBhbmQgYWRhIHRvIFNjcmlwdCBhZGRyZXNzZXMgaXMgdW5hZmZlY3RlZCBieSB0aGlzIGNvc3QgbW9kZWxcclxuICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgY29zdF9tb2RlbF92YWxzID0gWzIwNTY2NSwgODEyLCAxLCAxLCAxMDAwLCA1NzEsIDAsIDEsIDEwMDAsIDI0MTc3LCA0LCAxLCAxMDAwLCAzMiwgMTE3MzY2LCAxMDQ3NSwgNCwgMjMwMDAsIDEwMCwgMjMwMDAsIDEwMCwgMjMwMDAsIDEwMCwgMjMwMDAsIDEwMCwgMjMwMDAsIDEwMCwgMjMwMDAsIDEwMCwgMTAwLCAxMDAsIDIzMDAwLCAxMDAsIDE5NTM3LCAzMiwgMTc1MzU0LCAzMiwgNDY0MTcsIDQsIDIyMTk3MywgNTExLCAwLCAxLCA4OTE0MSwgMzIsIDQ5NzUyNSwgMTQwNjgsIDQsIDIsIDE5NjUwMCwgNDUzMjQwLCAyMjAsIDAsIDEsIDEsIDEwMDAsIDI4NjYyLCA0LCAyLCAyNDUwMDAsIDIxNjc3MywgNjIsIDEsIDEwNjAzNjcsIDEyNTg2LCAxLCAyMDg1MTIsIDQyMSwgMSwgMTg3MDAwLCAxMDAwLCA1Mjk5OCwgMSwgODA0MzYsIDMyLCA0MzI0OSwgMzIsIDEwMDAsIDMyLCA4MDU1NiwgMSwgNTc2NjcsIDQsIDEwMDAsIDEwLCAxOTcxNDUsIDE1NiwgMSwgMTk3MTQ1LCAxNTYsIDEsIDIwNDkyNCwgNDczLCAxLCAyMDg4OTYsIDUxMSwgMSwgNTI0NjcsIDMyLCA2NDgzMiwgMzIsIDY1NDkzLCAzMiwgMjI1NTgsIDMyLCAxNjU2MywgMzIsIDc2NTExLCAzMiwgMTk2NTAwLCA0NTMyNDAsIDIyMCwgMCwgMSwgMSwgNjk1MjIsIDExNjg3LCAwLCAxLCA2MDA5MSwgMzIsIDE5NjUwMCwgNDUzMjQwLCAyMjAsIDAsIDEsIDEsIDE5NjUwMCwgNDUzMjQwLCAyMjAsIDAsIDEsIDEsIDgwNjk5MCwgMzA0ODIsIDQsIDE5Mjc5MjYsIDgyNTIzLCA0LCAyNjUzMTgsIDAsIDQsIDAsIDg1OTMxLCAzMiwgMjA1NjY1LCA4MTIsIDEsIDEsIDQxMTgyLCAzMiwgMjEyMzQyLCAzMiwgMzEyMjAsIDMyLCAzMjY5NiwgMzIsIDQzMzU3LCAzMiwgMzIyNDcsIDMyLCAzODMxNCwgMzIsIDk0NjI3MTMsIDEwMjEsIDEwXTtcbiAgICAgICAgICAgICAgY29zdE1vZGVsID0gY3NsLkNvc3RNb2RlbFtcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICBjb3N0X21vZGVsX3ZhbHMuZm9yRWFjaChmdW5jdGlvbiAoeCwgaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb3N0TW9kZWwuc2V0KGksIGNzbC5JbnQubmV3X2kzMih4KSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBjb3N0TW9kZWxzID0gY3NsLkNvc3RtZGxzW1wibmV3XCJdKCk7XG4gICAgICAgICAgICAgIGNvc3RNb2RlbHMuaW5zZXJ0KGNzbC5MYW5ndWFnZS5uZXdfcGx1dHVzX3YxKCksIGNvc3RNb2RlbCk7XG4gICAgICAgICAgICAgIHNjcmlwdERhdGFIYXNoID0gY3NsLmhhc2hfc2NyaXB0X2RhdGEocmVkZWVtZXJzLCBjb3N0TW9kZWxzLCBkYXR1bXMpO1xuICAgICAgICAgICAgICB0eEJvZHkuc2V0X3NjcmlwdF9kYXRhX2hhc2goc2NyaXB0RGF0YUhhc2gpO1xuICAgICAgICAgICAgICB0eEJvZHkuc2V0X2NvbGxhdGVyYWwoaW5wdXRzKTtcbiAgICAgICAgICAgICAgYmFzZUFkZHJlc3MgPSBjc2wuQmFzZUFkZHJlc3MuZnJvbV9hZGRyZXNzKHNoZWxsZXlDaGFuZ2VBZGRyZXNzKTtcbiAgICAgICAgICAgICAgcmVxdWlyZWRTaWduZXJzID0gY3NsLkVkMjU1MTlLZXlIYXNoZXNbXCJuZXdcIl0oKTtcbiAgICAgICAgICAgICAgcmVxdWlyZWRTaWduZXJzLmFkZChiYXNlQWRkcmVzcyA9PSBudWxsID8gdm9pZCAwIDogYmFzZUFkZHJlc3MucGF5bWVudF9jcmVkKCkudG9fa2V5aGFzaCgpKTtcbiAgICAgICAgICAgICAgdHhCb2R5LnNldF9yZXF1aXJlZF9zaWduZXJzKHJlcXVpcmVkU2lnbmVycyk7XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uID0gY3NsLlRyYW5zYWN0aW9uW1wibmV3XCJdKHR4Qm9keSwgY3NsLlRyYW5zYWN0aW9uV2l0bmVzc1NldC5mcm9tX2J5dGVzKHRyYW5zYWN0aW9uV2l0bmVzc1NldC50b19ieXRlcygpKSk7XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uQnl0ZXMgPSB0cmFuc2FjdGlvbi50b19ieXRlcygpO1xuICAgICAgICAgICAgICB0cmFuc2FjdGlvbkhleCA9IHRvSGV4KHRyYW5zYWN0aW9uQnl0ZXMpO1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5hYnJ1cHQoXCJyZXR1cm5cIiwgdHJhbnNhY3Rpb25IZXgpO1xuXG4gICAgICAgICAgICBjYXNlIDcyOlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTQsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGJ1aWxkU0N2MihfeDEyKSB7XG4gICAgICByZXR1cm4gX2J1aWxkU0N2LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1aWxkU0N2MjtcbiAgfSgpO1xuXG4gIF9wcm90by5fZ2V0QXNzZXRVdHhvID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2dldEFzc2V0VXR4bzIgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTUoX3JlZjE4KSB7XG4gICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgICAgdmFyIHNjcmlwdEFkZHJlc3MsIGFzc2V0LCB1dHhvc0Zyb21CRiwgdXR4b3M7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE1JChfY29udGV4dDE1KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDE1LnByZXYgPSBfY29udGV4dDE1Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgc2NyaXB0QWRkcmVzcyA9IF9yZWYxOC5zY3JpcHRBZGRyZXNzLCBhc3NldCA9IF9yZWYxOC5hc3NldDtcbiAgICAgICAgICAgICAgX2NvbnRleHQxNS5uZXh0ID0gMztcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Jsb2NrZnJvc3QuYWRkcmVzc2VzQWRkcmVzc1V0eG9zQXNzZXQoe1xuICAgICAgICAgICAgICAgIGFkZHJlc3M6IHNjcmlwdEFkZHJlc3MsXG4gICAgICAgICAgICAgICAgYXNzZXQ6IGFzc2V0XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIHV0eG9zRnJvbUJGID0gX2NvbnRleHQxNS5zZW50O1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXR4b3NGcm9tQkYnLCB1dHhvc0Zyb21CRik7XG4gICAgICAgICAgICAgIHV0eG9zID0gdXR4b3NGcm9tQkYuZmlsdGVyKGZ1bmN0aW9uICh1dHhvKSB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHV0eG8uZGF0YV9oYXNoICE9PSBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiB1dHhvLmRhdGFfaGFzaCA9PSBcIjI4N2JiOTZiMWIyYjg2NjU4Y2FlN2E1YTJjMTBhOGU2NjYzZjcxMGE3ZTBhYTlkZjdiNDM5ODkxYmU2ZWRlOGNcIjtcbiAgICAgICAgICAgICAgfSkubWFwKGZ1bmN0aW9uICh1dHhvQkYpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHhvdXRwdXQgPSBfdGhpczQuY3JlYXRlVHhVbnNwZW50T3V0cHV0KFN0cmluZ1RvQWRkcmVzcyhzY3JpcHRBZGRyZXNzKSwgdXR4b0JGKTtcblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0eG91dHB1dCcsIHR4b3V0cHV0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHhvdXRwdXQ7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNS5hYnJ1cHQoXCJyZXR1cm5cIiwgdXR4b3NbMF0pO1xuXG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE1LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUxNSwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gX2dldEFzc2V0VXR4byhfeDEzKSB7XG4gICAgICByZXR1cm4gX2dldEFzc2V0VXR4bzIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gX2dldEFzc2V0VXR4bztcbiAgfSgpO1xuXG4gIF9wcm90by5idWlsZFNDdjMgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfYnVpbGRTQ3YyID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE2KF9yZWYxOSkge1xuICAgICAgdmFyIF9hc3NldHMyO1xuXG4gICAgICB2YXIgb3duZXJBZGRyZXNzLCBzY3JpcHRBZGRyZXNzLCBibG9ja2Zyb3N0QXBpS2V5LCBuZXR3b3JrLCB0eEJ1aWxkZXIsIGFzc2V0TmFtZSwgYXNzZXROYW1lSGV4LCBhc3NldFBvbGljeUlkSGV4LCBhc3NldFV0eG8sIHdhbGxldFV0eG9zLCB1dHhvcywgdHJhbnNhY3Rpb25VbnNwZW50T3V0cHV0cywgaW5wdXRzLCBvdXRwdXRzLCBwbHV0dXNTY3JpcHRzLCBkYXR1bSwgZGF0dW1IYXNoLCBkYXR1bXMsIHR4SW5wdXRzQnVpbGRlciwgcGx1dHVzV2l0bmVzcywgY29sbGF0ZXJhbCwgcmVxdWlyZWRTaWduZXJzLCBfdHJhbnNhY3Rpb25VbnNwZW50T3V0cHV0cywgdHgsIHR4VmtleVdpdG5lc3Nlc0hleCwgdHhWa2V5V2l0bmVzc2VzLCB0cmFuc2FjdGlvbldpdG5lc3NTZXQsIHNpZ25lZFR4LCB0eEhleCwgdHhIYXNoO1xuXG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE2JChfY29udGV4dDE2KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDE2LnByZXYgPSBfY29udGV4dDE2Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgb3duZXJBZGRyZXNzID0gX3JlZjE5Lm93bmVyQWRkcmVzcywgc2NyaXB0QWRkcmVzcyA9IF9yZWYxOS5zY3JpcHRBZGRyZXNzLCBibG9ja2Zyb3N0QXBpS2V5ID0gX3JlZjE5LmJsb2NrZnJvc3RBcGlLZXksIG5ldHdvcmsgPSBfcmVmMTkubmV0d29yaztcbiAgICAgICAgICAgICAgLy8gc3RhcnQ6IGluaXRcbiAgICAgICAgICAgICAgdGhpcy5fYmxvY2tmcm9zdCA9IG5ldyBCbG9ja2Zyb3N0KCk7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTYubmV4dCA9IDQ7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9ibG9ja2Zyb3N0LmluaXQoe1xuICAgICAgICAgICAgICAgIGJsb2NrZnJvc3RBcGlLZXk6IGJsb2NrZnJvc3RBcGlLZXksXG4gICAgICAgICAgICAgICAgbmV0d29yazogbmV0d29ya1xuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICBfY29udGV4dDE2LnQwID0gY3NsLlRyYW5zYWN0aW9uQnVpbGRlcjtcbiAgICAgICAgICAgICAgX2NvbnRleHQxNi5uZXh0ID0gNztcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFR4QnVpbGRlckNvbmZpZygpO1xuXG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgIF9jb250ZXh0MTYudDEgPSBfY29udGV4dDE2LnNlbnQ7XG4gICAgICAgICAgICAgIHR4QnVpbGRlciA9IF9jb250ZXh0MTYudDBbXCJuZXdcIl0uY2FsbChfY29udGV4dDE2LnQwLCBfY29udGV4dDE2LnQxKTtcbiAgICAgICAgICAgICAgYXNzZXROYW1lID0gJ1NPQ0lFVFknO1xuICAgICAgICAgICAgICBhc3NldE5hbWVIZXggPSB0b0hleChhc3NldE5hbWUpO1xuICAgICAgICAgICAgICBhc3NldFBvbGljeUlkSGV4ID0gJ2Y1N2YxNDVmYjhkZDgzNzNkYWZmN2NmNTVjZWExODE2NjllOTljNGI3MzMyODUzMWViZDQ0MTlhJzsgLy8gbGV0IHRyYW5zYWN0aW9uSWRMb2NrZWQgPVxuICAgICAgICAgICAgICAvLyAgICczYzBmYzQ3NzRlNTI5NDMyYjJlYWE2NTQ3MjAyMzFhZDZjNmQ5MmFlMmE0YTdhYjI1NDRhOTNkY2ZhM2M4NTYxJztcblxuICAgICAgICAgICAgICBfY29udGV4dDE2Lm5leHQgPSAxNDtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldEFzc2V0VXR4byh7XG4gICAgICAgICAgICAgICAgc2NyaXB0QWRkcmVzczogc2NyaXB0QWRkcmVzcyxcbiAgICAgICAgICAgICAgICBhc3NldDogXCJcIiArIGFzc2V0UG9saWN5SWRIZXggKyBhc3NldE5hbWVIZXhcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgMTQ6XG4gICAgICAgICAgICAgIGFzc2V0VXR4byA9IF9jb250ZXh0MTYuc2VudDtcbiAgICAgICAgICAgICAgX2NvbnRleHQxNi5uZXh0ID0gMTc7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLndhbGxldC5nZXRVdHhvcygpO1xuXG4gICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICB3YWxsZXRVdHhvcyA9IF9jb250ZXh0MTYuc2VudDtcbiAgICAgICAgICAgICAgdXR4b3MgPSB3YWxsZXRVdHhvcy5tYXAoZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3NsLlRyYW5zYWN0aW9uVW5zcGVudE91dHB1dC5mcm9tX2J5dGVzKEJ1ZmZlci5mcm9tKHV0eG8uY2JvciwgJ2hleCcpKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uVW5zcGVudE91dHB1dHMgPSBjc2wuVHJhbnNhY3Rpb25VbnNwZW50T3V0cHV0c1tcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICB1dHhvcy5mb3JFYWNoKGZ1bmN0aW9uICh1dHhvKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25VbnNwZW50T3V0cHV0cy5hZGQodXR4byk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBpbnB1dHMgPSBbXS5jb25jYXQodXR4b3MpO1xuXG4gICAgICAgICAgICAgIGlmIChhc3NldFV0eG8pIHtcbiAgICAgICAgICAgICAgICBpbnB1dHMucHVzaChhc3NldFV0eG8pO1xuICAgICAgICAgICAgICB9IC8vLy9cblxuXG4gICAgICAgICAgICAgIG91dHB1dHMgPSBbe1xuICAgICAgICAgICAgICAgIGFkZHJlc3M6IG93bmVyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBhc3NldHM6IChfYXNzZXRzMiA9IHt9LCBfYXNzZXRzMlthc3NldFBvbGljeUlkSGV4ICsgXCIuXCIgKyBhc3NldE5hbWVdID0gMSwgX2Fzc2V0czIubG92ZWxhY2UgPSAzMDAwMDAwLCBfYXNzZXRzMilcbiAgICAgICAgICAgICAgfV07XG5cbiAgICAgICAgICAgICAgdGhpcy5fYWRkT3V0cHV0cyh7XG4gICAgICAgICAgICAgICAgdHhCdWlsZGVyOiB0eEJ1aWxkZXIsXG4gICAgICAgICAgICAgICAgb3V0cHV0czogb3V0cHV0cyxcbiAgICAgICAgICAgICAgICBvd25lckFkZHJlc3NCZWNoMzI6IG93bmVyQWRkcmVzc1xuICAgICAgICAgICAgICB9KTsgLy8vL1xuXG5cbiAgICAgICAgICAgICAgcGx1dHVzU2NyaXB0cyA9IGNzbC5QbHV0dXNTY3JpcHRzW1wibmV3XCJdKCk7XG4gICAgICAgICAgICAgIHBsdXR1c1NjcmlwdHMuYWRkKGNzbC5QbHV0dXNTY3JpcHQuZnJvbV9ieXRlcyhCdWZmZXIuZnJvbSgnNGU0ZDAxMDAwMDMzMjIyMjIwMDUxMjAwMTIwMDExJywgJ2hleCcpKSk7IC8vIG1ha2UgZGF0dW1cblxuICAgICAgICAgICAgICBkYXR1bSA9IHRoaXMuY3JlYXRlRGF0dW0oe1xuICAgICAgICAgICAgICAgIG93bmVyQWRkcmVzc0JlY2gzMjogb3duZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFzc2V0czogW2Fzc2V0UG9saWN5SWRIZXggKyBcIi5cIiArIGFzc2V0TmFtZV1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGRhdHVtSGFzaCA9IHBsdXR1c0RhdGFUb0hleChkYXR1bSk7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkYXR1bUhhc2gnLCBkYXR1bUhhc2gpO1xuICAgICAgICAgICAgICBkYXR1bXMgPSBjc2wuUGx1dHVzTGlzdFtcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICBkYXR1bXMuYWRkKGRhdHVtKTtcblxuICAgICAgICAgICAgICBpZiAoIXBsdXR1c1NjcmlwdHMpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDE2Lm5leHQgPSA0MztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHR4SW5wdXRzQnVpbGRlciA9IGNzbC5UeElucHV0c0J1aWxkZXJbXCJuZXdcIl0oKTtcbiAgICAgICAgICAgICAgcGx1dHVzV2l0bmVzcyA9IHRoaXMuZ2V0UGx1dHVzV2l0bmVzcyhwbHV0dXNTY3JpcHRzLmdldCgwKSwgZGF0dW1zLmdldCgwKSwgdGhpcy51bmxvY2ssIGFzc2V0VXR4byk7XG4gICAgICAgICAgICAgIHR4SW5wdXRzQnVpbGRlci5hZGRfcGx1dHVzX3NjcmlwdF9pbnB1dChwbHV0dXNXaXRuZXNzLCBhc3NldFV0eG8uaW5wdXQoKSwgYXNzZXRVdHhvLm91dHB1dCgpLmFtb3VudCgpKTtcbiAgICAgICAgICAgICAgX2NvbnRleHQxNi5uZXh0ID0gMzg7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLndhbGxldC5nZXRDb2xsYXRlcmFsKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMzg6XG4gICAgICAgICAgICAgIGNvbGxhdGVyYWwgPSBfY29udGV4dDE2LnNlbnQubWFwKGZ1bmN0aW9uICh1dHhvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNzbC5UcmFuc2FjdGlvblVuc3BlbnRPdXRwdXQuZnJvbV9ieXRlcyhmcm9tSGV4KHV0eG8pKTtcbiAgICAgICAgICAgICAgfSkuc2xpY2UoMCwgMSk7XG4gICAgICAgICAgICAgIHRoaXMuc2V0Q29sbGF0ZXJhbCh0eEJ1aWxkZXIsIGNvbGxhdGVyYWwpO1xuICAgICAgICAgICAgICByZXF1aXJlZFNpZ25lcnMgPSB0aGlzLmdldFJlcXVpcmVkU2lnbmVycyhpbnB1dHMsIGFzc2V0VXR4bywgY29sbGF0ZXJhbCk7XG4gICAgICAgICAgICAgIHR4SW5wdXRzQnVpbGRlci5hZGRfcmVxdWlyZWRfc2lnbmVycyhyZXF1aXJlZFNpZ25lcnMpO1xuICAgICAgICAgICAgICB0eEJ1aWxkZXIuc2V0X2lucHV0cyh0eElucHV0c0J1aWxkZXIpO1xuXG4gICAgICAgICAgICBjYXNlIDQzOlxuICAgICAgICAgICAgICB0eEJ1aWxkZXIuY2FsY19zY3JpcHRfZGF0YV9oYXNoKGNzbC5UeEJ1aWxkZXJDb25zdGFudHMucGx1dHVzX3Zhc2lsX2Nvc3RfbW9kZWxzKCkpO1xuICAgICAgICAgICAgICBfY29udGV4dDE2LnByZXYgPSA0NDtcbiAgICAgICAgICAgICAgX3RyYW5zYWN0aW9uVW5zcGVudE91dHB1dHMgPSBjc2wuVHJhbnNhY3Rpb25VbnNwZW50T3V0cHV0c1tcIm5ld1wiXSgpO1xuICAgICAgICAgICAgICBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbiAodXR4bykge1xuICAgICAgICAgICAgICAgIF90cmFuc2FjdGlvblVuc3BlbnRPdXRwdXRzLmFkZCh1dHhvKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHR4QnVpbGRlci5hZGRfaW5wdXRzX2Zyb20oX3RyYW5zYWN0aW9uVW5zcGVudE91dHB1dHMsIGNzbC5Db2luU2VsZWN0aW9uU3RyYXRlZ3lDSVAyLkxhcmdlc3RGaXJzdE11bHRpQXNzZXQpO1xuICAgICAgICAgICAgICB0eEJ1aWxkZXIuYWRkX2NoYW5nZV9pZl9uZWVkZWQoU3RyaW5nVG9BZGRyZXNzKG93bmVyQWRkcmVzcykpO1xuICAgICAgICAgICAgICBfY29udGV4dDE2Lm5leHQgPSA1NDtcbiAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgNTE6XG4gICAgICAgICAgICAgIF9jb250ZXh0MTYucHJldiA9IDUxO1xuICAgICAgICAgICAgICBfY29udGV4dDE2LnQyID0gX2NvbnRleHQxNltcImNhdGNoXCJdKDQ0KTtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSU5QVVRTX0VYSEFVU1RFRFwiKTtcblxuICAgICAgICAgICAgY2FzZSA1NDpcbiAgICAgICAgICAgICAgdHggPSB0eEJ1aWxkZXIuYnVpbGRfdHgoKTtcbiAgICAgICAgICAgICAgX2NvbnRleHQxNi5uZXh0ID0gNTc7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLndhbGxldC5zaWduVHgoe1xuICAgICAgICAgICAgICAgIHR4OiB0b0hleCh0eC50b19ieXRlcygpKSxcbiAgICAgICAgICAgICAgICBwYXJ0aWFsU2lnbjogdHJ1ZVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSA1NzpcbiAgICAgICAgICAgICAgdHhWa2V5V2l0bmVzc2VzSGV4ID0gX2NvbnRleHQxNi5zZW50O1xuICAgICAgICAgICAgICB0eFZrZXlXaXRuZXNzZXMgPSBjc2wuVHJhbnNhY3Rpb25XaXRuZXNzU2V0LmZyb21fYnl0ZXMoZnJvbUhleCh0eFZrZXlXaXRuZXNzZXNIZXgpKTtcbiAgICAgICAgICAgICAgdHJhbnNhY3Rpb25XaXRuZXNzU2V0ID0gY3NsLlRyYW5zYWN0aW9uV2l0bmVzc1NldC5mcm9tX2J5dGVzKHR4LndpdG5lc3Nfc2V0KCkudG9fYnl0ZXMoKSk7XG4gICAgICAgICAgICAgIHRyYW5zYWN0aW9uV2l0bmVzc1NldC5zZXRfdmtleXModHhWa2V5V2l0bmVzc2VzID09IG51bGwgPyB2b2lkIDAgOiB0eFZrZXlXaXRuZXNzZXMudmtleXMoKSk7XG4gICAgICAgICAgICAgIHNpZ25lZFR4ID0gY3NsLlRyYW5zYWN0aW9uW1wibmV3XCJdKHR4LmJvZHkoKSwgdHJhbnNhY3Rpb25XaXRuZXNzU2V0LCB0eC5hdXhpbGlhcnlfZGF0YSgpKTtcbiAgICAgICAgICAgICAgdHhIZXggPSB0b0hleChzaWduZWRUeC50b19ieXRlcygpKTtcbiAgICAgICAgICAgICAgX2NvbnRleHQxNi5uZXh0ID0gNjU7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLndhbGxldC5zdWJtaXRUeCh7XG4gICAgICAgICAgICAgICAgdHg6IHR4SGV4XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDY1OlxuICAgICAgICAgICAgICB0eEhhc2ggPSBfY29udGV4dDE2LnNlbnQ7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0eEhhc2gnLCB0eEhhc2gpO1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNi5hYnJ1cHQoXCJyZXR1cm5cIiwgdHhIYXNoKTtcblxuICAgICAgICAgICAgY2FzZSA2ODpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTYuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTE2LCB0aGlzLCBbWzQ0LCA1MV1dKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBidWlsZFNDdjMoX3gxNCkge1xuICAgICAgcmV0dXJuIF9idWlsZFNDdjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVpbGRTQ3YzO1xuICB9KCk7XG5cbiAgcmV0dXJuIFRyYW5zYWN0aW9uO1xufSgpO1xuXG52YXIgQXhpb3MgPSBmdW5jdGlvbiBBeGlvcyhfcmVmMikge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHZhciBiYXNlVVJMID0gX3JlZjIuYmFzZVVSTCxcbiAgICAgIF9yZWYyJGhlYWRlcnMgPSBfcmVmMi5oZWFkZXJzLFxuICAgICAgaGVhZGVycyA9IF9yZWYyJGhlYWRlcnMgPT09IHZvaWQgMCA/IHt9IDogX3JlZjIkaGVhZGVycztcblxuICB0aGlzLl9jcmVhdGVBeGlvc0luc3RhbmNlID0gZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgdmFyIGJhc2VVUkwgPSBfcmVmMy5iYXNlVVJMLFxuICAgICAgICBoZWFkZXJzID0gX3JlZjMuaGVhZGVycztcbiAgICByZXR1cm4gYXhpb3MkMS5jcmVhdGUoe1xuICAgICAgYmFzZVVSTDogYmFzZVVSTCxcbiAgICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgICB9KTtcbiAgfTtcblxuICB0aGlzLnBvc3QgPSBmdW5jdGlvbiAoX3JlZjQpIHtcbiAgICB2YXIgZW5kcG9pbnQgPSBfcmVmNC5lbmRwb2ludCxcbiAgICAgICAgZGF0YSA9IF9yZWY0LmRhdGEsXG4gICAgICAgIF9yZWY0JGhlYWRlcnMgPSBfcmVmNC5oZWFkZXJzLFxuICAgICAgICBoZWFkZXJzID0gX3JlZjQkaGVhZGVycyA9PT0gdm9pZCAwID8ge30gOiBfcmVmNCRoZWFkZXJzO1xuICAgIHJldHVybiBfdGhpcy5faW5zdGFuY2UucG9zdChlbmRwb2ludCwgZGF0YSwge1xuICAgICAgaGVhZGVyczogaGVhZGVyc1xuICAgIH0pO1xuICB9O1xuXG4gIHRoaXMuZ2V0ID0gZnVuY3Rpb24gKF9yZWY1KSB7XG4gICAgdmFyIGVuZHBvaW50ID0gX3JlZjUuZW5kcG9pbnQ7XG4gICAgcmV0dXJuIF90aGlzLl9pbnN0YW5jZS5nZXQoZW5kcG9pbnQpO1xuICB9O1xuXG4gIHRoaXMuX2luc3RhbmNlID0gdGhpcy5fY3JlYXRlQXhpb3NJbnN0YW5jZSh7XG4gICAgYmFzZVVSTDogYmFzZVVSTCxcbiAgICBoZWFkZXJzOiBoZWFkZXJzXG4gIH0pO1xufTtcblxudmFyIEluZnVyYSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEluZnVyYSgpIHt9XG5cbiAgdmFyIF9wcm90byA9IEluZnVyYS5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmluaXQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfaW5pdCA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoX3JlZikge1xuICAgICAgdmFyIHByb2plY3RJZCwgcHJvamVjdFNlY3JldCwgaXBmc0FwaUVuZHBvaW50LCBoZWFkZXJzO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBwcm9qZWN0SWQgPSBfcmVmLnByb2plY3RJZCwgcHJvamVjdFNlY3JldCA9IF9yZWYucHJvamVjdFNlY3JldCwgaXBmc0FwaUVuZHBvaW50ID0gX3JlZi5pcGZzQXBpRW5kcG9pbnQ7XG4gICAgICAgICAgICAgIGhlYWRlcnMgPSB7XG4gICAgICAgICAgICAgICAgYXV0aDogcHJvamVjdElkICsgXCI6XCIgKyBwcm9qZWN0U2VjcmV0XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIHRoaXMuX2luc3RhbmNlID0gbmV3IEF4aW9zKHtcbiAgICAgICAgICAgICAgICBiYXNlVVJMOiBpcGZzQXBpRW5kcG9pbnQgIT0gbnVsbCA/IGlwZnNBcGlFbmRwb2ludCA6ICdodHRwczovL2lwZnMuaW5mdXJhLmlvOjUwMDEvYXBpL3YwJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBpbml0KF94KSB7XG4gICAgICByZXR1cm4gX2luaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5pdDtcbiAgfSgpXG4gIC8qKlxyXG4gICAqIEFkZCBhIGZpbGUgb3IgZGlyZWN0b3J5IHRvIElQRlMuXHJcbiAgICogaHR0cHM6Ly9kb2NzLmluZnVyYS5pby9pbmZ1cmEvbmV0d29ya3MvaXBmcy9odHRwLWFwaS1tZXRob2RzL2FkZFxyXG4gICAqIEByZXR1cm5zXHJcbiAgICovXG4gIDtcblxuICBfcHJvdG8uYWRkRmlsZUlwZnMgPVxuICAvKiNfX1BVUkVfXyovXG4gIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX2FkZEZpbGVJcGZzID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoX3JlZjIpIHtcbiAgICAgIHZhciBmb3JtRGF0YTtcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIGZvcm1EYXRhID0gX3JlZjIuZm9ybURhdGE7XG4gICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMztcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2luc3RhbmNlLnBvc3Qoe1xuICAgICAgICAgICAgICAgIGVuZHBvaW50OiAnL2FkZD8nLFxuICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBfcmVmMy5kYXRhO1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCBfY29udGV4dDIuc2VudCk7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gYWRkRmlsZUlwZnMoX3gyKSB7XG4gICAgICByZXR1cm4gX2FkZEZpbGVJcGZzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFkZEZpbGVJcGZzO1xuICB9KCk7XG5cbiAgcmV0dXJuIEluZnVyYTtcbn0oKTtcblxudmFyIERFRkFVTFRfUFJPVE9DT0xfUEFSQU1FVEVSUyA9IHtcbiAgY29pbnNQZXJVVHhPU2l6ZTogJzQzMTAnLFxuICBwcmljZU1lbTogMC4wNTc3LFxuICBwcmljZVN0ZXA6IDAuMDAwMDcyMSxcbiAgbWluRmVlQTogNDQsXG4gIG1pbkZlZUI6IDE1NTM4MSxcbiAga2V5RGVwb3NpdDogJzIwMDAwMDAnLFxuICBtYXhUeFNpemU6IDE2Mzg0LFxuICBtYXhWYWxTaXplOiAnNTAwMCcsXG4gIHBvb2xEZXBvc2l0OiAnNTAwMDAwMDAwJ1xufTtcbnZhciBQT0xJQ1lfSURfTEVOR1RIID0gNTY7XG5cbnZhciBUcmFja2FibGUgPSBmdW5jdGlvbiBUcmFja2FibGUoY29uc3RydWN0b3IpIHtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX2NvbnN0cnVjdG9yKSB7XG4gICAgX2luaGVyaXRzTG9vc2UoX2NsYXNzLCBfY29uc3RydWN0b3IpO1xuXG4gICAgZnVuY3Rpb24gX2NsYXNzKCkge1xuICAgICAgdmFyIF90aGlzO1xuXG4gICAgICBfdGhpcyA9IF9jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICBfdGhpcy5fX3Zpc2l0cyA9IFtdO1xuICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIHJldHVybiBfY2xhc3M7XG4gIH0oY29uc3RydWN0b3IpO1xufTtcbnZhciBDaGVja3BvaW50ID0gZnVuY3Rpb24gQ2hlY2twb2ludCgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChfdGFyZ2V0LCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xuICAgIHZhciBtZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuXG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVzdWx0ID0gbWV0aG9kLmNhbGwuYXBwbHkobWV0aG9kLCBbdGhpc10uY29uY2F0KGFyZ3MpKTtcbiAgICAgIGlmICh0aGlzLl9fdmlzaXRzKSB0aGlzLl9fdmlzaXRzLnB1c2gocHJvcGVydHlLZXkpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xufTtcblxudmFyIGRlc2VyaWFsaXplQWRkcmVzcyA9IGZ1bmN0aW9uIGRlc2VyaWFsaXplQWRkcmVzcyhhZGRyZXNzKSB7XG4gIHJldHVybiBjc2wuQWRkcmVzcy5mcm9tX2J5dGVzKHRvQnl0ZXMoYWRkcmVzcykpO1xufTtcbnZhciBkZXNlcmlhbGl6ZURhdGFIYXNoID0gZnVuY3Rpb24gZGVzZXJpYWxpemVEYXRhSGFzaChkYXRhSGFzaCkge1xuICByZXR1cm4gY3NsLkRhdGFIYXNoLmZyb21fYnl0ZXModG9CeXRlcyhkYXRhSGFzaCkpO1xufTtcbnZhciBkZXNlcmlhbGl6ZVBsdXR1c0RhdGEgPSBmdW5jdGlvbiBkZXNlcmlhbGl6ZVBsdXR1c0RhdGEocGx1dHVzRGF0YSkge1xuICByZXR1cm4gY3NsLlBsdXR1c0RhdGEuZnJvbV9ieXRlcyh0b0J5dGVzKHBsdXR1c0RhdGEpKTtcbn07XG52YXIgZGVzZXJpYWxpemVTY3JpcHRSZWYgPSBmdW5jdGlvbiBkZXNlcmlhbGl6ZVNjcmlwdFJlZihzY3JpcHRSZWYpIHtcbiAgcmV0dXJuIGNzbC5TY3JpcHRSZWYuZnJvbV9ieXRlcyh0b0J5dGVzKHNjcmlwdFJlZikpO1xufTtcbnZhciBkZXNlcmlhbGl6ZVNjcmlwdEhhc2ggPSBmdW5jdGlvbiBkZXNlcmlhbGl6ZVNjcmlwdEhhc2goc2NyaXB0SGFzaCkge1xuICByZXR1cm4gY3NsLlNjcmlwdEhhc2guZnJvbV9ieXRlcyh0b0J5dGVzKHNjcmlwdEhhc2gpKTtcbn07XG52YXIgZGVzZXJpYWxpemVUeCA9IGZ1bmN0aW9uIGRlc2VyaWFsaXplVHgodHgpIHtcbiAgcmV0dXJuIGNzbC5UcmFuc2FjdGlvbi5mcm9tX2J5dGVzKHRvQnl0ZXModHgpKTtcbn07XG52YXIgZGVzZXJpYWxpemVUeEhhc2ggPSBmdW5jdGlvbiBkZXNlcmlhbGl6ZVR4SGFzaCh0eEhhc2gpIHtcbiAgcmV0dXJuIGNzbC5UcmFuc2FjdGlvbkhhc2guZnJvbV9ieXRlcyh0b0J5dGVzKHR4SGFzaCkpO1xufTtcbnZhciBkZXNlcmlhbGl6ZVR4VW5zcGVudE91dHB1dCA9IGZ1bmN0aW9uIGRlc2VyaWFsaXplVHhVbnNwZW50T3V0cHV0KHR4VW5zcGVudE91dHB1dCkge1xuICByZXR1cm4gY3NsLlRyYW5zYWN0aW9uVW5zcGVudE91dHB1dC5mcm9tX2J5dGVzKHRvQnl0ZXModHhVbnNwZW50T3V0cHV0KSk7XG59O1xudmFyIGRlc2VyaWFsaXplVHhXaXRuZXNzU2V0ID0gZnVuY3Rpb24gZGVzZXJpYWxpemVUeFdpdG5lc3NTZXQodHhXaXRuZXNzU2V0KSB7XG4gIHJldHVybiBjc2wuVHJhbnNhY3Rpb25XaXRuZXNzU2V0LmZyb21fYnl0ZXModG9CeXRlcyh0eFdpdG5lc3NTZXQpKTtcbn07XG52YXIgZGVzZXJpYWxpemVWYWx1ZSA9IGZ1bmN0aW9uIGRlc2VyaWFsaXplVmFsdWUodmFsdWUpIHtcbiAgcmV0dXJuIGNzbC5WYWx1ZS5mcm9tX2J5dGVzKHRvQnl0ZXModmFsdWUpKTtcbn07XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tWyBBU0NJSSBdLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxudmFyIHRvQVNDSUkgPSBmdW5jdGlvbiB0b0FTQ0lJKGhleCkge1xuICByZXR1cm4gQnVmZmVyLmZyb20oaGV4LCAnaGV4JykudG9TdHJpbmcoJ2FzY2lpJyk7XG59O1xuLyogLS0tLS0tLS0tLS0tLS0tLS1bIEFkZHJlc3MgXS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbnZhciB0b0FkZHJlc3MgPSBmdW5jdGlvbiB0b0FkZHJlc3MoYmVjaDMyKSB7XG4gIHJldHVybiBjc2wuQWRkcmVzcy5mcm9tX2JlY2gzMihiZWNoMzIpO1xufTtcbi8qIC0tLS0tLS0tLS0tLS0tLS0tWyBCeXRlcyBdLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxudmFyIGZyb21CeXRlcyA9IGZ1bmN0aW9uIGZyb21CeXRlcyhieXRlcykge1xuICByZXR1cm4gQnVmZmVyLmZyb20oYnl0ZXMpLnRvU3RyaW5nKCdoZXgnKTtcbn07XG52YXIgdG9CeXRlcyA9IGZ1bmN0aW9uIHRvQnl0ZXMoaGV4KSB7XG4gIHJldHVybiBCdWZmZXIuZnJvbShoZXgsICdoZXgnKTtcbn07XG4vKiAtLS0tLS0tLS0tLS0tLS0tLVsgVHJhbnNhY3Rpb25VbnNwZW50T3V0cHV0IF0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG52YXIgZnJvbVR4VW5zcGVudE91dHB1dCA9IGZ1bmN0aW9uIGZyb21UeFVuc3BlbnRPdXRwdXQodHhVbnNwZW50T3V0cHV0KSB7XG4gIHZhciBfdHhVbnNwZW50T3V0cHV0JG91dHAsIF90eFVuc3BlbnRPdXRwdXQkb3V0cDIsIF90eFVuc3BlbnRPdXRwdXQkb3V0cDM7XG5cbiAgdmFyIGRhdGFIYXNoID0gdHhVbnNwZW50T3V0cHV0Lm91dHB1dCgpLmhhc19kYXRhX2hhc2goKSA/IGZyb21CeXRlcygoX3R4VW5zcGVudE91dHB1dCRvdXRwID0gdHhVbnNwZW50T3V0cHV0Lm91dHB1dCgpLmRhdGFfaGFzaCgpKSA9PSBudWxsID8gdm9pZCAwIDogX3R4VW5zcGVudE91dHB1dCRvdXRwLnRvX2J5dGVzKCkpIDogdW5kZWZpbmVkO1xuICB2YXIgcGx1dHVzRGF0YSA9IHR4VW5zcGVudE91dHB1dC5vdXRwdXQoKS5oYXNfcGx1dHVzX2RhdGEoKSA/IGZyb21CeXRlcygoX3R4VW5zcGVudE91dHB1dCRvdXRwMiA9IHR4VW5zcGVudE91dHB1dC5vdXRwdXQoKS5wbHV0dXNfZGF0YSgpKSA9PSBudWxsID8gdm9pZCAwIDogX3R4VW5zcGVudE91dHB1dCRvdXRwMi50b19ieXRlcygpKSA6IHVuZGVmaW5lZDtcbiAgdmFyIHNjcmlwdFJlZiA9IHR4VW5zcGVudE91dHB1dC5vdXRwdXQoKS5oYXNfc2NyaXB0X3JlZigpID8gZnJvbUJ5dGVzKChfdHhVbnNwZW50T3V0cHV0JG91dHAzID0gdHhVbnNwZW50T3V0cHV0Lm91dHB1dCgpLnNjcmlwdF9yZWYoKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF90eFVuc3BlbnRPdXRwdXQkb3V0cDMudG9fYnl0ZXMoKSkgOiB1bmRlZmluZWQ7XG4gIHJldHVybiB7XG4gICAgaW5wdXQ6IHtcbiAgICAgIG91dHB1dEluZGV4OiB0eFVuc3BlbnRPdXRwdXQuaW5wdXQoKS5pbmRleCgpLFxuICAgICAgdHhIYXNoOiBmcm9tQnl0ZXModHhVbnNwZW50T3V0cHV0LmlucHV0KCkudHJhbnNhY3Rpb25faWQoKS50b19ieXRlcygpKVxuICAgIH0sXG4gICAgb3V0cHV0OiB7XG4gICAgICBhZGRyZXNzOiB0eFVuc3BlbnRPdXRwdXQub3V0cHV0KCkuYWRkcmVzcygpLnRvX2JlY2gzMigpLFxuICAgICAgYW1vdW50OiBmcm9tVmFsdWUodHhVbnNwZW50T3V0cHV0Lm91dHB1dCgpLmFtb3VudCgpKSxcbiAgICAgIGRhdGFIYXNoOiBkYXRhSGFzaCxcbiAgICAgIHBsdXR1c0RhdGE6IHBsdXR1c0RhdGEsXG4gICAgICBzY3JpcHRSZWY6IHNjcmlwdFJlZlxuICAgIH1cbiAgfTtcbn07XG52YXIgdG9UeFVuc3BlbnRPdXRwdXQgPSBmdW5jdGlvbiB0b1R4VW5zcGVudE91dHB1dCh1dHhvKSB7XG4gIHZhciB0eElucHV0ID0gY3NsLlRyYW5zYWN0aW9uSW5wdXRbXCJuZXdcIl0oZGVzZXJpYWxpemVUeEhhc2godXR4by5pbnB1dC50eEhhc2gpLCB1dHhvLmlucHV0Lm91dHB1dEluZGV4KTtcbiAgdmFyIHR4T3V0cHV0ID0gY3NsLlRyYW5zYWN0aW9uT3V0cHV0W1wibmV3XCJdKHRvQWRkcmVzcyh1dHhvLm91dHB1dC5hZGRyZXNzKSwgdG9WYWx1ZSh1dHhvLm91dHB1dC5hbW91bnQpKTtcblxuICBpZiAodXR4by5vdXRwdXQuZGF0YUhhc2ggIT09IHVuZGVmaW5lZCkge1xuICAgIHR4T3V0cHV0LnNldF9kYXRhX2hhc2goZGVzZXJpYWxpemVEYXRhSGFzaCh1dHhvLm91dHB1dC5kYXRhSGFzaCkpO1xuICB9XG5cbiAgaWYgKHV0eG8ub3V0cHV0LnBsdXR1c0RhdGEgIT09IHVuZGVmaW5lZCkge1xuICAgIHR4T3V0cHV0LnNldF9wbHV0dXNfZGF0YShkZXNlcmlhbGl6ZVBsdXR1c0RhdGEodXR4by5vdXRwdXQucGx1dHVzRGF0YSkpO1xuICB9XG5cbiAgaWYgKHV0eG8ub3V0cHV0LnNjcmlwdFJlZiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdHhPdXRwdXQuc2V0X3NjcmlwdF9yZWYoZGVzZXJpYWxpemVTY3JpcHRSZWYodXR4by5vdXRwdXQuc2NyaXB0UmVmKSk7XG4gIH1cblxuICByZXR1cm4gY3NsLlRyYW5zYWN0aW9uVW5zcGVudE91dHB1dFtcIm5ld1wiXSh0eElucHV0LCB0eE91dHB1dCk7XG59O1xuLyogLS0tLS0tLS0tLS0tLS0tLS1bIFVuaXRJbnRlcnZhbCBdLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxudmFyIHRvVW5pdEludGVydmFsID0gZnVuY3Rpb24gdG9Vbml0SW50ZXJ2YWwoX2Zsb2F0KSB7XG4gIHZhciBkZWNpbWFsID0gX2Zsb2F0LnNwbGl0KCcuJylbMV07XG5cbiAgdmFyIG51bWVyYXRvciA9IFwiXCIgKyBwYXJzZUludChkZWNpbWFsLCAxMCk7XG4gIHZhciBkZW5vbWluYXRvciA9ICcxJyArICcwJy5yZXBlYXQoZGVjaW1hbC5sZW5ndGgpO1xuICByZXR1cm4gY3NsLlVuaXRJbnRlcnZhbFtcIm5ld1wiXShjc2wuQmlnTnVtLmZyb21fc3RyKG51bWVyYXRvciksIGNzbC5CaWdOdW0uZnJvbV9zdHIoZGVub21pbmF0b3IpKTtcbn07XG4vKiAtLS0tLS0tLS0tLS0tLS0tLVsgVmFsdWUgXS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbnZhciBmcm9tVmFsdWUgPSBmdW5jdGlvbiBmcm9tVmFsdWUodmFsdWUpIHtcbiAgdmFyIGFzc2V0cyA9IFt7XG4gICAgdW5pdDogJ2xvdmVsYWNlJyxcbiAgICBxdWFudGl0eTogdmFsdWUuY29pbigpLnRvX3N0cigpXG4gIH1dO1xuICB2YXIgbXVsdGlhc3NldCA9IHZhbHVlLm11bHRpYXNzZXQoKTtcblxuICBpZiAobXVsdGlhc3NldCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIHBvbGljaWVzID0gbXVsdGlhc3NldC5rZXlzKCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvbGljaWVzLmxlbigpOyBpICs9IDEpIHtcbiAgICAgIHZhciBwb2xpY3lJZCA9IHBvbGljaWVzLmdldChpKTtcbiAgICAgIHZhciBwb2xpY3lBc3NldHMgPSBtdWx0aWFzc2V0LmdldChwb2xpY3lJZCk7XG5cbiAgICAgIGlmIChwb2xpY3lBc3NldHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgcG9saWN5QXNzZXROYW1lcyA9IHBvbGljeUFzc2V0cy5rZXlzKCk7XG5cbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwb2xpY3lBc3NldE5hbWVzLmxlbigpOyBqICs9IDEpIHtcbiAgICAgICAgICB2YXIgX3BvbGljeUFzc2V0cyRnZXQ7XG5cbiAgICAgICAgICB2YXIgYXNzZXROYW1lID0gcG9saWN5QXNzZXROYW1lcy5nZXQoaik7XG4gICAgICAgICAgdmFyIHF1YW50aXR5ID0gKF9wb2xpY3lBc3NldHMkZ2V0ID0gcG9saWN5QXNzZXRzLmdldChhc3NldE5hbWUpKSAhPSBudWxsID8gX3BvbGljeUFzc2V0cyRnZXQgOiBjc2wuQmlnTnVtLmZyb21fc3RyKCcwJyk7XG4gICAgICAgICAgdmFyIGFzc2V0SWQgPSBmcm9tQnl0ZXMocG9saWN5SWQudG9fYnl0ZXMoKSkgKyBmcm9tQnl0ZXMoYXNzZXROYW1lLm5hbWUoKSk7XG4gICAgICAgICAgYXNzZXRzLnB1c2goe1xuICAgICAgICAgICAgdW5pdDogYXNzZXRJZCxcbiAgICAgICAgICAgIHF1YW50aXR5OiBxdWFudGl0eS50b19zdHIoKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGFzc2V0cztcbn07XG52YXIgdG9WYWx1ZSA9IGZ1bmN0aW9uIHRvVmFsdWUoYXNzZXRzKSB7XG4gIHZhciBsb3ZlbGFjZSA9IGFzc2V0cy5maW5kKGZ1bmN0aW9uIChhc3NldCkge1xuICAgIHJldHVybiBhc3NldC51bml0ID09PSAnbG92ZWxhY2UnO1xuICB9KTtcbiAgdmFyIHBvbGljaWVzID0gQXJyYXkuZnJvbShuZXcgU2V0KGFzc2V0cy5maWx0ZXIoZnVuY3Rpb24gKGFzc2V0KSB7XG4gICAgcmV0dXJuIGFzc2V0LnVuaXQgIT09ICdsb3ZlbGFjZSc7XG4gIH0pLm1hcChmdW5jdGlvbiAoYXNzZXQpIHtcbiAgICByZXR1cm4gYXNzZXQudW5pdC5zbGljZSgwLCBQT0xJQ1lfSURfTEVOR1RIKTtcbiAgfSkpKTtcbiAgdmFyIG11bHRpQXNzZXQgPSBjc2wuTXVsdGlBc3NldFtcIm5ld1wiXSgpO1xuICBwb2xpY2llcy5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3lJZCkge1xuICAgIHZhciBwb2xpY3lBc3NldHMgPSBjc2wuQXNzZXRzW1wibmV3XCJdKCk7XG4gICAgYXNzZXRzLmZpbHRlcihmdW5jdGlvbiAoYXNzZXQpIHtcbiAgICAgIHJldHVybiBhc3NldC51bml0LnNsaWNlKDAsIFBPTElDWV9JRF9MRU5HVEgpID09PSBwb2xpY3lJZDtcbiAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChhc3NldCkge1xuICAgICAgcG9saWN5QXNzZXRzLmluc2VydChjc2wuQXNzZXROYW1lW1wibmV3XCJdKHRvQnl0ZXMoYXNzZXQudW5pdC5zbGljZShQT0xJQ1lfSURfTEVOR1RIKSkpLCBjc2wuQmlnTnVtLmZyb21fc3RyKGFzc2V0LnF1YW50aXR5KSk7XG4gICAgfSk7XG4gICAgbXVsdGlBc3NldC5pbnNlcnQoZGVzZXJpYWxpemVTY3JpcHRIYXNoKHBvbGljeUlkKSwgcG9saWN5QXNzZXRzKTtcbiAgfSk7XG4gIHZhciB2YWx1ZSA9IGNzbC5WYWx1ZVtcIm5ld1wiXShjc2wuQmlnTnVtLmZyb21fc3RyKGxvdmVsYWNlID8gbG92ZWxhY2UucXVhbnRpdHkgOiAnMCcpKTtcblxuICBpZiAoYXNzZXRzLmxlbmd0aCA+IDEgfHwgIWxvdmVsYWNlKSB7XG4gICAgdmFsdWUuc2V0X211bHRpYXNzZXQobXVsdGlBc3NldCk7XG4gIH1cblxuICByZXR1cm4gdmFsdWU7XG59O1xuXG52YXIgcmVzb2x2ZUZpbmdlcnByaW50ID0gZnVuY3Rpb24gcmVzb2x2ZUZpbmdlcnByaW50KHBvbGljeUlkLCBhc3NldE5hbWUpIHtcbiAgcmV0dXJuIFwiXCIgKyBwb2xpY3lJZCArIGFzc2V0TmFtZTsgLy8gVE9ETzogQ0lQIDE0IC0gVXNlci1GYWNpbmcgQXNzZXQgRmluZ2VycHJpbnRcbn07XG5cbnZhciBUcmFuc2FjdGlvblNlcnZpY2VfMTtcblxudmFyIFRyYW5zYWN0aW9uU2VydmljZSA9IFRyYW5zYWN0aW9uU2VydmljZV8xID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVHJhbnNhY3Rpb25TZXJ2aWNlKF93YWxsZXRTZXJ2aWNlLCBwYXJhbWV0ZXJzKSB7XG4gICAgdGhpcy5fd2FsbGV0U2VydmljZSA9IF93YWxsZXRTZXJ2aWNlO1xuICAgIHRoaXMuX3R4QnVpbGRlciA9IFRyYW5zYWN0aW9uU2VydmljZV8xLmNyZWF0ZVR4QnVpbGRlcihwYXJhbWV0ZXJzKTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBUcmFuc2FjdGlvblNlcnZpY2UucHJvdG90eXBlO1xuXG4gIF9wcm90by5idWlsZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9idWlsZCA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwO1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMztcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRkVHhJbnB1dHNJZk5lZWRlZCgpO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1O1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hZGRDaGFuZ2VBZGRyZXNzSWZOZWVkZWQoKTtcblxuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIGZyb21CeXRlcyh0aGlzLl90eEJ1aWxkZXIuYnVpbGRfdHgoKS50b19ieXRlcygpKSk7XG5cbiAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDg7XG4gICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbXCJjYXRjaFwiXSgwKTtcbiAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQudDA7XG5cbiAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlLCB0aGlzLCBbWzAsIDhdXSk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gYnVpbGQoKSB7XG4gICAgICByZXR1cm4gX2J1aWxkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1aWxkO1xuICB9KCk7XG5cbiAgX3Byb3RvLnNlbmRMb3ZlbGFjZSA9IGZ1bmN0aW9uIHNlbmRMb3ZlbGFjZShhZGRyZXNzLCBsb3ZlbGFjZSkge1xuICAgIHZhciB0eE91dHB1dCA9IGNzbC5UcmFuc2FjdGlvbk91dHB1dEJ1aWxkZXJbXCJuZXdcIl0oKS53aXRoX2FkZHJlc3ModG9BZGRyZXNzKGFkZHJlc3MpKS5uZXh0KCkud2l0aF9jb2luKGNzbC5CaWdOdW0uZnJvbV9zdHIobG92ZWxhY2UpKS5idWlsZCgpO1xuXG4gICAgdGhpcy5fdHhCdWlsZGVyLmFkZF9vdXRwdXQodHhPdXRwdXQpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLnNlbmRBc3NldHMgPSBmdW5jdGlvbiBzZW5kQXNzZXRzKGFkZHJlc3MsIGFzc2V0cywgY29pbnNQZXJCeXRlKSB7XG4gICAgaWYgKGNvaW5zUGVyQnl0ZSA9PT0gdm9pZCAwKSB7XG4gICAgICBjb2luc1BlckJ5dGUgPSBERUZBVUxUX1BST1RPQ09MX1BBUkFNRVRFUlMuY29pbnNQZXJVVHhPU2l6ZTtcbiAgICB9XG5cbiAgICB2YXIgYW1vdW50ID0gdG9WYWx1ZShhc3NldHMpO1xuICAgIHZhciBtdWx0aWFzc2V0ID0gYW1vdW50Lm11bHRpYXNzZXQoKTtcblxuICAgIGlmIChhbW91bnQuaXNfemVybygpIHx8IG11bHRpYXNzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgdmFyIHR4T3V0cHV0ID0gY3NsLlRyYW5zYWN0aW9uT3V0cHV0QnVpbGRlcltcIm5ld1wiXSgpLndpdGhfYWRkcmVzcyh0b0FkZHJlc3MoYWRkcmVzcykpLm5leHQoKS53aXRoX2Fzc2V0X2FuZF9taW5fcmVxdWlyZWRfY29pbl9ieV91dHhvX2Nvc3QobXVsdGlhc3NldCwgY3NsLkRhdGFDb3N0Lm5ld19jb2luc19wZXJfYnl0ZShjc2wuQmlnTnVtLmZyb21fc3RyKGNvaW5zUGVyQnl0ZSkpKS5idWlsZCgpO1xuXG4gICAgdGhpcy5fdHhCdWlsZGVyLmFkZF9vdXRwdXQodHhPdXRwdXQpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLnNldENoYW5nZUFkZHJlc3MgPSBmdW5jdGlvbiBzZXRDaGFuZ2VBZGRyZXNzKGFkZHJlc3MpIHtcbiAgICB0aGlzLl90eEJ1aWxkZXIuYWRkX2NoYW5nZV9pZl9uZWVkZWQodG9BZGRyZXNzKGFkZHJlc3MpKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIF9wcm90by5zZXRNZXRhZGF0YSA9IGZ1bmN0aW9uIHNldE1ldGFkYXRhKGtleSwgdmFsdWUpIHtcbiAgICB0aGlzLl90eEJ1aWxkZXIuYWRkX2pzb25fbWV0YWRhdHVtX3dpdGhfc2NoZW1hKGNzbC5CaWdOdW0uZnJvbV9zdHIoa2V5LnRvU3RyaW5nKCkpLCBKU09OLnN0cmluZ2lmeSh2YWx1ZSksIGNzbC5NZXRhZGF0YUpzb25TY2hlbWEuRGV0YWlsZWRTY2hlbWEpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLnNldFRpbWVUb0xpdmUgPSBmdW5jdGlvbiBzZXRUaW1lVG9MaXZlKHNsb3QpIHtcbiAgICB0aGlzLl90eEJ1aWxkZXIuc2V0X3R0bF9iaWdudW0oY3NsLkJpZ051bS5mcm9tX3N0cihzbG90KSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBfcHJvdG8uc2V0VHhJbnB1dHMgPSBmdW5jdGlvbiBzZXRUeElucHV0cyhpbnB1dHMpIHtcbiAgICB2YXIgdHhJbnB1dHNCdWlsZGVyID0gY3NsLlR4SW5wdXRzQnVpbGRlcltcIm5ld1wiXSgpO1xuICAgIGlucHV0cy5tYXAoZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICByZXR1cm4gdG9UeFVuc3BlbnRPdXRwdXQoaW5wdXQpO1xuICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKHV0eG8pIHtcbiAgICAgIHR4SW5wdXRzQnVpbGRlci5hZGRfaW5wdXQodXR4by5vdXRwdXQoKS5hZGRyZXNzKCksIHV0eG8uaW5wdXQoKSwgdXR4by5vdXRwdXQoKS5hbW91bnQoKSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl90eEJ1aWxkZXIuc2V0X2lucHV0cyh0eElucHV0c0J1aWxkZXIpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgVHJhbnNhY3Rpb25TZXJ2aWNlLmNyZWF0ZVR4QnVpbGRlciA9IGZ1bmN0aW9uIGNyZWF0ZVR4QnVpbGRlcihwYXJhbWV0ZXJzKSB7XG4gICAgaWYgKHBhcmFtZXRlcnMgPT09IHZvaWQgMCkge1xuICAgICAgcGFyYW1ldGVycyA9IERFRkFVTFRfUFJPVE9DT0xfUEFSQU1FVEVSUztcbiAgICB9XG5cbiAgICB2YXIgdHhCdWlsZGVyQ29uZmlnID0gY3NsLlRyYW5zYWN0aW9uQnVpbGRlckNvbmZpZ0J1aWxkZXJbXCJuZXdcIl0oKS5jb2luc19wZXJfdXR4b19ieXRlKGNzbC5CaWdOdW0uZnJvbV9zdHIocGFyYW1ldGVycy5jb2luc1BlclVUeE9TaXplKSkuZXhfdW5pdF9wcmljZXMoY3NsLkV4VW5pdFByaWNlc1tcIm5ld1wiXSh0b1VuaXRJbnRlcnZhbChwYXJhbWV0ZXJzLnByaWNlTWVtLnRvU3RyaW5nKCkpLCB0b1VuaXRJbnRlcnZhbChwYXJhbWV0ZXJzLnByaWNlU3RlcC50b1N0cmluZygpKSkpLmZlZV9hbGdvKGNzbC5MaW5lYXJGZWVbXCJuZXdcIl0oY3NsLkJpZ051bS5mcm9tX3N0cihwYXJhbWV0ZXJzLm1pbkZlZUEudG9TdHJpbmcoKSksIGNzbC5CaWdOdW0uZnJvbV9zdHIocGFyYW1ldGVycy5taW5GZWVCLnRvU3RyaW5nKCkpKSkua2V5X2RlcG9zaXQoY3NsLkJpZ051bS5mcm9tX3N0cihwYXJhbWV0ZXJzLmtleURlcG9zaXQpKS5tYXhfdHhfc2l6ZShwYXJhbWV0ZXJzLm1heFR4U2l6ZSkubWF4X3ZhbHVlX3NpemUocGFyc2VJbnQocGFyYW1ldGVycy5tYXhWYWxTaXplKSkucG9vbF9kZXBvc2l0KGNzbC5CaWdOdW0uZnJvbV9zdHIocGFyYW1ldGVycy5wb29sRGVwb3NpdCkpLmJ1aWxkKCk7XG4gICAgcmV0dXJuIGNzbC5UcmFuc2FjdGlvbkJ1aWxkZXJbXCJuZXdcIl0odHhCdWlsZGVyQ29uZmlnKTtcbiAgfTtcblxuICBfcHJvdG8uYWRkQ2hhbmdlQWRkcmVzc0lmTmVlZGVkID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2FkZENoYW5nZUFkZHJlc3NJZk5lZWRlZCA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkge1xuICAgICAgdmFyIGNoYW5nZUFkZHJlc3M7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBpZiAoIXRoaXMubm90UmVhY2hlZCgnc2V0Q2hhbmdlQWRkcmVzcycpKSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fd2FsbGV0U2VydmljZS5nZXRDaGFuZ2VBZGRyZXNzKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgY2hhbmdlQWRkcmVzcyA9IF9jb250ZXh0Mi5zZW50O1xuXG4gICAgICAgICAgICAgIHRoaXMuX3R4QnVpbGRlci5hZGRfY2hhbmdlX2lmX25lZWRlZCh0b0FkZHJlc3MoY2hhbmdlQWRkcmVzcykpO1xuXG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGFkZENoYW5nZUFkZHJlc3NJZk5lZWRlZCgpIHtcbiAgICAgIHJldHVybiBfYWRkQ2hhbmdlQWRkcmVzc0lmTmVlZGVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFkZENoYW5nZUFkZHJlc3NJZk5lZWRlZDtcbiAgfSgpO1xuXG4gIF9wcm90by5hZGRUeElucHV0c0lmTmVlZGVkID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2FkZFR4SW5wdXRzSWZOZWVkZWQgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHtcbiAgICAgIHZhciB3YWxsZXRVdHhvcywgY29pblNlbGVjdGlvblN0cmF0ZWd5O1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgaWYgKCF0aGlzLm5vdFJlYWNoZWQoJ3NldFR4SW5wdXRzJykpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDY7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFdhbGxldFV0eG9zKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgd2FsbGV0VXR4b3MgPSBfY29udGV4dDMuc2VudDtcbiAgICAgICAgICAgICAgY29pblNlbGVjdGlvblN0cmF0ZWd5ID0gIXRoaXMubm90UmVhY2hlZCgnc2VuZEFzc2V0cycpID8gY3NsLkNvaW5TZWxlY3Rpb25TdHJhdGVneUNJUDIuTGFyZ2VzdEZpcnN0TXVsdGlBc3NldCA6IGNzbC5Db2luU2VsZWN0aW9uU3RyYXRlZ3lDSVAyLkxhcmdlc3RGaXJzdDtcblxuICAgICAgICAgICAgICB0aGlzLl90eEJ1aWxkZXIuYWRkX2lucHV0c19mcm9tKHdhbGxldFV0eG9zLCBjb2luU2VsZWN0aW9uU3RyYXRlZ3kpO1xuXG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGFkZFR4SW5wdXRzSWZOZWVkZWQoKSB7XG4gICAgICByZXR1cm4gX2FkZFR4SW5wdXRzSWZOZWVkZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWRkVHhJbnB1dHNJZk5lZWRlZDtcbiAgfSgpO1xuXG4gIF9wcm90by5nZXRXYWxsZXRVdHhvcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRXYWxsZXRVdHhvcyA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkge1xuICAgICAgdmFyIHR4VW5zcGVudE91dHB1dHMsIHdhbGxldFV0eG9zO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgdHhVbnNwZW50T3V0cHV0cyA9IGNzbC5UcmFuc2FjdGlvblVuc3BlbnRPdXRwdXRzW1wibmV3XCJdKCk7XG4gICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMztcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dhbGxldFNlcnZpY2UuZ2V0RGVzZXJpYWxpemVkVXR4b3MoKTtcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICB3YWxsZXRVdHhvcyA9IF9jb250ZXh0NC5zZW50O1xuICAgICAgICAgICAgICB3YWxsZXRVdHhvcy5mb3JFYWNoKGZ1bmN0aW9uICh1dHhvKSB7XG4gICAgICAgICAgICAgICAgdHhVbnNwZW50T3V0cHV0cy5hZGQodXR4byk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdChcInJldHVyblwiLCB0eFVuc3BlbnRPdXRwdXRzKTtcblxuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBnZXRXYWxsZXRVdHhvcygpIHtcbiAgICAgIHJldHVybiBfZ2V0V2FsbGV0VXR4b3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0V2FsbGV0VXR4b3M7XG4gIH0oKTtcblxuICBfcHJvdG8ubm90UmVhY2hlZCA9IGZ1bmN0aW9uIG5vdFJlYWNoZWQoY2hlY2twb2ludCkge1xuICAgIHJldHVybiB0aGlzLl9fdmlzaXRzLmluY2x1ZGVzKGNoZWNrcG9pbnQpID09PSBmYWxzZTtcbiAgfTtcblxuICByZXR1cm4gVHJhbnNhY3Rpb25TZXJ2aWNlO1xufSgpO1xuXG5fX2RlY29yYXRlKFtDaGVja3BvaW50KCldLCBUcmFuc2FjdGlvblNlcnZpY2UucHJvdG90eXBlLCBcInNlbmRBc3NldHNcIiwgbnVsbCk7XG5cbl9fZGVjb3JhdGUoW0NoZWNrcG9pbnQoKV0sIFRyYW5zYWN0aW9uU2VydmljZS5wcm90b3R5cGUsIFwic2V0Q2hhbmdlQWRkcmVzc1wiLCBudWxsKTtcblxuX19kZWNvcmF0ZShbQ2hlY2twb2ludCgpXSwgVHJhbnNhY3Rpb25TZXJ2aWNlLnByb3RvdHlwZSwgXCJzZXRUeElucHV0c1wiLCBudWxsKTtcblxuVHJhbnNhY3Rpb25TZXJ2aWNlID0gVHJhbnNhY3Rpb25TZXJ2aWNlXzEgPSAvKiNfX1BVUkVfXyovX19kZWNvcmF0ZShbVHJhY2thYmxlXSwgVHJhbnNhY3Rpb25TZXJ2aWNlKTtcblxudmFyIFdhbGxldFNlcnZpY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBXYWxsZXRTZXJ2aWNlKF93YWxsZXRJbnN0YW5jZSkge1xuICAgIHRoaXMuX3dhbGxldEluc3RhbmNlID0gX3dhbGxldEluc3RhbmNlO1xuICB9XG5cbiAgV2FsbGV0U2VydmljZS5nZXRJbnN0YWxsZWRXYWxsZXRzID0gZnVuY3Rpb24gZ2V0SW5zdGFsbGVkV2FsbGV0cygpIHtcbiAgICBpZiAod2luZG93LmNhcmRhbm8gPT09IHVuZGVmaW5lZCkgcmV0dXJuIFtdO1xuICAgIHJldHVybiBXYWxsZXRTZXJ2aWNlLnN1cHBvcnRlZFdhbGxldHMuZmlsdGVyKGZ1bmN0aW9uIChzdykge1xuICAgICAgcmV0dXJuIHdpbmRvdy5jYXJkYW5vW3N3XSAhPT0gdW5kZWZpbmVkO1xuICAgIH0pLm1hcChmdW5jdGlvbiAoc3cpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IHdpbmRvdy5jYXJkYW5vW3N3XS5uYW1lLFxuICAgICAgICBpY29uOiB3aW5kb3cuY2FyZGFub1tzd10uaWNvbixcbiAgICAgICAgdmVyc2lvbjogd2luZG93LmNhcmRhbm9bc3ddLmFwaVZlcnNpb25cbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG5cbiAgV2FsbGV0U2VydmljZS5lbmFibGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZW5hYmxlID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh3YWxsZXROYW1lKSB7XG4gICAgICB2YXIgd2FsbGV0SW5zdGFuY2U7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwO1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMztcbiAgICAgICAgICAgICAgcmV0dXJuIFdhbGxldFNlcnZpY2UucmVzb2x2ZUluc3RhbmNlKHdhbGxldE5hbWUpO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIHdhbGxldEluc3RhbmNlID0gX2NvbnRleHQuc2VudDtcblxuICAgICAgICAgICAgICBpZiAoISh3YWxsZXRJbnN0YW5jZSAhPT0gdW5kZWZpbmVkKSkge1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBuZXcgV2FsbGV0U2VydmljZSh3YWxsZXRJbnN0YW5jZSkpO1xuXG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkbid0IGNyZWF0ZSBhbiBpbnN0YW5jZSBvZiB3YWxsZXQ6IFwiICsgd2FsbGV0TmFtZSArIFwiLlwiKTtcblxuICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gOTtcbiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFtcImNhdGNoXCJdKDApO1xuICAgICAgICAgICAgICB0aHJvdyBfY29udGV4dC50MDtcblxuICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMCwgOV1dKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBlbmFibGUoX3gpIHtcbiAgICAgIHJldHVybiBfZW5hYmxlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVuYWJsZTtcbiAgfSgpO1xuXG4gIHZhciBfcHJvdG8gPSBXYWxsZXRTZXJ2aWNlLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZ2V0QmFsYW5jZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRCYWxhbmNlID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7XG4gICAgICB2YXIgYmFsYW5jZTtcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dhbGxldEluc3RhbmNlLmdldEJhbGFuY2UoKTtcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICBiYWxhbmNlID0gX2NvbnRleHQyLnNlbnQ7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIGZyb21WYWx1ZShkZXNlcmlhbGl6ZVZhbHVlKGJhbGFuY2UpKSk7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZ2V0QmFsYW5jZSgpIHtcbiAgICAgIHJldHVybiBfZ2V0QmFsYW5jZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBnZXRCYWxhbmNlO1xuICB9KCk7XG5cbiAgX3Byb3RvLmdldENoYW5nZUFkZHJlc3MgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0Q2hhbmdlQWRkcmVzcyA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkge1xuICAgICAgdmFyIGNoYW5nZUFkZHJlc3M7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0Mykge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl93YWxsZXRJbnN0YW5jZS5nZXRDaGFuZ2VBZGRyZXNzKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgY2hhbmdlQWRkcmVzcyA9IF9jb250ZXh0My5zZW50O1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdChcInJldHVyblwiLCBkZXNlcmlhbGl6ZUFkZHJlc3MoY2hhbmdlQWRkcmVzcykudG9fYmVjaDMyKCkpO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldENoYW5nZUFkZHJlc3MoKSB7XG4gICAgICByZXR1cm4gX2dldENoYW5nZUFkZHJlc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0Q2hhbmdlQWRkcmVzcztcbiAgfSgpO1xuXG4gIF9wcm90by5nZXRDb2xsYXRlcmFsID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2dldENvbGxhdGVyYWwgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHtcbiAgICAgIHZhciBkZXNlcmlhbGl6ZWRDb2xsYXRlcmFsO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXREZXNlcmlhbGl6ZWRDb2xsYXRlcmFsKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgZGVzZXJpYWxpemVkQ29sbGF0ZXJhbCA9IF9jb250ZXh0NC5zZW50O1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdChcInJldHVyblwiLCBkZXNlcmlhbGl6ZWRDb2xsYXRlcmFsLm1hcChmdW5jdGlvbiAoZGMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnJvbVR4VW5zcGVudE91dHB1dChkYyk7XG4gICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBnZXRDb2xsYXRlcmFsKCkge1xuICAgICAgcmV0dXJuIF9nZXRDb2xsYXRlcmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldENvbGxhdGVyYWw7XG4gIH0oKTtcblxuICBfcHJvdG8uZ2V0RGVzZXJpYWxpemVkQ29sbGF0ZXJhbCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXREZXNlcmlhbGl6ZWRDb2xsYXRlcmFsID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7XG4gICAgICB2YXIgX3lpZWxkJHRoaXMkX3dhbGxldEluO1xuXG4gICAgICB2YXIgY29sbGF0ZXJhbDtcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dhbGxldEluc3RhbmNlLmV4cGVyaW1lbnRhbC5nZXRDb2xsYXRlcmFsKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgX2NvbnRleHQ1LnQwID0gX3lpZWxkJHRoaXMkX3dhbGxldEluID0gX2NvbnRleHQ1LnNlbnQ7XG5cbiAgICAgICAgICAgICAgaWYgKCEoX2NvbnRleHQ1LnQwICE9IG51bGwpKSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA3O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2NvbnRleHQ1LnQxID0gX3lpZWxkJHRoaXMkX3dhbGxldEluO1xuICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDg7XG4gICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgIF9jb250ZXh0NS50MSA9IFtdO1xuXG4gICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgIGNvbGxhdGVyYWwgPSBfY29udGV4dDUudDE7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KFwicmV0dXJuXCIsIGNvbGxhdGVyYWwubWFwKGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlc2VyaWFsaXplVHhVbnNwZW50T3V0cHV0KGMpO1xuICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldERlc2VyaWFsaXplZENvbGxhdGVyYWwoKSB7XG4gICAgICByZXR1cm4gX2dldERlc2VyaWFsaXplZENvbGxhdGVyYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0RGVzZXJpYWxpemVkQ29sbGF0ZXJhbDtcbiAgfSgpO1xuXG4gIF9wcm90by5nZXROZXR3b3JrSWQgPSBmdW5jdGlvbiBnZXROZXR3b3JrSWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3dhbGxldEluc3RhbmNlLmdldE5ldHdvcmtJZCgpO1xuICB9O1xuXG4gIF9wcm90by5nZXRSZXdhcmRBZGRyZXNzZXMgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0UmV3YXJkQWRkcmVzc2VzID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7XG4gICAgICB2YXIgcmV3YXJkQWRkcmVzc2VzO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fd2FsbGV0SW5zdGFuY2UuZ2V0UmV3YXJkQWRkcmVzc2VzKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgcmV3YXJkQWRkcmVzc2VzID0gX2NvbnRleHQ2LnNlbnQ7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KFwicmV0dXJuXCIsIHJld2FyZEFkZHJlc3Nlcy5tYXAoZnVuY3Rpb24gKHJhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlc2VyaWFsaXplQWRkcmVzcyhyYSkudG9fYmVjaDMyKCk7XG4gICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU2LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBnZXRSZXdhcmRBZGRyZXNzZXMoKSB7XG4gICAgICByZXR1cm4gX2dldFJld2FyZEFkZHJlc3Nlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBnZXRSZXdhcmRBZGRyZXNzZXM7XG4gIH0oKTtcblxuICBfcHJvdG8uZ2V0VW51c2VkQWRkcmVzc2VzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2dldFVudXNlZEFkZHJlc3NlcyA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkge1xuICAgICAgdmFyIHVudXNlZEFkZHJlc3NlcztcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dhbGxldEluc3RhbmNlLmdldFVudXNlZEFkZHJlc3NlcygpO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgIHVudXNlZEFkZHJlc3NlcyA9IF9jb250ZXh0Ny5zZW50O1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdChcInJldHVyblwiLCB1bnVzZWRBZGRyZXNzZXMubWFwKGZ1bmN0aW9uICh1bmEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVzZXJpYWxpemVBZGRyZXNzKHVuYSkudG9fYmVjaDMyKCk7XG4gICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU3LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBnZXRVbnVzZWRBZGRyZXNzZXMoKSB7XG4gICAgICByZXR1cm4gX2dldFVudXNlZEFkZHJlc3Nlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBnZXRVbnVzZWRBZGRyZXNzZXM7XG4gIH0oKTtcblxuICBfcHJvdG8uZ2V0VXNlZEFkZHJlc3NlcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRVc2VkQWRkcmVzc2VzID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoKSB7XG4gICAgICB2YXIgdXNlZEFkZHJlc3NlcztcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dhbGxldEluc3RhbmNlLmdldFVzZWRBZGRyZXNzZXMoKTtcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICB1c2VkQWRkcmVzc2VzID0gX2NvbnRleHQ4LnNlbnQ7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KFwicmV0dXJuXCIsIHVzZWRBZGRyZXNzZXMubWFwKGZ1bmN0aW9uICh1c2EpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVzZXJpYWxpemVBZGRyZXNzKHVzYSkudG9fYmVjaDMyKCk7XG4gICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWU4LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBnZXRVc2VkQWRkcmVzc2VzKCkge1xuICAgICAgcmV0dXJuIF9nZXRVc2VkQWRkcmVzc2VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldFVzZWRBZGRyZXNzZXM7XG4gIH0oKTtcblxuICBfcHJvdG8uZ2V0VXR4b3MgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0VXR4b3MgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHtcbiAgICAgIHZhciBkZXNlcmlhbGl6ZWRVdHhvcztcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGVzZXJpYWxpemVkVXR4b3MoKTtcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICBkZXNlcmlhbGl6ZWRVdHhvcyA9IF9jb250ZXh0OS5zZW50O1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdChcInJldHVyblwiLCBkZXNlcmlhbGl6ZWRVdHhvcy5tYXAoZnVuY3Rpb24gKGR1KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZyb21UeFVuc3BlbnRPdXRwdXQoZHUpO1xuICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlOSwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZ2V0VXR4b3MoKSB7XG4gICAgICByZXR1cm4gX2dldFV0eG9zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldFV0eG9zO1xuICB9KCk7XG5cbiAgX3Byb3RvLmdldERlc2VyaWFsaXplZFV0eG9zID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX2dldERlc2VyaWFsaXplZFV0eG9zID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKCkge1xuICAgICAgdmFyIF95aWVsZCR0aGlzJF93YWxsZXRJbjI7XG5cbiAgICAgIHZhciB1dHhvcztcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fd2FsbGV0SW5zdGFuY2UuZ2V0VXR4b3MoKTtcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICBfY29udGV4dDEwLnQwID0gX3lpZWxkJHRoaXMkX3dhbGxldEluMiA9IF9jb250ZXh0MTAuc2VudDtcblxuICAgICAgICAgICAgICBpZiAoIShfY29udGV4dDEwLnQwICE9IG51bGwpKSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIF9jb250ZXh0MTAudDEgPSBfeWllbGQkdGhpcyRfd2FsbGV0SW4yO1xuICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA4O1xuICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICBfY29udGV4dDEwLnQxID0gW107XG5cbiAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgdXR4b3MgPSBfY29udGV4dDEwLnQxO1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoXCJyZXR1cm5cIiwgdXR4b3MubWFwKGZ1bmN0aW9uICh1KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlc2VyaWFsaXplVHhVbnNwZW50T3V0cHV0KHUpO1xuICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUxMCwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZ2V0RGVzZXJpYWxpemVkVXR4b3MoKSB7XG4gICAgICByZXR1cm4gX2dldERlc2VyaWFsaXplZFV0eG9zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldERlc2VyaWFsaXplZFV0eG9zO1xuICB9KCk7XG5cbiAgX3Byb3RvLnNpZ25EYXRhID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICB2YXIgX3NpZ25EYXRhID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKHBheWxvYWQpIHtcbiAgICAgIHZhciBjaGFuZ2VBZGRyZXNzO1xuICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDI7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl93YWxsZXRJbnN0YW5jZS5nZXRDaGFuZ2VBZGRyZXNzKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgY2hhbmdlQWRkcmVzcyA9IF9jb250ZXh0MTEuc2VudDtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KFwicmV0dXJuXCIsIHRoaXMuX3dhbGxldEluc3RhbmNlLnNpZ25EYXRhKGNoYW5nZUFkZHJlc3MsIHBheWxvYWQpKTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTEsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIHNpZ25EYXRhKF94Mikge1xuICAgICAgcmV0dXJuIF9zaWduRGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIHJldHVybiBzaWduRGF0YTtcbiAgfSgpO1xuXG4gIF9wcm90by5zaWduVHggPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfc2lnblR4ID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKHVuc2lnbmVkVHgsIHBhcnRpYWxTaWduKSB7XG4gICAgICB2YXIgdHgsIHR4V2l0bmVzc1NldCwgd2FsbGV0V2l0bmVzc1NldCwgd2FsbGV0VmVyaWZpY2F0aW9uS2V5cywgc2lnbmVkVHg7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEyJChfY29udGV4dDEyKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgaWYgKHBhcnRpYWxTaWduID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICBwYXJ0aWFsU2lnbiA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX2NvbnRleHQxMi5wcmV2ID0gMTtcbiAgICAgICAgICAgICAgdHggPSBkZXNlcmlhbGl6ZVR4KHVuc2lnbmVkVHgpO1xuICAgICAgICAgICAgICB0eFdpdG5lc3NTZXQgPSBkZXNlcmlhbGl6ZVR4V2l0bmVzc1NldChmcm9tQnl0ZXModHgud2l0bmVzc19zZXQoKS50b19ieXRlcygpKSk7XG4gICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDY7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl93YWxsZXRJbnN0YW5jZS5zaWduVHgodW5zaWduZWRUeCwgcGFydGlhbFNpZ24pO1xuXG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgIHdhbGxldFdpdG5lc3NTZXQgPSBfY29udGV4dDEyLnNlbnQ7XG4gICAgICAgICAgICAgIHdhbGxldFZlcmlmaWNhdGlvbktleXMgPSBkZXNlcmlhbGl6ZVR4V2l0bmVzc1NldCh3YWxsZXRXaXRuZXNzU2V0KS52a2V5cygpO1xuICAgICAgICAgICAgICBpZiAod2FsbGV0VmVyaWZpY2F0aW9uS2V5cyAhPT0gdW5kZWZpbmVkKSB0eFdpdG5lc3NTZXQuc2V0X3ZrZXlzKHdhbGxldFZlcmlmaWNhdGlvbktleXMpO1xuICAgICAgICAgICAgICBzaWduZWRUeCA9IGZyb21CeXRlcyhjc2wuVHJhbnNhY3Rpb25bXCJuZXdcIl0odHguYm9keSgpLCB0eFdpdG5lc3NTZXQsIHR4LmF1eGlsaWFyeV9kYXRhKCkpLnRvX2J5dGVzKCkpO1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5hYnJ1cHQoXCJyZXR1cm5cIiwgc2lnbmVkVHgpO1xuXG4gICAgICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgICBfY29udGV4dDEyLnByZXYgPSAxMztcbiAgICAgICAgICAgICAgX2NvbnRleHQxMi50MCA9IF9jb250ZXh0MTJbXCJjYXRjaFwiXSgxKTtcbiAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQxMi50MDtcblxuICAgICAgICAgICAgY2FzZSAxNjpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTEyLCB0aGlzLCBbWzEsIDEzXV0pO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIHNpZ25UeChfeDMsIF94NCkge1xuICAgICAgcmV0dXJuIF9zaWduVHguYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2lnblR4O1xuICB9KCk7XG5cbiAgX3Byb3RvLnN1Ym1pdFR4ID0gZnVuY3Rpb24gc3VibWl0VHgodHgpIHtcbiAgICByZXR1cm4gdGhpcy5fd2FsbGV0SW5zdGFuY2Uuc3VibWl0VHgodHgpO1xuICB9O1xuXG4gIF9wcm90by5nZXRBc3NldHMgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0QXNzZXRzID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkge1xuICAgICAgdmFyIGJhbGFuY2U7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmFsYW5jZSgpO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgIGJhbGFuY2UgPSBfY29udGV4dDEzLnNlbnQ7XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLmFicnVwdChcInJldHVyblwiLCBiYWxhbmNlLmZpbHRlcihmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgIHJldHVybiB2LnVuaXQgIT09ICdsb3ZlbGFjZSc7XG4gICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgIHZhciBwb2xpY3lJZCA9IHYudW5pdC5zbGljZSgwLCBQT0xJQ1lfSURfTEVOR1RIKTtcbiAgICAgICAgICAgICAgICB2YXIgYXNzZXROYW1lID0gdi51bml0LnNsaWNlKFBPTElDWV9JRF9MRU5HVEgpO1xuICAgICAgICAgICAgICAgIHZhciBmaW5nZXJwcmludCA9IHJlc29sdmVGaW5nZXJwcmludChwb2xpY3lJZCwgYXNzZXROYW1lKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgdW5pdDogdi51bml0LFxuICAgICAgICAgICAgICAgICAgcG9saWN5SWQ6IHBvbGljeUlkLFxuICAgICAgICAgICAgICAgICAgYXNzZXROYW1lOiB0b0FTQ0lJKGFzc2V0TmFtZSksXG4gICAgICAgICAgICAgICAgICBmaW5nZXJwcmludDogZmluZ2VycHJpbnQsXG4gICAgICAgICAgICAgICAgICBxdWFudGl0eTogdi5xdWFudGl0eVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTMsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldEFzc2V0cygpIHtcbiAgICAgIHJldHVybiBfZ2V0QXNzZXRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldEFzc2V0cztcbiAgfSgpO1xuXG4gIF9wcm90by5nZXRMb3ZlbGFjZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRMb3ZlbGFjZSA9IC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNCgpIHtcbiAgICAgIHZhciBiYWxhbmNlLCBuYXRpdmVBc3NldDtcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTQkKF9jb250ZXh0MTQpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTQucHJldiA9IF9jb250ZXh0MTQubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRCYWxhbmNlKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgYmFsYW5jZSA9IF9jb250ZXh0MTQuc2VudDtcbiAgICAgICAgICAgICAgbmF0aXZlQXNzZXQgPSBiYWxhbmNlLmZpbmQoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdi51bml0ID09PSAnbG92ZWxhY2UnO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuYWJydXB0KFwicmV0dXJuXCIsIG5hdGl2ZUFzc2V0ICE9PSB1bmRlZmluZWQgPyBuYXRpdmVBc3NldC5xdWFudGl0eSA6ICcwJyk7XG5cbiAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2NhbGxlZTE0LCB0aGlzKTtcbiAgICB9KSk7XG5cbiAgICBmdW5jdGlvbiBnZXRMb3ZlbGFjZSgpIHtcbiAgICAgIHJldHVybiBfZ2V0TG92ZWxhY2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0TG92ZWxhY2U7XG4gIH0oKTtcblxuICBfcHJvdG8uZ2V0UG9saWN5SWRBc3NldHMgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0UG9saWN5SWRBc3NldHMgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTUocG9saWN5SWQpIHtcbiAgICAgIHZhciBhc3NldHM7XG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE1JChfY29udGV4dDE1KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dDE1LnByZXYgPSBfY29udGV4dDE1Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX2NvbnRleHQxNS5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QXNzZXRzKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgYXNzZXRzID0gX2NvbnRleHQxNS5zZW50O1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNS5hYnJ1cHQoXCJyZXR1cm5cIiwgYXNzZXRzLmZpbHRlcihmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgIHJldHVybiB2LnBvbGljeUlkID09PSBwb2xpY3lJZDtcbiAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE1LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUxNSwgdGhpcyk7XG4gICAgfSkpO1xuXG4gICAgZnVuY3Rpb24gZ2V0UG9saWN5SWRBc3NldHMoX3g1KSB7XG4gICAgICByZXR1cm4gX2dldFBvbGljeUlkQXNzZXRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldFBvbGljeUlkQXNzZXRzO1xuICB9KCk7XG5cbiAgX3Byb3RvLmdldFBvbGljeUlkcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9nZXRQb2xpY3lJZHMgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTYoKSB7XG4gICAgICB2YXIgYmFsYW5jZTtcbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTYkKF9jb250ZXh0MTYpIHtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTYucHJldiA9IF9jb250ZXh0MTYubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dDE2Lm5leHQgPSAyO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRCYWxhbmNlKCk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgYmFsYW5jZSA9IF9jb250ZXh0MTYuc2VudDtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTYuYWJydXB0KFwicmV0dXJuXCIsIEFycmF5LmZyb20obmV3IFNldChiYWxhbmNlLm1hcChmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgIHJldHVybiB2LnVuaXQuc2xpY2UoMCwgUE9MSUNZX0lEX0xFTkdUSCk7XG4gICAgICAgICAgICAgIH0pKSkuZmlsdGVyKGZ1bmN0aW9uIChwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHAgIT09ICdsb3ZlbGFjZSc7XG4gICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNi5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlMTYsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIGZ1bmN0aW9uIGdldFBvbGljeUlkcygpIHtcbiAgICAgIHJldHVybiBfZ2V0UG9saWN5SWRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldFBvbGljeUlkcztcbiAgfSgpO1xuXG4gIFdhbGxldFNlcnZpY2UucmVzb2x2ZUluc3RhbmNlID0gZnVuY3Rpb24gcmVzb2x2ZUluc3RhbmNlKHdhbGxldE5hbWUpIHtcbiAgICBpZiAod2luZG93LmNhcmRhbm8gPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB2YXIgd2FsbGV0ID0gV2FsbGV0U2VydmljZS5zdXBwb3J0ZWRXYWxsZXRzLm1hcChmdW5jdGlvbiAoc3cpIHtcbiAgICAgIHJldHVybiB3aW5kb3cuY2FyZGFub1tzd107XG4gICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChzdykge1xuICAgICAgcmV0dXJuIHN3ICE9PSB1bmRlZmluZWQ7XG4gICAgfSkuZmluZChmdW5jdGlvbiAoc3cpIHtcbiAgICAgIHJldHVybiBzdy5uYW1lID09PSB3YWxsZXROYW1lO1xuICAgIH0pO1xuICAgIHJldHVybiB3YWxsZXQgPT0gbnVsbCA/IHZvaWQgMCA6IHdhbGxldC5lbmFibGUoKTtcbiAgfTtcblxuICByZXR1cm4gV2FsbGV0U2VydmljZTtcbn0oKTtcbldhbGxldFNlcnZpY2Uuc3VwcG9ydGVkV2FsbGV0cyA9IFsnZmxpbnQnLCAnbmFtaScsICdldGVybmwnLCAnbnVmaSddO1xuXG52YXIgTWVzaCA9IGZ1bmN0aW9uIE1lc2goKSB7XG4gIHRoaXMuYmxvY2tmcm9zdCA9IG5ldyBCbG9ja2Zyb3N0KCk7XG4gIHRoaXMuaW5mdXJhID0gbmV3IEluZnVyYSgpO1xuICB0aGlzLndhbGxldCA9IG5ldyBXYWxsZXQoe1xuICAgIGJsb2NrZnJvc3Q6IHRoaXMuYmxvY2tmcm9zdFxuICB9KTtcbiAgdGhpcy50cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih7XG4gICAgd2FsbGV0OiB0aGlzLndhbGxldFxuICB9KTtcbn07XG5cbnZhciBpbmRleCA9IC8qI19fUFVSRV9fKi9uZXcgTWVzaCgpO1xuXG5leHBvcnQgZGVmYXVsdCBpbmRleDtcbmV4cG9ydCB7IFRyYW5zYWN0aW9uU2VydmljZSwgV2FsbGV0U2VydmljZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVzaC5lc20uanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@martifylabs/mesh/dist/mesh.esm.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("./pages/index.tsx"));
module.exports = __webpack_exports__;

})();